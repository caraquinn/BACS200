self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.TimePanel~WorkloadScenarioSettings.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[72],{1105:function(e,n,t){"use strict";function r(e){void 0===e&&(e={}),function(e){e.timeBetweenRetryInMS=e.timeBetweenRetryInMS||function(){return 6e4}}(e);var n=e.maximumAttempts,t=e.timeBetweenRetryInMS;return function(e){var r=0,a=!1,i=function(c,d){a?d(new Error("The function retry was cancelled")):(r++,e().then(function(e){return c(e)}).catch(function(e){n&&r>=n?d(e):setTimeout(function(){return i(c,d)},t(r))}))};return{retriableFunc:function(){return new Promise(function(e,n){return i(e,n)})},cancel:function(){return a=!0}}}}function a(e){return function(n){return Math.pow(2,n)*e}}t.d(n,"b",function(){return r}),t.d(n,"a",function(){return a})},1997:function(e,n,t){"use strict";var r=t(0),a=t(2),i=Object(a.action)("LOAD_WORKLOAD_SCENARIO_SETTINGS",function(e){return void 0===e&&(e=null),{accountSmtpAddress:e}}),c=Object(a.action)("WORKLOAD_SCENARIO_SETTINGS_LOADED",function(e,n){return{settings:e,accountSmtpAddress:n}}),d=Object(a.action)("LOADING_WORKLOAD_SCENARIO_SETTINGS_FAILED",function(e){return{accountSmtpAddress:e}}),u=t(277),o=t(174);function l(e){switch(e){case 1:return"Mail";case 2:return"Calendar";case 64:return"FilesHub";case 4:return"People";default:throw new Error("getWorkloadScenarioType: The workload type is not supported")}}var s="ows/beta/ScenarioSettings";var f=71;function b(e){return 0!=(e&f)}var p=t(862);function I(e){return Object(r.__awaiter)(this,void 0,void 0,function(){var n,t,a,i,c=this;return Object(r.__generator)(this,function(d){return n=["Owa"],b(t=Object(p.b)())&&(a=l(t),n.push(a)),i=function(e){var n=e.join(",");return s+"/?Scenarios="+n}(n),[2,Object(u.b)(e).then(function(e){return Object(r.__awaiter)(c,void 0,void 0,function(){var n,t;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return[4,Object(o.b)(i,void 0,void 0,e,!0,void 0,"GET_WORKLOAD_SCENARIO_SETTINGS")];case 1:return n=r.sent(),t={timePanelSelectedView:null,timePanelCalendarIds:[],timePanelSelectedCalendarView:null},n.settings&&n.settings.forEach(function(e){var n;(n=e).calendarIds&&"TimePanelCalendarIds"===n.settingName?t.timePanelCalendarIds=e.calendarIds:!function(e){return!!e.selectedView&&"TimePanelSelectedView"===e.settingName}(e)?function(e){return!!e.selectedView&&"SelectedCalendarListView"===e.settingName}(e)&&(t.timePanelSelectedCalendarView=e.selectedView):t.timePanelSelectedView=e.selectedView}),[2,t]}})})})]})})}var v=t(1105),m=Object(v.b)({maximumAttempts:3,timeBetweenRetryInMS:Object(v.a)(1e4)}),O=null;Object(a.orchestrator)(i,function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var n,t;return Object(r.__generator)(this,function(r){switch(r.label){case 0:n=e.accountSmtpAddress,r.label=1;case 1:return r.trys.push([1,3,,4]),O&&O.cancel(),[4,(O=m(function(){return I(n)})).retriableFunc()];case 2:return t=r.sent(),c(t,n),[3,4];case 3:return r.sent(),d(n),[3,4];case 4:return O=null,[2]}})})});function w(e,n){return s+"/"+e+"/"+n}function g(e){return Object(r.__awaiter)(this,void 0,void 0,function(){var n,t,a,i;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return b(n=Object(p.b)())?(t=l(n),a=w(t,"TimePanelSelectedView"),i={ViewType:e},[4,Object(o.c)(a,i,void 0,void 0,void 0,!0,void 0)]):[3,2];case 1:r.sent(),r.label=2;case 2:return[2]}})})}function j(e,n){return Object(r.__awaiter)(this,void 0,void 0,function(){var n,t;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return n=w("Owa","TimePanelCalendarIds"),t={CalendarIds:e},[4,Object(o.c)(n,t,void 0,void 0,void 0,!0,void 0)];case 1:return r.sent(),[2]}})})}function h(e){return Object(r.__awaiter)(this,void 0,void 0,function(){var n,t,a,i;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return b(n=Object(p.b)())?(t=l(n),a=w(t,"SelectedCalendarListView"),i={ViewType:e},[4,Object(o.c)(a,i,void 0,void 0,void 0,!0,void 0)]):[3,2];case 1:r.sent(),r.label=2;case 2:return[2]}})})}t.d(n,"a",function(){return i}),t.d(n,"e",function(){return c}),t.d(n,"d",function(){return g}),t.d(n,"c",function(){return j}),t.d(n,"b",function(){return h})},2372:function(e,n,t){"use strict";var r=t(1997),a=t(2);function i(e,n){if(0===n.length)return null;n[n.length-1]=e}var c=t(862),d=Object(a.createStore)("timePanelSettingStore",{panelViewStack:function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return{stack:e||[]}}(2!==Object(c.b)()?"Calendar":"Tasks")});Object(a.mutator)(r.e,function(e){var n=e.settings;n.timePanelSelectedView&&i(n.timePanelSelectedView,d().panelViewStack.stack)});var u=Object(a.action)("pushTimePanelView",function(e){return{newView:e}}),o=Object(a.action)("updateTopTimePanelView",function(e){return{updatedView:e}}),l=Object(a.action)("popTimePanelView");Object(a.mutator)(u,function(e){var n;n=e.newView,d().panelViewStack.stack.push(n)}),Object(a.mutator)(o,function(e){i(e.updatedView,d().panelViewStack.stack)}),Object(a.mutator)(l,function(){var e=d().panelViewStack;e.stack.pop()});var s=t(0),f=t(1105),b=t(25),p=Object(f.b)({maximumAttempts:3,timeBetweenRetryInMS:Object(f.a)(1e3)}),I=null;Object(a.orchestrator)(o,function(e){return Object(s.__awaiter)(void 0,void 0,void 0,function(){var n,t;return Object(s.__generator)(this,function(a){switch(a.label){case 0:if(n=e.updatedView,"Tasks"!==(i=n)&&"Calendar"!==i)return[3,5];a.label=1;case 1:return a.trys.push([1,3,,4]),I&&I.cancel(),[4,(I=p(function(){return Object(r.d)(n)})).retriableFunc()];case 2:return a.sent(),[3,4];case 3:return t=a.sent(),b.d.warn("viewStackOrchestrator: updateTimePanelSelectedViewService with retry failed: "+t),[3,4];case 4:I=null,a.label=5;case 5:return[2]}var i})})});var v={Conflicts:"Calendar",EventDetails:"Calendar",AttendeeTracking:"Calendar",Calendar:"Calendar",ComposeForm:"Calendar",Tasks:"Tasks"};function m(e){return e?v[e]:null}function O(){return m(w())}function w(){var e,n=d().panelViewStack;return 0===(e=n.stack).length?null:e[e.length-1]}function g(){return d().panelViewStack.stack.length}function j(){return-1!==d().panelViewStack.stack.indexOf("Conflicts")}function h(){return-1!==d().panelViewStack.stack.indexOf("AttendeeTracking")}function C(){var e=d().panelViewStack;return g()>=2?e.stack[g()-2]:null}t.d(n,"i",function(){return u}),t.d(n,"j",function(){return o}),t.d(n,"h",function(){return l}),t.d(n,"b",function(){return O}),t.d(n,"a",function(){return w}),t.d(n,"e",function(){return g}),t.d(n,"g",function(){return j}),t.d(n,"f",function(){return h}),t.d(n,"d",function(){return C}),t.d(n,"c",function(){return m})},260:function(e,n,t){"use strict";var r=t(2),a=t(6),i={calendarEntryMapping:new a.ObservableMap,calendarFolderMapping:new a.ObservableMap,calendarItemIdToChangeKey:new a.ObservableMap,folderIdToCalendarId:new a.ObservableMap,validEntryMapping:new a.ObservableMap,calendarGroupsMapping:new a.ObservableMap,defaultCalendars:new a.ObservableMap},c=Object(r.createStore)("calendarsCacheStore",i),d=t(0),u=Object(r.action)("initializeCalendarsCacheInStore",function(e,n,t,r,a,i){return{defaultCalendarEntry:e,calendarEntries:n,calendarFolders:t,calendarGroups:r,folderIdMapping:a,calendarIdToChangeKeyMapping:i}}),o=Object(r.action)("updateChangeKeyByCalendarItemId",function(e){return{itemId:e}}),l=Object(r.action)("addToCalendarsCache",function(e,n,t){return{calendarEntry:e,folder:n,mailboxInfo:t}}),s=Object(r.action)("addCalendarGroupToCalendarsCache",function(e){return{calendarGroup:e}}),f=Object(r.action)("updateCalendarEntry",function(e,n){return{itemId:e,calendarEntry:n}}),b=Object(r.action)("updateCalendarFolder",function(e,n){return{calendar:e,calendarFolder:n}}),p=Object(r.action)("removeCalendarFromCalendarsCache",function(e){return{calendar:e}}),I=Object(r.action)("markCalendarEntryAsValid",function(e){return{calendarEntry:e}}),v=Object(r.action)("calendarUpdated",function(e,n){return{calendarId:e,updates:n}}),m=Object(r.action)("groupAssociationChanged",function(e){return{payload:e}}),O=Object(r.action)("removeCalendarWithIDFromCalendarsCache",function(e){return{calendarId:e}});function w(e){if(void 0!==e.CalendarFolderId)return e.CalendarFolderId;var n=e;return n.IsGeneralScheduleCalendar?{Id:n.OwnerEmailAddress,ChangeKey:""}:n.SharedFolderId?{Id:n.SharedFolderId.Id,ChangeKey:null!=n.SharedFolderId.ChangeKey?n.SharedFolderId.ChangeKey:""}:null}Object(r.mutator)(o,function(e){var n=e.itemId,t=n.Id,r=n.ChangeKey;c().calendarItemIdToChangeKey.set(t,r)}),Object(r.mutator)(f,function(e){var n=e.itemId.Id,t=e.calendarEntry,r=c().calendarEntryMapping.get(n),a=(t.ItemId,Object(d.__rest)(t,["ItemId"]));r&&Object.keys(a).forEach(function(e){r[e]=a[e]})}),Object(r.mutator)(I,function(e){var n=e.calendarEntry;c().validEntryMapping.set(n.ItemId.Id,!0)});var g=t(175);function j(e){return e||(e=Object(g.e)().primarySmtpAddress),c().defaultCalendars.get(e)}function h(){var e=c().calendarEntryMapping;return Object(d.__spread)(e.values())}function C(){return h().map(function(e){return E(e.id.id)}).filter(function(e){return e})}function S(){var e=c().calendarGroupsMapping;return Object(d.__spread)(e.values())}function y(e){return c().folderIdToCalendarId.get(e)}function _(e){return c().calendarEntryMapping.get(e)}function E(e){var n=_(e);return n?{id:{id:e,mailboxInfo:Object(d.__assign)({},n.id.mailboxInfo)},calculatedFolderId:P(e),displayName:n.CalendarName,colorScheme:null}:null}function V(e){return c().calendarFolderMapping.get(e.id.id)}function T(e){return _(e.id.id)}function M(e){var n=y(e);return n?_(n.id):void 0}function F(e){var n=c().calendarFolderMapping,t=y(e);return t?n.get(t.id):void 0}function A(e){return c().calendarItemIdToChangeKey.get(e)}function k(e){return x(e.id.id)}function x(e){var n=c().calendarFolderMapping.get(e);return n&&(n.FolderId||n.DistinguishedFolderId)?n.FolderId?n.FolderId.Id:n.DistinguishedFolderId:P(e)}function P(e){var n=c().calendarEntryMapping.get(e);if(n){var t=w(n);return t?t.Id:null}return null}function K(e){var n=c(),t=n.folderIdToCalendarId,r=n.calendarEntryMapping,a=t.get(e);if(a){var i=r.get(a.id);return!i.IsGroupMailboxCalendar&&null!=i.CalendarFolderId}return!1}function G(e){if(K(e)){var n=M(e);return n&&n.IsReadOnly}return!1}function R(e){var n=c().validEntryMapping;return e&&n.get(e.ItemId.Id)}function D(e){return!K(x(e))&&!R(_(e))}function L(e){var n,t=c(),r=t.folderIdToCalendarId,a=t.calendarEntryMapping,i=r.get(e);i?n=a.get(i.id):n=Object(d.__spread)(a.values()).filter(function(n){return n.OwnerEmailAddress&&n.OwnerEmailAddress.toLowerCase()==e.toLowerCase()})[0];return n}function N(e,n){return n+"_"+e}function B(e,n){Object.keys(n).forEach(function(t){return e.set(t,n[t])})}function W(e,n){var t=c();t.calendarItemIdToChangeKey.delete(e),t.calendarEntryMapping.delete(e),t.calendarFolderMapping.delete(e),n&&t.folderIdToCalendarId.delete(n)}function z(e){var n=y(e);return n?n.mailboxInfo:null}function H(e){var n=V(e),t=T(e);return n&&t&&!t.IsReadOnly&&n.EffectiveRights&&n.EffectiveRights.CreateContents}Object(r.mutator)(u,function(e){var n=e.defaultCalendarEntry;n&&c().defaultCalendars.set(n.id.mailboxInfo.primarySmtpAddress,n)}),Object(r.mutator)(u,function(e){var n=e.calendarEntries;B(c().calendarEntryMapping,n)}),Object(r.mutator)(u,function(e){var n=e.calendarFolders;B(c().calendarFolderMapping,n)}),Object(r.mutator)(u,function(e){var n=e.folderIdMapping;B(c().folderIdToCalendarId,n)}),Object(r.mutator)(u,function(e){var n=e.calendarIdToChangeKeyMapping;B(c().calendarItemIdToChangeKey,n)}),Object(r.mutator)(u,function(e){var n=e.calendarGroups;B(c().calendarGroupsMapping,n)}),Object(r.mutator)(l,function(e){var n=e.calendarEntry,t=e.folder,r=e.mailboxInfo,a=c();a.calendarItemIdToChangeKey.set(n.ItemId.Id,n.ItemId.ChangeKey);var i=Object(d.__assign)(Object(d.__assign)({},n),{id:{id:n.ItemId.Id,mailboxInfo:r}});a.calendarEntryMapping.set(n.ItemId.Id,i),a.calendarFolderMapping.set(n.ItemId.Id,t),t.FolderId?a.folderIdToCalendarId.set(t.FolderId.Id,{id:n.ItemId.Id,mailboxInfo:r}):t.DistinguishedFolderId&&a.folderIdToCalendarId.set(t.DistinguishedFolderId,{id:n.ItemId.Id,mailboxInfo:r})}),Object(r.mutator)(s,function(e){var n=e.calendarGroup,t=c(),r=N(n.id.mailboxInfo.primarySmtpAddress,n.GroupId);t.calendarGroupsMapping.set(r,n)}),Object(r.mutator)(p,function(e){var n=e.calendar;W(n.id.id,n.calculatedFolderId?n.calculatedFolderId:null)}),Object(r.mutator)(O,function(e){var n=e.calendarId;W(n,x(n))}),Object(r.mutator)(b,function(e){var n=e.calendar,t=e.calendarFolder,r=V(n);Object.keys(t).forEach(function(e){r[e]=t[e]})});var U=t(397),$=t(60);function q(e,n){var t=T(e);if(Object(U.c)(t)){var r=t;return!r.IsOwnerEmailAddressInvalid&&r.OwnerEmailAddress==n}return e.id&&e.id.mailboxInfo?n.indexOf(e.id.mailboxInfo.primarySmtpAddress)>=0:Object($.a)().SessionSettings.UserEmailAddress==n}function J(e){return e?e.map(E).filter(function(e){return!!e}):null}t.d(n,"z",function(){return u}),t.d(n,"K",function(){return o}),t.d(n,"b",function(){return l}),t.d(n,"a",function(){return s}),t.d(n,"I",function(){return f}),t.d(n,"J",function(){return b}),t.d(n,"G",function(){return p}),t.d(n,"F",function(){return I}),t.d(n,"d",function(){return v}),t.d(n,"y",function(){return m}),t.d(n,"H",function(){return O}),t.d(n,"u",function(){return j}),t.d(n,"i",function(){return h}),t.d(n,"e",function(){return C}),t.d(n,"r",function(){return S}),t.d(n,"s",function(){return y}),t.d(n,"k",function(){return _}),t.d(n,"h",function(){return E}),t.d(n,"n",function(){return V}),t.d(n,"j",function(){return T}),t.d(n,"m",function(){return M}),t.d(n,"o",function(){return F}),t.d(n,"t",function(){return A}),t.d(n,"p",function(){return k}),t.d(n,"v",function(){return x}),t.d(n,"g",function(){return P}),t.d(n,"B",function(){return K}),t.d(n,"C",function(){return G}),t.d(n,"D",function(){return R}),t.d(n,"c",function(){return D}),t.d(n,"l",function(){return L}),t.d(n,"f",function(){return w}),t.d(n,"w",function(){return z}),t.d(n,"q",function(){return N}),t.d(n,"E",function(){return H}),t.d(n,"A",function(){return q}),t.d(n,"x",function(){return J})},3939:function(e,n,t){"use strict";var r=t(2),a=Object(r.action)("updateSelectedCalendarView",function(e){return{updatedView:e}}),i=Object(r.createStore)("calendarListSettingsStore",{selectedView:"Agenda"});function c(){return i().selectedView}var d=Object(r.action)("updateSelectedCalendarViewInStore",function(e){return{updatedView:e}}),u=(Object(r.mutator)(d,function(e){var n=e.updatedView;i().selectedView=n}),t(0)),o=t(1997),l=t(1105),s=t(25),f=Object(l.b)({maximumAttempts:3,timeBetweenRetryInMS:Object(l.a)(1e3)}),b=null;Object(r.orchestrator)(a,function(e){return Object(u.__awaiter)(void 0,void 0,void 0,function(){var n,t;return Object(u.__generator)(this,function(r){switch(r.label){case 0:n=e.updatedView,d(n),r.label=1;case 1:return r.trys.push([1,3,,4]),b&&b.cancel(),[4,(b=f(function(){return Object(o.b)(n)})).retriableFunc()];case 2:return r.sent(),[3,4];case 3:return t=r.sent(),s.d.warn("updateSelectedCalendarViewOrchestrator: updateSelectedCalendarView with retry failed: "+t),[3,4];case 4:return b=null,[2]}})})});Object(r.orchestrator)(o.e,function(e){var n=e.settings;n.timePanelSelectedCalendarView&&d(n.timePanelSelectedCalendarView)});t.d(n,"b",function(){return a}),t.d(n,"a",function(){return c})},397:function(e,n,t){"use strict";var r="LinkedCalendarEntry:#Exchange";function a(e){return e.__type==r}function i(e){return e.CanViewPrivateItems}t.d(n,"c",function(){return a}),t.d(n,"a",function(){return r}),t.d(n,"b",function(){return i})}}]);
//# sourceMappingURL=owa.TimePanel~WorkloadScenarioSettings.js.map
self.scriptsLoaded['owa.TimePanel~WorkloadScenarioSettings.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.TimePanel~WorkloadScenarioSettings.js'] = (new Date()).getTime();