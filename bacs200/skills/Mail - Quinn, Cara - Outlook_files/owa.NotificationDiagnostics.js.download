self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.NotificationDiagnostics.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[343],{9097:function(t,e,n){"use strict";n.r(e);var i=n(0),a=n(1051),r=n(105);function o(){return new Date(Date.now()).toLocaleTimeString()}function s(t,e,n){t.push(e),t.length>n&&t.splice(0,1)}var c,u=n(43),d=Object(u.action)("addChannelDatapoint")(function(t,e){s(e.datapoints,{message:t,timestamp:o()},1e3)}),f=n(1369),p="Channel",b=!1;function l(t){!function(){Object(i.__awaiter)(this,void 0,void 0,function(){var t,e,n;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return b?[3,3]:(b=!0,c={name:p,datapoints:[]},[4,f.e.import()]);case 1:return t=i.sent(),[4,f.f.import()];case 2:e=i.sent(),n=t(),e(c,n),c=n.loggers.get(p),i.label=3;case 3:return[2]}})})}(),d(t,c)}var v=n(757);function m(t){var e="";if(t){var n=v.o.folderTable.get(t);n&&(e=n.DisplayName)}return e}function h(t){var e="";return t.Conversation?e=t.Conversation.ConversationTopic:t.Item&&(e=t.Item.Subject),e}var g,w=Object(u.action)("addNotificationDatapoint")(function(t,e){var n=t,i=t;s(e.datapoints,{id:t.id,type:t.EventType,folder:m(n.FolderId||i.folderId),subject:h(n),timestamp:o()},1e3)}),j="Notifications",_=!1;function O(t){!function(){Object(i.__awaiter)(this,void 0,void 0,function(){var t,e,n;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return _?[3,3]:(_=!0,g={name:j,datapoints:[]},[4,f.e.import()]);case 1:return t=i.sent(),[4,f.f.import()];case 2:e=i.sent(),n=t(),e(g,n),g=n.loggers.get(j),i.label=3;case 3:return[2]}})})}(),w(t,g)}var D,S=Object(u.action)("addSubscriptionDatapoint")(function(t,e){e.datapoints.push({id:t.subscriptionId,type:t.subscriptionParameters&&t.subscriptionParameters.NotificationType?t.subscriptionParameters.NotificationType:"",folder:t.subscriptionParameters?m(t.subscriptionParameters.FolderId):"",status:"Uninitialized",handlers:1,retries:0,error:""})}),T=Object(u.action)("removeSubscriptionDatapoint")(function(t,e){for(var n=e.datapoints,i=0;i<n.length;i++)if(n[i].id===t){n.splice(i,1);break}}),I=Object(u.action)("setSubscriptionDatapointStatus")(function(t,e,n,i,a,r){for(var o=r.datapoints,s=0;s<o.length;s++)if(o[s].id===t)switch(o[s].handlers=n,o[s].retries=i,a&&(o[s].error=a),e){case 0:o[s].status="Uninitialized";break;case 3:o[s].status="Connected";break;case 2:o[s].status="Pending";break;case 1:o[s].status="Disconnected"}}),C="Subscriptions",N=!1;function y(){return Object(i.__awaiter)(this,void 0,void 0,function(){var t,e,n;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return N?[3,3]:(N=!0,D={name:C,datapoints:[]},[4,f.e.import()]);case 1:return t=i.sent(),[4,f.f.import()];case 2:e=i.sent(),n=t(),e(D,n),D=n.loggers.get(C),i.label=3;case 3:return[2]}})})}function P(t){y(),S(t,D)}function k(t,e,n){y(),I(t.subscriptionId,e.status,e.refs.length,e.retries,n,D)}function z(t){y(),T(t.subscriptionId,D)}var U=n(25);function E(t){U.d.warn(t)}function F(t){U.d.error(t)}function $(){return Object(i.__awaiter)(this,void 0,void 0,function(){var t,e;return Object(i.__generator)(this,function(n){switch(n.label){case 0:return Object(r.e)("fwk-devTools")?[4,a.d.import()]:[3,2];case 1:t=n.sent(),(e=t()).on(a.a.ChannelData,l),e.on(a.a.NotificationData,O),e.on(a.a.SubscriptionAdded,P),e.on(a.a.SubscriptionRemoved,z),e.on(a.a.SubscriptionUpdated,k),e.on(a.a.TraceWarn,E),e.on(a.a.TraceError,F),n.label=2;case 2:return[2]}})})}n.d(e,"initializeNotificationDiagnostics",function(){return $})}},0,[0,1,3,6,201,532,182,564,341,23,119]]);
//# sourceMappingURL=owa.NotificationDiagnostics.js.map
self.scriptsLoaded['owa.NotificationDiagnostics.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.NotificationDiagnostics.js'] = (new Date()).getTime();