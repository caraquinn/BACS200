self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.SubstrateSuggestions.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[433],{14079:function(e,t,n){"use strict";n.r(t);var r=n(0),i=n(1568),o=n(43),u=n(944),c=Object(o.action)("execute3SPrimeCall")(function(e){return Object(r.__awaiter)(this,void 0,void 0,function(){return Object(r.__generator)(this,function(t){switch(t.label){case 0:return e?[4,u.b.importAndExecute()]:[3,2];case 1:t.sent(),t.label=2;case 2:return Object(i.a)("",!1),[2]}})})});n.d(t,"execute3SPrimeCall",function(){return c})},1547:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r=["Id","ADObjectId","DisplayName","EmailAddresses","PeopleSubtype","PeopleType","PDLItemId","PersonaId","ImAddress","JobTitle"]},1564:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(2),i=n(875),o=Object(r.mutatorAction)("updateBindStatus",function(e){Object(i.a)().status=e})},1568:function(e,t,n){"use strict";var r=n(0),i=n(944);function o(){return"Bound"==Object(i.e)().status}var u=n(105),c=n(760),s=n(174),a=n(1093),l=n(276),d=n(1547),f=n(502),h=n(25);n.d(t,"a",function(){return m});var v="/search/api/v1/init?",p="https://outlook.office365.com/search",b="https://substrate.office.com/SubstrateSearch-Internal.ReadWrite",_="/search/api/v1/suggestions?",k="owa.react.compose",w="20",O="5";function m(e,t,n,i,o){return Object(r.__awaiter)(this,void 0,void 0,function(){var u,a,l,d;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return""!=e?[3,1]:[2,j()];case 1:return[4,g(e,t,o)];case 2:return u=r.sent(),a=function(e,t){return{AppName:"OWA",Scenario:{Name:k},Cvid:t||Object(c.a)(),EntityRequests:[e]}}(u,i&&i.conversationId),l=s.d,d=[_+y(),a,n,!1],[4,A(i&&i.clientSessionId)];case 3:return[2,l.apply(void 0,d.concat([r.sent(),!0,!0,!1])).then(function(e){return e}).catch(function(e){return h.d.error(e),null})]}})})}function j(){return Object(r.__awaiter)(this,void 0,void 0,function(){var e,t,n,i,c,d;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return Object(l.a)()&&Object(u.e)("rp-linkedInPeopleSuggestions")&&o()?((e={}).headers=new Headers,[4,Object(f.getDelegationTokenForOwa)(b)]):[3,3];case 1:return t=r.sent(),e.headers.set("X-User-Context","litoken=bearer"),e.headers.set("Authorization","Bearer "+t),(n=Object(a.c)())&&e.headers.append("X-AnchorMailbox",n),e.method="GET",[4,fetch(window.location.origin+v+y(),e)];case 2:return(i=r.sent())&&200==i.status?[2,i]:(h.d.error("makeInitRequest: Unsuccessful response status"),[2,null]);case 3:return c=s.b,d=[v+y(),void 0,!0],[4,A()];case 4:return[2,c.apply(void 0,d.concat([r.sent(),!0,!1])).then(function(e){return e.json()}).catch(function(e){return h.d.error(e),null})]}})})}function g(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,function(){var i,c;return Object(r.__generator)(this,function(r){return i=Object(u.e)("rp-linkedInPeopleSuggestions")&&o(),c={Query:{QueryString:e},EntityType:"People",Provenances:T(t,i),Size:t?w:O},n&&n.length>0&&(c.Context=function(e){var t={};e&&(t.RecipientsTo=e.toString());return t}(n)),c.Fields=d.a,[2,c]})})}function T(e,t){var n=["Mailbox"];return e&&n.push("Directory"),t&&n.push("LinkedIn"),n}function y(){var e={scenario:k};return Object.keys(e).map(function(t){return t+"="+e[t]}).join("&")}function A(e){return Object(r.__awaiter)(this,void 0,void 0,function(){var t,n;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return t={},e&&(t["client-session-id"]=e),Object(u.e)("rp-linkedInPeopleSuggestions")&&o()?Object(l.a)()?(t["X-User-Context"]="litoken=bearer",[3,3]):[3,1]:[3,3];case 1:return[4,Object(f.getAccessTokenforResource)(p)];case 2:n=r.sent(),t["X-User-Context"]="litoken="+n,r.label=3;case 3:return[2,t]}})})}},212:function(e,t,n){"use strict";var r=n(0),i=n(219),o=n(200),u=n(231),c=n(325),s=n.n(c),a=n(73),l=n(373),d=n.n(l),f=500;function h(e){return Object(r.__awaiter)(this,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(n){return t={isUserActivity:!1},[2,d()(s()({Resource:e}),t)]})})}function v(e,t){return Object(r.__awaiter)(this,void 0,void 0,function(){return Object(r.__generator)(this,function(n){return t<1?[2,Promise.reject()]:[2,h(e).catch(function(){return Object(a.a)(f).then(function(){return v(e,t-1)})})]})})}var p,b=n(105),_=n(368),k=3,w=500;function O(e){var t=this,n=null,i=null,o=new Promise(function(e,o){return Object(r.__awaiter)(t,void 0,void 0,function(){return Object(r.__generator)(this,function(t){return n=e,i=o,[2]})})}),u={onFulfilled:n,onRejected:i,resource:e};return(null==p&&(p=new _.a(k,m,w)),p).add(u),o}function m(e){return Object(r.__awaiter)(this,void 0,void 0,function(){return Object(r.__generator)(this,function(t){return E(e.resource).then(function(t){e.onFulfilled(t)}).catch(function(t){e.onRejected(t)}),[2]})})}var j=null;function g(){return null==j&&(j=new i.Cache),j}n.d(t,"e",function(){return x}),n.d(t,"b",function(){return R}),n.d(t,"c",function(){return I}),n.d(t,"a",function(){return E}),n.d(t,"d",function(){return S});var T=1,y=12e4,A=3,C=null;function x(e){C=e}function R(e){return Object(r.__awaiter)(this,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(n){switch(n.label){case 0:return null!=(t=S(D(),e))?[3,2]:[4,E(e)];case 1:t=n.sent(),n.label=2;case 2:return[2,null!=t?t.AccessToken:void 0]}})})}function I(e){var t=S(D(),e);if(t)return[t.AccessToken,void 0];if(Object(b.e)("auth-getAccessTokenQueueEnabled")){var n=function(e){return g().get(e)}(e),r=void 0;return n?r=n:(r=O(e),function(e,t){g().put(e,t)}(e,r)),[void 0,r.then(function(t){return function(e){g().del(e)}(e),t.AccessToken})]}return[void 0,E(e).then(function(e){return e.AccessToken})]}function E(e){return Object(r.__awaiter)(this,void 0,void 0,function(){var t,n,i;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return Object(b.e)("auth-getAccessTokenQueueEnabled")?[4,v(e,A)]:[3,2];case 1:return n=r.sent(),[3,4];case 2:return[4,h(e)];case 3:n=r.sent(),r.label=4;case 4:return null!=(t=n)&&0==t.TokenResultCode&&null!=t.AccessTokenExpiry&&(t.ExpiresIn&&t.ExpiresIn>0&&(t.AccessTokenExpiry=Object(u.a)(Date.now(),t.ExpiresIn).toISOString()),(i=new Date(t.AccessTokenExpiry).getTime()-Date.now()-y)>0&&D().put(e,t,i,function(e,t){E(e).catch(function(){})})),[2,t]}})})}function S(e,t){var n=e.get(t),r=void 0;n&&n.AccessTokenExpiry&&(Object(o.a)(new Date(n.AccessTokenExpiry),-T)>new Date(Date.now())&&(r=n));return r}function D(){return null==C&&(C=new i.Cache),C}},219:function(e,t,n){"use strict";function r(){var e=Object.create(null),t=0,n=0,r=0,i=!1;function o(t){r--,delete e[t]}this.put=function(t,n,i,u){if(void 0!==i&&("number"!=typeof i||isNaN(i)||i<=0))throw new Error("Cache timeout must be a positive number");if(void 0!==u&&"function"!=typeof u)throw new Error("Cache timeout callback must be a function");var c=e[t];c?clearTimeout(c.timeout):r++;var s={value:n,expire:i+Date.now()};return isNaN(s.expire)||(s.timeout=setTimeout(function(){o(t),u&&u(t,n)}.bind(this),i)),e[t]=s,n},this.del=function(t){var n=!0,r=e[t];return r?(clearTimeout(r.timeout),!isNaN(r.expire)&&r.expire<Date.now()&&(n=!1)):n=!1,n&&o(t),n},this.clear=function(){for(var o in e)clearTimeout(e[o].timeout);r=0,e=Object.create(null),i&&(t=0,n=0)},this.get=function(o){var u=e[o];if(void 0!==u){if(isNaN(u.expire)||u.expire>=Date.now())return i&&t++,u.value;i&&n++,r--,delete e[o]}else i&&n++;return null},this.size=function(){return r},this.memsize=function(){var t,n=0;for(t in e)n++;return n},this.debug=function(e){i=e},this.hits=function(){return t},this.misses=function(){return n},this.keys=function(){return Object.keys(e)},this.exportJson=function(){var t={};for(var n in e){var r=e[n];t[n]={value:r.value,expire:r.expire||"NaN"}}return JSON.stringify(t)},this.importJson=function(t,n){var r=JSON.parse(t),i=Date.now(),o=n&&n.skipDuplicates;for(var u in r)if(r.hasOwnProperty(u)){if(o)if(e[u])continue;var c=r[u],s=c.expire-i;if(s<=0){this.del(u);continue}s=s>0?s:void 0,this.put(u,c.value,s)}return this.size()}}e.exports=new r,e.exports.Cache=r},325:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"TokenRequest:#Exchange"},e)}},368:function(e,t,n){"use strict";var r=function(){function e(e,t,n){this.maxParallelTasks=e,this.taskCallback=t,this.taskDelay=n,this.taskList=[],this.numberOfTasksRunning=0}return e.prototype.add=function(e){this.taskList.unshift(e),this.scheduleTask()},e.prototype.clear=function(){this.taskList.splice(0,this.taskList.length)},e.prototype.canRunMoreTasks=function(){return this.numberOfTasksRunning<this.maxParallelTasks&&this.taskList.length>0},e.prototype.scheduleTask=function(){var e=this;this.canRunMoreTasks()&&setTimeout(function(){e.tryRunTask()},this.taskDelay)},e.prototype.tryRunTask=function(){this.canRunMoreTasks()&&this.runTask()},e.prototype.onTaskComplete=function(){this.numberOfTasksRunning--,this.scheduleTask()},e.prototype.runTask=function(){var e=this,t=this.taskList.pop();this.numberOfTasksRunning++,this.taskCallback(t).then(function(){e.onTaskComplete()}).catch(function(){e.onTaskComplete()}),this.scheduleTask()},e}();n.d(t,"a",function(){return r})},373:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(199),i=n(325);t.default=function(e,t){return void 0===e||e.__type||(e=i.default(e)),r.makeServiceRequest("GetAccessTokenforResource",e,t)}},502:function(e,t,n){"use strict";n.r(t);var r=n(219),i=n(212);function o(e){Object(i.e)(new r.Cache),Object(i.b)(e.location.origin)}var u=n(0),c=n(59),s=n(264),a=n.n(s),l=n(231),d={};function f(e){return Object(u.__awaiter)(this,void 0,void 0,function(){var t,n,r;return Object(u.__generator)(this,function(i){switch(i.label){case 0:t=e.client_id+e.scope,n=encodeURIComponent(t),r={},i.label=1;case 1:return i.trys.push([1,3,4,5]),[4,h(e,window)];case 2:return r=i.sent(),[3,5];case 3:return i.sent(),r.TokenResultCode=2,[3,5];case 4:return function(e,t){var n=t.document.getElementById(e);null!=n&&(n.removeEventListener("load",d[e]),t.document.body.removeChild(n),delete d[e])}(n,window),[7];case 5:return[2,r]}})})}function h(e,t){return Object(u.__awaiter)(this,void 0,void 0,function(){var n,r,i;return Object(u.__generator)(this,function(o){return n=encodeURIComponent(e.client_id+e.scope),r=function(e){var t={response_type:"token",prompt:"none",redirect_uri:e.redirect_uri,scope:e.scope,client_id:e.client_id};return e.authorization_uri+"?"+c.stringify(t)}(e),t.document.getElementById(n)?[2,{TokenResultCode:2}]:((i=t.document.createElement("iframe")).src=r.toString(),i.style.display="none",i.id=n,t.document.body.appendChild(i),[2,new Promise(function(e,r){d[n]=function(n){var o={};try{i.contentWindow&&i.contentWindow.location.origin==t.location.origin&&(o=function(e){var t=c.parse(e),n={};t.access_token?(n.AccessToken=t.access_token,n.AccessTokenExpiry=Object(l.a)(Date.now(),parseInt(t.expires_in)).toISOString(),n.TokenResultCode=0):"login_required"==t.error||"interaction_required"==t.error||"consent_required"==t.error?n.TokenResultCode=3:n.TokenResultCode=2;return n}(i.contentWindow.location.hash.substring(1)))}catch(e){o.TokenResultCode=2,r(o)}e(o)},i.addEventListener("load",d[n],!1)})])})})}var v=null;function p(e){return Object(u.__awaiter)(this,void 0,void 0,function(){var t,n,r,i;return Object(u.__generator)(this,function(o){switch(o.label){case 0:return t={scope:e,client_id:"",authorization_uri:"",redirect_uri:""},n=void 0,[4,a()()];case 1:return 0!=(r=o.sent()).ResultCode||null==r.ImplicitGrantAuthorizationUrl||""==r.ImplicitGrantAuthorizationUrl?[2,n]:(i=c.parse(r.ImplicitGrantAuthorizationUrl.split("?")[1]||"")).client_id&&i.redirect_uri?(t.client_id=i.client_id,t.authorization_uri=r.ImplicitGrantAuthorizationUrl.split("?")[0],t.redirect_uri=i.redirect_uri,[4,b(t)]):[3,3];case 2:n=o.sent(),o.label=3;case 3:return[2,n]}})})}function b(e){return Object(u.__awaiter)(this,void 0,void 0,function(){var t,n;return Object(u.__generator)(this,function(r){switch(r.label){case 0:return t=e.client_id+e.scope,null!=(n=Object(i.d)(_(),t))?[3,2]:[4,f(e)];case 1:n=r.sent(),function(e,t){if(t&&0==t.TokenResultCode&&t.AccessTokenExpiry){var n=new Date(t.AccessTokenExpiry).getTime()-Date.now();n>0&&_().put(e,t,n)}}(t,n),r.label=2;case 2:return[2,0==n.TokenResultCode?n.AccessToken:void 0]}})})}function _(){return null==v&&(v=new r.Cache),v}var k=n(204),w=n(377);var O=!1;function m(e){O||(!function(e){var t=Object(w.a)("/owa",e);Object(k.initializeServiceRequest)({baseUrl:t})}(e),O=!0)}function j(e,t,n,r){n?e.acquireTokenPopup(t,null,n,r):e.acquireToken(t,r)}var g=n(22),T=new g.c(function(){return Promise.all([n.e(520),n.e(108)]).then(n.bind(null,14083))}),y=new g.a(T,function(e){return e.createAdalAuthenticationContext});var A=function(e,t,n,r){return function(i,o){i||!o?r(i,null):(e.getCachedUser(),j(e,t,n,r))}},C="adalIdTokenFrame";function x(e,t,n,r){e.config.displayCall=function(i){!function(e){if(-1==e.indexOf("?"))throw new Error("Invalid Url in Adal Auth Context Display Call")}(i),window.detectUserCachedCallback=A(e,t,n,r),function(e,t){e._addAdalFrame(C).src="about:blank",e._loadFrame(t+"&prompt=none",C)}(e,i)},e.login()}function R(e,t,n,r,i){return Object(u.__awaiter)(this,void 0,void 0,function(){var o;return Object(u.__generator)(this,function(u){switch(u.label){case 0:return"https://login.microsoftonline.com/",[4,y.importAndExecute("https://login.microsoftonline.com/",e,t)];case 1:return o=u.sent(),o.getCachedUser()?j(o,n,r,i):x(o,n,r,i),[2]}})})}n.d(t,"registerTokenProvider",function(){return o}),n.d(t,"getAccessTokenforResource",function(){return i.b}),n.d(t,"getAccessTokenforResourceAsLazy",function(){return i.c}),n.d(t,"getDelegationToken",function(){return b}),n.d(t,"getDelegationTokenForOwa",function(){return p}),n.d(t,"bootstrap",function(){return m}),n.d(t,"getAccessTokenOnBehalfOfResource",function(){return R})},875:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(2),i=Object(r.createStore)("linkedInStore",{status:null})},944:function(e,t,n){"use strict";var r=n(22),i=n(1564),o=n(228);var u=n(875);function c(){return"Unbound"===Object(u.a)().status}function s(){return"Bound"===Object(u.a)().status}n.d(t,"a",function(){return l}),n.d(t,"b",function(){return d}),n.d(t,"d",function(){return c}),n.d(t,"e",function(){return u.a}),n.d(t,"c",function(){return s});var a=new r.c(function(){return n.e(304).then(n.bind(null,13954))}),l=new r.a(a,function(e){return e.connectToLinkedIn}),d=new r.a(a,function(e){return e.initializeBindStatus});"undefined"!=typeof window&&void 0!==window.Owa&&(window.Owa.completeLinkedInBind=function(e){Object(o.o)("linkedInBindComplete",[e]),Object(i.a)(e?"Unbound":"Bound")})}},0,[520,108,23,119]]);
//# sourceMappingURL=owa.SubstrateSuggestions.js.map
self.scriptsLoaded['owa.SubstrateSuggestions.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.SubstrateSuggestions.js'] = (new Date()).getTime();