self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.AttachmentPreviewSxS.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[125],{1032:function(e,t,n){var r=n(1197),a=36e5,i=6e4,o=2,c=/[T ]/,u=/:/,s=/^(\d{2})$/,d=[/^([+-]\d{2})$/,/^([+-]\d{3})$/,/^([+-]\d{4})$/],l=/^(\d{4})/,f=[/^([+-]\d{4})/,/^([+-]\d{5})/,/^([+-]\d{6})/],m=/^-(\d{2})$/,h=/^-?(\d{3})$/,b=/^-?(\d{2})-?(\d{2})$/,v=/^-?W(\d{2})$/,p=/^-?W(\d{2})-?(\d{1})$/,w=/^(\d{2}([.,]\d*)?)$/,g=/^(\d{2}):?(\d{2}([.,]\d*)?)$/,P=/^(\d{2}):?(\d{2}):?(\d{2}([.,]\d*)?)$/,O=/([Z+-].*)$/,y=/^(Z)$/,C=/^([+-])(\d{2})$/,S=/^([+-])(\d{2}):?(\d{2})$/;function _(e,t,n){t=t||0,n=n||0;var r=new Date(0);r.setUTCFullYear(e,0,4);var a=7*t+n+1-(r.getUTCDay()||7);return r.setUTCDate(r.getUTCDate()+a),r}e.exports=function(e,t){if(r(e))return new Date(e.getTime());if("string"!=typeof e)return new Date(e);var n=(t||{}).additionalDigits;n=null==n?o:Number(n);var I=function(e){var t,n={},r=e.split(c);if(u.test(r[0])?(n.date=null,t=r[0]):(n.date=r[0],t=r[1]),t){var a=O.exec(t);a?(n.time=t.replace(a[1],""),n.timezone=a[1]):n.time=t}return n}(e),T=function(e,t){var n,r=d[t],a=f[t];if(n=l.exec(e)||a.exec(e)){var i=n[1];return{year:parseInt(i,10),restDateString:e.slice(i.length)}}if(n=s.exec(e)||r.exec(e)){var o=n[1];return{year:100*parseInt(o,10),restDateString:e.slice(o.length)}}return{year:null}}(I.date,n),x=T.year,j=function(e,t){if(null===t)return null;var n,r,a,i;if(0===e.length)return(r=new Date(0)).setUTCFullYear(t),r;if(n=m.exec(e))return r=new Date(0),a=parseInt(n[1],10)-1,r.setUTCFullYear(t,a),r;if(n=h.exec(e)){r=new Date(0);var o=parseInt(n[1],10);return r.setUTCFullYear(t,0,o),r}if(n=b.exec(e)){r=new Date(0),a=parseInt(n[1],10)-1;var c=parseInt(n[2],10);return r.setUTCFullYear(t,a,c),r}if(n=v.exec(e))return i=parseInt(n[1],10)-1,_(t,i);if(n=p.exec(e)){i=parseInt(n[1],10)-1;var u=parseInt(n[2],10)-1;return _(t,i,u)}return null}(T.restDateString,x);if(j){var k,A=j.getTime(),D=0;return I.time&&(D=function(e){var t,n,r;if(t=w.exec(e))return(n=parseFloat(t[1].replace(",",".")))%24*a;if(t=g.exec(e))return n=parseInt(t[1],10),r=parseFloat(t[2].replace(",",".")),n%24*a+r*i;if(t=P.exec(e)){n=parseInt(t[1],10),r=parseInt(t[2],10);var o=parseFloat(t[3].replace(",","."));return n%24*a+r*i+1e3*o}return null}(I.time)),I.timezone?(E=I.timezone,k=(B=y.exec(E))?0:(B=C.exec(E))?(R=60*parseInt(B[2],10),"+"===B[1]?-R:R):(B=S.exec(E))?(R=60*parseInt(B[2],10)+parseInt(B[3],10),"+"===B[1]?-R:R):0):(k=new Date(A+D).getTimezoneOffset(),k=new Date(A+D+k*i).getTimezoneOffset()),new Date(A+D+k*i)}var E,B,R;return new Date(e)}},1050:function(e,t,n){"use strict";var r=n(22),a=n(0),i=n(1061),o=n(43),c=Object(o.action)("addSessionMaskedRecipient")(function(e){return Object(a.__awaiter)(this,void 0,void 0,function(){return Object(a.__generator)(this,function(t){return i.a.sessionMaskedRecipients[e]=!0,[2]})})});n.d(t,"b",function(){return s}),n.d(t,"a",function(){return c});var u=new r.c(function(){return n.e(433).then(n.bind(null,14079))}),s=new r.a(u,function(e){return e.execute3SPrimeCall})},1061:function(e,t,n){"use strict";n.d(t,"b",function(){return a});var r=n(2),a=Object(r.createStore)("substratepeoplesuggestions",{sessionMaskedRecipients:[]}),i=a();t.a=i},1068:function(e,t,n){"use strict";var r=n(218),a=n(175),i=n(1149),o=n(230);function c(e,t,n,o,c){void 0===c&&(c=!0);var u=t,s=u.AttachmentId,l=u.Name,f=u.OriginalPermissionType,m=u.PermissionType,h=d(t),b=e.mailboxInfo.type===a.a.GroupMailbox?e.mailboxInfo.primarySmtpAddress+"/":null;switch(n){case 0:case 3:return i.b(s,h,n,o,m,f,c,l,b);case 1:return t.AttachmentPreviewUrl?t.AttachmentPreviewUrl:i.b(s,h,1,o,m,f,c,l,b);case 2:return t.AttachmentThumbnailUrl;default:return Object(r.a)(n)}}function u(e,t,n,r){return void 0===n&&(n=!1),void 0===r&&(r=!0),i.a(e.mailboxInfo.routingKey,e,t,n,r)}function s(e,t,n,r,a){void 0===a&&(a=!1);var s=n?c(e,t,1,r,!1):u(e,1,a,!1);if(n)return{url:s,init:{credentials:"include"}};var d=Object(i.c)(),l=new Headers;return l.set("X-Token",d),l.set("X-OWA-CANARY",Object(o.getOwaCanaryCookie)()),{url:s,init:{headers:l}}}function d(e){var t=null;return(t=e.AttachLongPathName)||(t=e.WebUrl),t}function l(e,t,n,r,a,i){return void 0===i&&(i=!1),r?c(e,t,n,a):u(e,n,i)}n.d(t,"a",function(){return l}),n.d(t,"b",function(){return u}),n.d(t,"c",function(){return s}),n.d(t,"d",function(){return d})},1072:function(e,t,n){"use strict";n.d(t,"d",function(){return r}),n.d(t,"a",function(){return a}),n.d(t,"b",function(){return i}),n.d(t,"c",function(){return o}),n.d(t,"e",function(){return c}),n.d(t,"f",function(){return u});var r=600,a=600,i=650,o=1/2.89*100,c=420,u=420/1300*100},1080:function(e,t,n){"use strict";n.d(t,"d",function(){return a}),n.d(t,"a",function(){return i}),n.d(t,"c",function(){return o}),n.d(t,"b",function(){return c});var r=n(1642);function a(e){return e.isDirty||e.toRecipientWell&&e.toRecipientWell.isDirty||e.ccRecipientWell&&e.ccRecipientWell.isDirty||e.bccRecipientWell&&e.bccRecipientWell.isDirty}function i(e){return Object(r.a)(e.toRecipientWell)+Object(r.a)(e.ccRecipientWell)+Object(r.a)(e.bccRecipientWell)}function o(e){return c(e)&&(2==(t=e).operation||t.toRecipientWell.recipients.some(function(e){return e.persona.EmailAddress.EmailAddress.toLowerCase()===t.groupId.toLowerCase()}));var t}function c(e){return!!e.groupId}},1090:function(e,t,n){"use strict";n.d(t,"s",function(){return s}),n.d(t,"f",function(){return d}),n.d(t,"g",function(){return l}),n.d(t,"h",function(){return f}),n.d(t,"i",function(){return m}),n.d(t,"j",function(){return h}),n.d(t,"k",function(){return b}),n.d(t,"l",function(){return v}),n.d(t,"m",function(){return p}),n.d(t,"n",function(){return w}),n.d(t,"o",function(){return g}),n.d(t,"p",function(){return P}),n.d(t,"q",function(){return O}),n.d(t,"r",function(){return y}),n.d(t,"t",function(){return C});var r=n(2206);n.d(t,"b",function(){return r.a});var a=n(1531);n.d(t,"c",function(){return a.a});var i=n(1492);n.d(t,"e",function(){return i.a});var o=n(22),c=n(1072);n.d(t,"a",function(){return c.a}),n.d(t,"d",function(){return c.d});var u=new o.c(function(){return Promise.all([n.e(584),n.e(13),n.e(18),n.e(26),n.e(438)]).then(n.bind(null,4223))}),s=new o.b(u,function(e){return e}),d=new o.b(u,function(e){return e.resetPreviewPane}),l=(new o.b(u,function(e){return e.setAudioPreviewState}),new o.b(u,function(e){return e.setBlankPreviewState}),new o.b(u,function(e){return e.setCustomPreviewState}),new o.b(u,function(e){return e.setIframePreviewState})),f=(new o.b(u,function(e){return e.setImageGalleryItems}),new o.b(u,function(e){return e.setImagePreviewLoaded})),m=new o.b(u,function(e){return e.setImagePreviewState}),h=new o.b(u,function(e){return e.setImagePreviewStateFromImageGalleryItem}),b=(new o.b(u,function(e){return e.setNativePdfPreviewState}),new o.b(u,function(e){return e.setPanesSize})),v=(new o.b(u,function(e){return e.setPdfJsPreviewState}),new o.b(u,function(e){return e.setPdfJsPreviewStateByData}),new o.b(u,function(e){return e.setPreviewError})),p=new o.b(u,function(e){return e.setPreviewLoading}),w=new o.b(u,function(e){return e.setRightPaneDisplayAndUpdateSize}),g=new o.b(u,function(e){return e.setSaveStatusText}),P=new o.b(u,function(e){return e.setTextPreviewState}),O=(new o.b(u,function(e){return e.setVideoPreviewState}),new o.b(u,function(e){return e.setWacPreviewState})),y=new o.b(u,function(e){return e.setWacReadOnly}),C=new o.b(u,function(e){return e.updatePanesSize})},1105:function(e,t,n){"use strict";function r(e){void 0===e&&(e={}),function(e){e.timeBetweenRetryInMS=e.timeBetweenRetryInMS||function(){return 6e4}}(e);var t=e.maximumAttempts,n=e.timeBetweenRetryInMS;return function(e){var r=0,a=!1,i=function(o,c){a?c(new Error("The function retry was cancelled")):(r++,e().then(function(e){return o(e)}).catch(function(e){t&&r>=t?c(e):setTimeout(function(){return i(o,c)},n(r))}))};return{retriableFunc:function(){return new Promise(function(e,t){return i(e,t)})},cancel:function(){return a=!0}}}}function a(e){return function(t){return Math.pow(2,t)*e}}n.d(t,"b",function(){return r}),n.d(t,"a",function(){return a})},1110:function(e,t,n){"use strict";n.d(t,"b",function(){return i}),n.d(t,"a",function(){return o});var r=n(812),a={};function i(e,t){a[r.a[e]]=t}function o(e){return a[r.a[e]]}},11196:function(e){e.exports={a:"E_a"}},1141:function(e,t,n){"use strict";var r=n(218),a=n(4),i=n(230),o="/owa/",c="service.svc/s/GetFileAttachment?id={0}",u="service.svc/s/GetReferenceAttachment?attachmentId={0}&location={1}",s="service.svc/s/GetAttachmentThumbnail?id={0}&thumbnailType=2",d="service.svc/s/GetReferenceAttachment?attachmentId={0}&location={1}&isImagePreview=True",l="service.svc/s/GetAttachmentThumbnail?id={0}",f="pdfprint.aspx?id={0}",m="pdfprint.aspx?id={0}&location={1}",h=[".bmp",".gif",".jpe",".jpeg",".jpg",".jfif",".dib",".png",".psd",".tiff",".tif"];var b=n(980),v=n(276),p=n(262),w=n(3);function g(e,t,n,c,s,l,f,b,v){var p;switch(void 0===s&&(s=0),void 0===l&&(l=0),void 0===f&&(f=!0),void 0===b&&(b=null),void 0===v&&(v=null),n){case 0:p=u;break;case 3:p=m;break;case 1:if(!function(e){if(!e)return!1;var t=null,n=e.lastIndexOf(".");return n>0&&(t=e.substr(n).toLowerCase()),!!t&&h.indexOf(t.toLowerCase())>=0}(b))return null;p=d;break;default:Object(r.a)(n)}var w=c?l:s;!w&&s&&(w=s);var g=Object(a.b)("{0}{1}{2}&permissionLevel={3}",o,v,Object(a.b)(p,encodeURIComponent(e.Id),encodeURIComponent(t)),w);f&&(g=g+"&X-OWA-CANARY="+Object(i.getOwaCanaryCookie)());return g}function P(e,t,n,u,d){var m;switch(void 0===u&&(u=!1),void 0===d&&(d=!0),n){case 0:m=c;break;case 1:m=s;break;case 2:m=l;break;case 3:m=f;break;default:return Object(r.a)(n)}return Object(a.g)(m)?null:Object(a.b)("{0}{1}{2}",function(e,t,n,r,c){if(void 0===c&&(c=!1),!t||!t.Id)return null;var u=Object(a.b)(n,encodeURIComponent(t.Id));if(!Object(b.c)()||c&&"Firefox"===Object(p.a)().browser)return o+u+"&X-OWA-CANARY="+Object(i.getOwaCanaryCookie)();var s="{0}{1}/{2}&owa={3}&scriptVer={4}";Object(v.a)()&&(s+="&isc=1");var d=Object(a.b)(s,Object(b.b)(),e,u,window.location.hostname,Object(w.f)()||"unofficial");return r&&(d+="&X-OWA-CANARY="+Object(i.getOwaCanaryCookie)(),d+="&token="+Object(b.a)()),d}(e,t,m,d,3===n),u?"&isDownload=true":"","&animation=true")}n.d(t,"b",function(){return g}),n.d(t,"a",function(){return P})},1149:function(e,t,n){"use strict";var r=n(1141);n.d(t,"a",function(){return r.a}),n.d(t,"b",function(){return r.b});var a=n(980);n.d(t,"c",function(){return a.a})},1197:function(e,t){e.exports=function(e){return e instanceof Date}},1237:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(0);function a(e){var t,n,a=[];if(e&&e.recipients)try{for(var i=Object(r.__values)(e.recipients),o=i.next();!o.done;o=i.next()){var c=o.value,u=c.persona.EmailAddress;u&&u.ItemId&&"PrivateDL"==u.MailboxType?a.push({Name:u.Name,RoutingType:u.RoutingType,MailboxType:u.MailboxType,ItemId:{Id:u.ItemId.Id,ChangeKey:null},EmailAddressIndex:u.EmailAddressIndex,RelevanceScore:u.RelevanceScore||0}):a.push(c.persona.EmailAddress)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return a}},1246:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(845);function a(){return(location?location.pathname:"").split("/").indexOf(r.c)>=0}},1294:function(e,t,n){"use strict";var r=n(1246);n(845),n(88),n(870);n(866),n(903);n.d(t,"a",function(){return r.a})},1302:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"GetAccessTokenForDataProviderRequest:#Exchange"},e)}},1324:function(e,t,n){"use strict";var r=n(2),a=Object(r.actionCreator)("ADD_CHAT_TAB",function(e){return{chatConversationId:e}});t.a=a},1329:function(e,t,n){"use strict";var r=n(775),a=n.n(r),i=n(43);function o(e){e&&(e.isDirty=!1)}t.a=Object(i.action)("updateComposeItemId")(function(e,t,n,r){e&&(e.itemId?e.itemId.ChangeKey=n:e.itemId=a()({Id:t,ChangeKey:n}),r&&(e.lastSaveTimeStamp=r,e.isDirty=!1,o(e.toRecipientWell),o(e.ccRecipientWell),o(e.bccRecipientWell)))})},1330:function(e,t,n){"use strict";t.a={TabViewAddTab:{name:"TabViewAddTab",customData:function(e,t,n,r){return[e,t,n]}},TabViewCloseTab:{name:"TabViewCloseTab",customData:function(e,t){return[e.type,e.isShown,e.isActive,t,e.startTime?(new Date).getTime()-e.startTime:0]}},TabViewActivateTab:{name:"TabViewActivateTab",customData:function(e,t){return[e.type,t]},options:{isVerbose:!0}}}},1331:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(0),a=n(1582);function i(e){return Object(r.__awaiter)(this,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(n){switch(n.label){case 0:return[4,a.c.import()];case 1:return t=n.sent(),e&&t(e.referenceItemId&&e.referenceItemId.Id),[2]}})})}},1332:function(e,t,n){"use strict";var r=n(2),a=Object(r.createStore)("MRUAttachmentStore",{attachments:[]});t.a=a},1378:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(2),a=Object(r.action)("messageBeingSent")},1379:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var r=n(0),a=n(999),i=n(801),o=n(909);function c(e,t){var n,c,u=Object(o.b)();try{for(var s=Object(r.__values)(Object(i.a)().tabs),d=s.next();!d.done;d=s.next()){var l=d.value;if(l.type==a.a.Compose&&!l.isShown){var f=u.viewStates.get(l.data);if(f&&f.isInlineCompose&&f.conversationId==e&&(0==f.asyncSendState||t&&6==f.asyncSendState))return f}}}catch(e){n={error:e}}finally{try{d&&!d.done&&(c=s.return)&&c.call(s)}finally{if(n)throw n.error}}return null}},1380:function(e,t,n){"use strict";var r=n(2);t.a=Object(r.action)("onInlineComposeSendStateChange",function(e,t){return{viewState:e,isSendPending:t}})},1477:function(e,t,n){var r=n(1032);e.exports=function(e,t){var n=r(e).getTime(),a=Number(t);return new Date(n+a)}},1534:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r={attachmentTypes:{FILE_ATTACHMENT_TYPE:"FileAttachment:#Exchange",ITEM_ATTACHMENT_TYPE:"ItemAttachment:#Exchange",ITEM_ID_ATTACHMENT_TYPE:"ItemIdAttachment:#Exchange",REFERENCE_ATTACHMENT_TYPE:"ReferenceAttachment:#Exchange"}}},1561:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(199);t.default=function(e){return r.makeServiceRequest("GetAttachmentDownloadToken",{},e)}},1581:function(e,t,n){"use strict";n.d(t,"d",function(){return o}),n.d(t,"b",function(){return c}),n.d(t,"e",function(){return u}),n.d(t,"c",function(){return s}),n.d(t,"a",function(){return d});var r=n(22),a=new r.c(function(){return Promise.all([n.e(5),n.e(527),n.e(145)]).then(n.bind(null,2935))}),i=new r.a(a,function(e){return e.loadCLPUserLabels}),o=new r.b(a,function(e){return e.showJustificationModal}),c=new r.a(a,function(e){return e.loadItemCLPInfo}),u=new r.b(a,function(e){return e.updateItemCLPInfo}),s=new r.b(a,function(e){return e.logReadCLPLabel}),d=Object(r.d)(a,function(e){return e.CLPSubjectHeaderLabel});i.importAndExecute()},1582:function(e,t,n){"use strict";n.d(t,"c",function(){return o}),n.d(t,"b",function(){return c});var r=n(22),a=n(1332);n.d(t,"a",function(){return a.a});var i=new r.c(function(){return n.e(127).then(n.bind(null,2852))}),o=new r.b(i,function(e){return e.getAttachmentSuggestionsAction}),c=new r.b(i,function(e){return e.createCloudFileFromAttachmentData})},1641:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(22),a=new r.c(function(){return n.e(337).then(n.bind(null,2684))}),i=new r.a(a,function(e){return e.loadSignatureInUserOptions});i.importAndExecute()},1642:function(e,t,n){"use strict";function r(e){return e&&e.recipients?e.recipients.length:0}n.d(t,"a",function(){return r})},1681:function(e,t,n){"use strict";var r=n(967),a=n(43),i=n(801);t.a=Object(a.action)("setTabIsShown")(function(e,t){if(e.isShown!=t&&(e.isShown=t,e.blink=t,e.isActive&&!t)){var n=Object(i.a)(),a=n.tabs.indexOf(e),o=n.tabs.filter(function(t){return t.id==e.parentTabId&&t.isShown})[0]||function(e,t){t<0&&(t=0);for(var n=t;n<e.length;n++)if(e[n].isShown)return e[n];for(n=t-1;n>=0;n--)if(e[n].isShown)return e[n];return null}(n.tabs,a);o&&Object(r.a)(o)}})},1716:function(e,t,n){"use strict";var r=n(0),a=n(967),i=n(1330),o=n(990),c=n(812),u=n(30),s=n(801),d=1;t.a=Object(u.b)("addTab",i.a.TabViewAddTab)(function(e,t,n,i){var u=Object(o.a)(),l=Object(s.a)(),f={id:c.a[e]+(d++).toString(),isShown:t,isActive:!1,startTime:(new Date).getTime(),parentTabId:u?u.id:null,blink:t,data:i},m=null;switch(e){case c.a.Primary:m=Object(r.__assign)(Object(r.__assign)({},f),{type:c.a.Primary});break;case c.a.OverflowMenu:m=Object(r.__assign)(Object(r.__assign)({},f),{type:c.a.OverflowMenu,data:i});break;case c.a.SecondaryReadingPane:m=Object(r.__assign)(Object(r.__assign)({},f),{type:c.a.SecondaryReadingPane,data:i});break;case c.a.Compose:m=Object(r.__assign)(Object(r.__assign)({},f),{type:c.a.Compose,data:i});break;case c.a.FloatingChat:m=Object(r.__assign)(Object(r.__assign)({},f),{type:c.a.FloatingChat,data:i,isChatActive:!1})}l.tabs.push(m),n&&Object(a.a)(l.tabs[l.tabs.length-1])})},1741:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(199);t.default=function(e,t){return r.makeServiceRequest("GetWacAttachmentInfo",e,t)}},1761:function(e,t,n){"use strict";var r=n(43);t.a=Object(r.action)("toggleChatTab")(function(e){e.isChatActive=!e.isChatActive,e.isActive=e.isChatActive,e.blink=!1})},1868:function(e){e.exports={a:"jca",b:"kca"}},1870:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(199),a=n(1302);t.default=function(e,t){return void 0===e||e.__type||(e=a.default(e)),r.makeServiceRequest("GetAccessTokenforDataProvider",e,t)}},1871:function(e,t,n){var r=n(1477),a=6e4;e.exports=function(e,t){var n=Number(t);return r(e,n*a)}},2129:function(e,t,n){"use strict";var r=n(0);function a(e,t,n,a,i,o,c,u){return{folderId:null,type:1,listViewType:i,searchNumber:e,queryString:t,searchScope:n,pillSuggestions:Object(r.__spread)(a.values()),includeAttachments:o,fromDate:c,toDate:u,scenarioType:"mail"}}function i(e){var t=e;return 1==e.type?t.scenarioType:void 0}var o=n(757),c=n(759),u=n(761),s=n(776);function d(e){var t=e;return Object(c.z)(t.folderId)?Object(s.e)(t.searchScope,Object(s.c)({folderId:Object(u.a)(o.b),kind:"ArchiveMailbox"})):Object(s.e)(t.searchScope,Object(s.O)({folderId:Object(u.a)(o.i),kind:"PrimaryMailbox"}))}n.d(t,"a",function(){return a}),n.d(t,"b",function(){return i}),n.d(t,"c",function(){return d})},2164:function(e){e.exports={a:"j_a"}},2166:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(199),a=n(2167);t.default=function(e,t){return void 0===e||e.__type||(e=a.default(e)),r.makeServiceRequest("GetAttachmentTextPreview",e,t)}},2167:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"GetAttachmentTextPreviewRequest:#Exchange"},e)}},2206:function(e,t,n){"use strict";var r;n.d(t,"a",function(){return r}),function(e){e[e.Default=0]="Default",e[e.NeedPassword=1]="NeedPassword",e[e.IncorrectPassword=2]="IncorrectPassword"}(r||(r={}))},2222:function(e,t,n){"use strict";function r(e,t){t&&e&&(e.addCustomData({httpStatusCode:t.status}),function(e,t){t&&e&&e.addCustomData({frontendServer:t.get("x-feserver"),requestId:t.get("request-id"),backendServer:t.get("x-beserver"),backendHttpStatus:t.get("x-backendhttpstatus"),serverVersion:t.get("x-owa-version")})}(e,t.headers))}function a(e){return e&&void 0!==e.fetchErrorType}function i(e,t){e.addCustomProperty("ErrorInformation",t)}function o(e,t){i(e,t?"Empty response from server":"Null response from server")}n.d(t,"c",function(){return r}),n.d(t,"a",function(){return a}),n.d(t,"d",function(){return i}),n.d(t,"b",function(){return o})},2294:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"FetchDataProviderResourceRequest:#Exchange"},e)}},2443:function(e,t,n){"use strict";function r(e){var t=e.indexOf("/d/");return e.substring(t+3,e.indexOf("/",t+3))}n.d(t,"a",function(){return r})},3005:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r=n(0),a=n(3006),i=n.n(a),o=n(2294),c=n.n(o),u=n(25);function s(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,function(){var a,o,s,d,l,f,m,h,b,v;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),a=btoa(t),o="u!"+a.replace(/^\=+|\=+$/g,"").replace("/","_").replace("+","-"),s=new RegExp(/.+?\:\/\/.+?(\/)/g).exec(t)[0],d=s+"_api/v2.0/shares/"+o+"/root?select=openWith/wac,officeBundle,@content.downloadUrl,name,size,currentUserRole&action="+(n?"Open":"View"),l=c()({ProviderType:e,Url:d}),f=(new Date).getTime(),[4,i()(l)];case 1:if(200===(m=r.sent()).Status&&m.Body)return h=(new Date).getTime(),(b=JSON.parse(m.Body)).fetchStartTime=f,b.responseStartTime=h,b.openWith.wac.fileGetUrl=b["@content.downloadUrl"],!n&&b.currentUserRole&&(b.currentUserRole.readOnly=!0),[2,b];throw new Error("Result status is: "+m.Status+" or empty response body.");case 2:return v=r.sent(),u.d.warn("Something went wrong while calling fetchDataProviderResourceOperation: "+v),[3,3];case 3:return[2,null]}})})}},3006:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(199),a=n(2294);t.default=function(e,t){return void 0===e||e.__type||(e=a.default(e)),r.makeServiceRequest("FetchDataProviderResource",e,t)}},3069:function(e){e.exports={a:"F_a"}},3097:function(e,t,n){"use strict";n.d(t,"a",function(){return f});var r=n(0),a=n(228),i=n(2222),o=n(3098),c={},u={},s=[],d=0,l=2;function f(e,t,n,i){return Object(r.__awaiter)(this,void 0,void 0,function(){var o,c;return Object(r.__generator)(this,function(u){return o=new a.a("InitializeWacUrl"),n&&o.addCustomProperty("actionSource",n),(c=h(e,t,o))?[2,c]:[2,new Promise(function(a,c){var u={attachmentId:e,isEdit:t,actionSource:n,datapoint:o,resolve:a,reject:c};i?m(u):(s.push(u),function e(){return Object(r.__awaiter)(this,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(n){switch(n.label){case 0:if(!s.length)return[2];if(d>=l)return[2];t=s.shift(),d++,n.label=1;case 1:return n.trys.push([1,,3,4]),[4,m(t)];case 2:return n.sent(),[3,4];case 3:return d--,e(),[7];case 4:return[2]}})})}())})]})})}function m(e){return Object(r.__awaiter)(this,void 0,void 0,function(){var t,n,a,s,d,l,f,m,b;return Object(r.__generator)(this,function(r){switch(r.label){case 0:if(t=e.attachmentId,n=e.isEdit,a=e.actionSource,s=e.datapoint,d=e.resolve,l=e.reject,f=h(t,n,s))return d(f),[2];s.addCustomProperty("ReturnFromCache",!1),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,Object(o.a)(t.Id,n,null,t.mailboxInfo&&t.mailboxInfo.requestOptions,a)];case 2:return 0===(m=r.sent()).Status&&((n?u:c)[t.Id]={expireTime:(new Date).getTime()+36e5,value:m}),m.WacUrl||s.addCustomProperty("WacUrlIsEmpty",!0),s.addCustomProperty("WacAttachmentResponseStatus",m.Status.toString()),s.end(),d(m),[3,4];case 3:return b=r.sent(),Object(i.a)(b)&&Object(i.c)(s,b.response),Object(i.d)(s,b.toString()),s.endWithError("ServerError"),l(b),[3,4];case 4:return[2]}})})}function h(e,t,n){var r=t?u:c,a=r[e.Id];if(a){if(a.expireTime>=(new Date).getTime())return n.addCustomProperty("ReturnFromCache",!0),n.end(),a.value;delete r[e.Id]}return null}},3098:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(1741),a=n.n(r);function i(e,t,n,r,i){if(i){var o="getWacAttachmentInfo"+i;(r=r||{}).headers=r.headers||new Headers,r.headers.set("X-OWA-ActionName",o)}return a()({attachmentId:e,isEdit:t,draftId:n,appId:null},r)}},3515:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var r=n(3669),a=n(3843),i=n(2164),o=n(4);function c(e){switch(e){case 2:return Object(o.a)(a.d);case 3:return Object(o.a)(a.e);case 5:return Object(o.a)(a.c);case 6:return Object(o.a)(r.a);case 7:return Object(o.a)(a.g);case 4:return Object(o.a)(a.f);case 10:return Object(o.a)(a.a);case 11:return Object(o.a)(a.b);default:return Object(o.a)(i.a)}}},3669:function(e){e.exports={a:"G_a"}},3843:function(e){e.exports={d:"I_a",e:"J_a",c:"K_a",g:"L_a",f:"M_a",a:"N_a",b:"O_a"}},3895:function(e,t,n){"use strict";var r;n.d(t,"a",function(){return r}),function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.SINGLE_EVENT_ICS=1]="SINGLE_EVENT_ICS",e[e.MULTIPLE_EVENT_ICS=2]="MULTIPLE_EVENT_ICS"}(r||(r={}))},4177:function(e,t,n){var r=n(5622),a=n(58);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)a.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},4222:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n(2),i=Object(a.action)("initializeReadingPaneInSxS",function(e,t,n,r){return{readingPaneStrategy:e,previewPaneSelectionSource:t,parentItemId:n,instrumentationContext:r}}),o=Object(a.action)("initializeConversationReadingPaneInSxS",function(e,t,n,r){return{readingPaneStrategy:e,previewPaneSelectionSource:t,parentItemId:n,instrumentationContext:r}}),c=Object(a.action)("initializeItemReadingPaneInSxS",function(e,t){return{readingPaneStrategy:e,instrumentationContext:t}}),u=Object(a.action)("initializeReadingPaneInSxSByCopyingMailReadingPane",function(e,t,n){return{previewPaneSelectionSource:e,parentItemId:t,instrumentationContext:n}}),s=n(218),d=n(1249),l=n(877);Object(a.orchestrator)(o,function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var t,n,a,i;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return t=e.readingPaneStrategy,n=e.previewPaneSelectionSource,a=e.parentItemId,i=e.instrumentationContext,t&&t.conversationId?l.F.readingPaneState&&l.F.readingPaneState.mode===l.g.ConversationReadingPane&&l.F.readingPaneState.conversationId&&l.F.readingPaneState.conversationId.Id===t.conversationId.Id?(a&&function(e){switch(e){case l.c.MailList:case l.c.ConversationAttachmentWell:return!0;case l.c.ReadingPane:case l.c.FilesHub:case l.c.PhotoHub:case l.c.GroupFilesHub:case l.c.ConsumerGroupFilesHub:case l.c.Deeplink:case l.c.FileSuggestion:case l.c.LinkSuggestion:case l.c.ComposeDocLink:case l.c.ReadingPaneDocLink:return!1;default:return Object(s.a)(e)}}(n)&&d.k.importAndExecute(a.Id),[2]):[4,d.d.importAndExecute(t.conversationId,i,t.conversationSubject,t.conversationCategories,t.itemIdToScrollTo)]:[2];case 1:return r.sent(),[4,l.x.import()];case 2:return r.sent()({mode:l.g.ConversationReadingPane,conversationId:t.conversationId,conversationCategories:t.conversationCategories,conversationSubject:t.conversationSubject}),a&&d.k.importAndExecute(a.Id),[2]}})})}),Object(a.orchestrator)(c,function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var t,n,a;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return t=e.readingPaneStrategy,n=e.instrumentationContext,t&&t.itemId?l.F.readingPaneState&&l.F.readingPaneState.mode===l.g.ItemReadingPane&&l.F.readingPaneState.itemId&&l.F.readingPaneState.itemId.Id===t.itemId.Id?[2]:[4,l.x.import()]:[2];case 1:return a=r.sent(),[4,d.f.import()];case 2:return[4,r.sent()(t.itemId,n,function(e){a({mode:l.g.ItemReadingPane,itemId:t.itemId,itemReadingPaneViewState:e})})];case 3:return r.sent(),[2]}})})});var f=n(2036),m=n(909),h=n(941),b=n(755),v=n(853),p=n(1294),w=n(999),g=n(2129);Object(a.orchestrator)(u,function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var t,n,a,i,u,s,d,P,O,y,C,S,_,I,T,x,j;return Object(r.__generator)(this,function(k){switch(k.label){case 0:return l.F.shouldShow&&(l.F.readingPaneState||l.F.composeId)?[2]:(t=e.previewPaneSelectionSource,n=e.parentItemId,a=e.instrumentationContext,i=b.N.tableViews.get(b.N.selectedTableViewId).tableQuery,u=Object(b.I)(i)||Object(g.c)(i),s=Object(w.c)(),(d=Object(h.d)())?Object(p.a)()&&window.opener?[2]:d.composeId!==m.a.primaryComposeId?[3,3]:[4,h.q.import()]:[3,7]);case 1:return[4,k.sent()(d,!0,!0)];case 2:k.sent(),s=Object(w.c)(),k.label=3;case 3:return[4,w.g.import()];case 4:return[4,k.sent()(s,!0)];case 5:return k.sent(),[4,l.y.import()];case 6:return k.sent()(d),[2];case 7:if(P=v.a.conversationReadingPaneViewState,O=v.a.deeplinkId)c({method:f.a.LoadItemReadingPane,itemId:{mailboxInfo:O.mailboxInfo,Id:O.id}},a);else if(s&&s.type===w.a.SecondaryReadingPane)switch((y=s.data).listViewType){case 0:o({method:f.a.LoadConversationReadingPane,conversationId:y.id,conversationSubject:y.subject,conversationCategories:y.categories},t,n,a);break;case 1:c({method:f.a.LoadItemReadingPane,itemId:y.id},a)}else if(P&&Object(h.b)(P.conversationId.Id))o({method:f.a.LoadConversationReadingPane,conversationId:P.conversationId,conversationSubject:P.conversationSubject,conversationCategories:P.conversationCategories},t,n,a);else if(C=Object(b.B)(),S=C&&Object(r.__spread)(C.selectedRowKeys.keys()),_=C&&C.isInVirtualSelectAllMode,I=b.N.expandedConversationViewState.selectedNodeIds.length,1==S.length&&I<=1&&!_&&!u)switch(T=b.b.getRowClientItemId(S[0],C),C&&C.tableQuery.listViewType){case 0:x=b.b.getSubject(S[0],C),j=b.b.getCategories(S[0],C),o({method:f.a.LoadConversationReadingPane,conversationId:T,conversationSubject:x,conversationCategories:j},t,n,a);break;case 1:c({method:f.a.LoadItemReadingPane,itemId:T},a)}return[2]}})})}),Object(a.orchestrator)(i,function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var t,n,a,i;return Object(r.__generator)(this,function(r){switch(r.label){case 0:if(t=e.readingPaneStrategy,n=e.previewPaneSelectionSource,a=e.parentItemId,i=e.instrumentationContext,!t)return[2];switch(t.method){case f.a.NoOp:return[3,1];case f.a.AlwaysHidden:return[3,2];case f.a.CopyMailReadingPaneContainer:return[3,4];case f.a.LoadConversationReadingPane:return[3,5];case f.a.LoadItemReadingPane:return[3,6]}return[3,7];case 1:return[2];case 2:return[4,l.x.import()];case 3:return r.sent()(null),[2];case 4:return u(n,a,i),[2];case 5:return o(t,n,a,i),[2];case 6:return c(t,i),[2];case 7:return[2]}})})});var P=n(228),O=n(881),y=n(829),C=n(1043),S=n(2443),_="download",I="open";function T(e){return Object(r.__awaiter)(this,void 0,void 0,function(){var t,n;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return t=Object(S.a)(e.AttachLongPathName),[4,Object(C.l)(t)];case 1:return[2,(n=r.sent()).result&&n.result.webContentLink&&(a=n.result.webContentLink,a.lastIndexOf(_,a.length-_.length)>-1)?x(n.result.webContentLink):null]}var a})})}function x(e){return e.slice(0,-_.length)+I}var j=n(985),k=n(982),A=n(7033),D=n(1068),E=n(3005),B=n(6168),R=n(105),U=n(788),F=n(4),M=n(2164),L=n(3669),N=n(3069),V=n(6287),W=n(4588),Y=n(1090),K=n(25);function H(e){switch(e){case O.b.Unsupported:return"Unsupported";case O.b.Image:return"Image";case O.b.MailItem:return"MailItem";case O.b.CalendarEvent:return"CalendarEvent";case O.b.Wac:return"Wac";case O.b.SuiteExtensions:return"SuiteExtensions";case O.b.Audio:return"Audio";case O.b.Text:return"Text";case O.b.NativeView:return"NativeView";case O.b.GoogleDoc:return"GoogleDoc";case O.b.PdfJs:return"PdfJs";case O.b.ItemAttachment:return"ItemAttachment";case O.b.Video:return"Video";default:return Object(s.a)(e)}}function z(e){switch(e){case"csv":case"ods":case"xls":case"xlsb":case"xlsm":case"xlsx":return"Excel";case"odp":case"pot":case"potm":case"potx":case"pps":case"ppsm":case"ppsx":case"ppt":case"pptm":case"pptx":return"PowerPoint";case"vsd":case"vsdm":case"vsdx":return"Visio";case"doc":case"docm":case"docx":case"dot":case"dotm":case"dotx":case"odt":case"rtf":return"Word";default:return""}}var G="/owa/{0}/service.svc/s/GetAttachmentPdfPreview?id={1}";function J(e,t){return Object(r.__awaiter)(this,void 0,void 0,function(){var n;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return n=Object(F.b)(G,e,encodeURIComponent(t)),[4,fetch(n,{credentials:"same-origin"})];case 1:return[2,r.sent()]}})})}function q(e){return Object(r.__awaiter)(this,void 0,void 0,function(){var t,n,a,i,o,c,u;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return[4,J(e.mailboxInfo&&e.mailboxInfo.routingKey,e.Id)];case 1:return(t=r.sent()).ok?[4,t.text()]:[3,3];case 2:for(n=r.sent(),a=n.replace(/\s/gi,""),i=atob(a),o=i.length,c=new Uint8Array(new ArrayBuffer(o)),u=0;u<o;u++)c[u]=i.charCodeAt(u);return[2,c];case 3:throw t.statusText}})})}var X=n(2100);function Z(e){var t=new Error(e);throw t.isUserError=!0,t}function Q(e){if(null!=e&&e.isUserError)return!0;return!1}var $=n(11196),ee=n(2208),te=[".odp",".pot",".potm",".potx",".pps",".ppsm",".ppsx",".ppt",".pptm",".pptx"];function ne(e){return Object(r.__awaiter)(this,void 0,void 0,function(){return Object(r.__generator)(this,function(t){switch(t.label){case 0:return[4,h.p.import()];case 1:return t.sent()(e.Id,3),[2]}})})}function re(e,t,n,a,o,c,u,s,d){return void 0===d&&(d=l.e.Mail),Object(r.__awaiter)(this,void 0,void 0,function(){function f(){return Object(r.__awaiter)(this,void 0,void 0,function(){var t,n;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return c?[3,1]:(n=null,[3,3]);case 1:return[4,c()];case 2:n=r.sent(),r.label=3;case 3:return t=n,S(),x.setImagePreviewState(re,ie.previewImage.url,t,se),[4,y.k.import()];case 4:return[4,r.sent()(e.attachmentId,e.isReadOnly)];case 5:return r.sent(),S(),x.setImagePreviewState(re,ae(e.attachmentId).previewImage.url,t,se),[2]}})})}function m(){return Object(r.__awaiter)(this,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(n){switch(n.label){case 0:return t=ie.model.ProviderType,function(e,t,n){if(e&&t===y.a.providers.ONE_DRIVE_PRO&&Object(R.e)("doc-SxS-jsApi-ODB-Core")){var r=Object(W.a)(n);if(null!==r)switch(r.app){case U.a.Word:return Object(R.e)("doc-SxS-jsApi-ODB-Word");case U.a.Excel:return Object(R.e)("doc-SxS-jsApi-ODB-Excel");case U.a.PowerPoint:return Object(R.e)("doc-SxS-jsApi-ODB-PowerPoint")}}return!1}(e.isCloudy,t,ie.model.Name)&&t===y.a.providers.ONE_DRIVE_PRO?[4,b()]:[3,2];case 1:return n.sent(),[3,4];case 2:return[4,h()];case 3:n.sent(),n.label=4;case 4:return[2]}})})}function h(){return Object(r.__awaiter)(this,void 0,void 0,function(){var t,n,a,i,c,u;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),t=!1,[4,Object(B.a)(e.attachmentId,t,l.c[o])];case 1:return n=r.sent(),ie.model.Name&&(a=ie.model.Name.lastIndexOf("."))>=0&&(i=ie.model.Name.substr(a).toLowerCase(),se.useHighContrastCommandBar=te.indexOf(i)>=0),S(),x.setWacPreviewState(re,n.wacUrl,null,n.token,_.getTime(),!t,se),[3,3];case 2:if(c=r.sent(),(u=c)&&u.errorMessage)throw K.d.warn("Something went wrong while getting the attachment state: "+u),x.setPreviewError(re,u.errorMessage),u.error;throw c;case 3:return[2]}})})}function b(){return Object(r.__awaiter)(this,void 0,void 0,function(){var e,t,n,a,i,o;return Object(r.__generator)(this,function(r){switch(r.label){case 0:if(r.trys.push([0,2,,3]),de.addCustomData({useJsApi:"true"}),null==(e=ie.openUrl))throw new Error("openUrl is null");return t=ie.model.Name,n=t&&t.substring(t.lastIndexOf(".")),a=".xls"!==n,[4,Object(E.a)(0,e,a)];case 1:if(!(i=r.sent()))throw new Error("Vroom API call failed");return S(),x.setWacPreviewState(re,i.openWith.wac.applicationUrl,{bootScriptUrl:i.openWith.wac.bootstrapperUrl,wopiSrcUrl:i.openWith.wac.wopiSrc,accessToken:i.openWith.wac.accessToken,fileSize:ie.model.Size,fileGetUrl:i.openWith.wac.fileGetUrl,bundleInfo:i.officeBundle,fetchStartTime:i.fetchStartTime,responseStartTime:i.responseStartTime,openUrl:e},null,_.getTime(),i.currentUserRole.readOnly,se),[3,3];case 2:throw o=r.sent(),K.d.warn("Something went wrong while getting the attachment state: "+o.message),x.setPreviewError(re,Object(F.a)(M.a)),o;case 3:return[2]}})})}function v(){return Object(r.__awaiter)(this,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(n){switch(n.label){case 0:return Object(j.b)(ie.model)&&ie.model.ProviderType===y.a.providers.GDRIVE?[4,p()]:[3,2];case 1:return n.sent(),[3,3];case 2:t=Object(D.a)(e.attachmentId,ie.model,3,Object(j.b)(ie.model),e.isReadOnly),x.setNativePdfPreviewState(re,ie.download.url+"&isDocumentPreview=True#toolbar=0",t,"application/pdf",se),n.label=3;case 3:return[2]}})})}function p(){return Object(r.__awaiter)(this,void 0,void 0,function(){var e,t,n;return Object(r.__generator)(this,function(r){switch(r.label){case 0:e=null,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,T(ie.model)];case 2:return(t=r.sent())?(S(),x.setNativePdfPreviewState(re,t,null,"application/pdf",se),[2]):[3,4];case 3:return n=r.sent(),e=n,[3,4];case 4:throw S(),x.setPreviewError(re,Object(F.a)(L.a)),e||new Error("Unexpected error in handleNativeViewPreviewForGDrive")}})})}function w(){return Object(r.__awaiter)(this,void 0,void 0,function(){var t,n,a;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return t=ie.info.allowDownload,n=Object(k.g)(ie.model,!0),t&&n.directFileAccessEnabled?(x.setPdfJsPreviewState(re,ie.download.url+"&isDocumentPreview=True",!1,se),[3,3]):[3,1];case 1:return[4,q(e.attachmentId)];case 2:a=r.sent(),S(),x.setPdfJsPreviewStateByData(re,a,!t&&!Object(k.k)().printWithoutDownloadEnabled,se),r.label=3;case 3:return[2]}})})}function g(){return Object(r.__awaiter)(this,void 0,void 0,function(){var t,n,a;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,Object(A.a)(e.attachmentId.Id,e.attachmentId.mailboxInfo&&e.attachmentId.mailboxInfo.requestOptions,0,l.c[o])];case 1:return t=r.sent(),S(),x.setTextPreviewState(re,t,se),[3,3];case 2:if(n=r.sent(),(a=n)&&a.errorMessage)throw S(),x.setPreviewError(re,a.errorMessage),a.error;throw n;case 3:return[2]}})})}function C(){return Object(r.__awaiter)(this,void 0,void 0,function(){var t,n,a;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return t={calendarItem:null,isIcsAttachmentLoading:!0,icsCalendarEventType:V.a.UNKNOWN,attachmentId:e.attachmentId,addToCalendarStatus:1,errorMessage:null},[4,V.d.import()];case 1:return n=r.sent(),a=null,[4,n({attachmentId:e.attachmentId,size:ie.model.Size,showSizeLimitExceedsError:function(){a=Object(F.a)($.a)},errorCallback:function(){a=Object(F.a)(N.a)},state:t})];case 2:if(r.sent(),S(),a)throw x.setPreviewError(re,a),new Error(a);return I.onShowCustomPreview(t),x.setCustomPreviewState(re,se),[2]}})})}function S(){l.F.pendingPreviewOperation&&le.id===l.F.pendingPreviewOperation.id||Z("Preview changed before loading finished")}var _,I,x,G,J,re,ae,ie,oe,ce,ue,se,de,le,fe;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return _=new Date,[4,l.B.import()];case 1:return I=r.sent(),X.a.available()?(X.a.run(),[4,Y.s.import()]):(I.openSxSInANewWindow(t,e.attachmentId.Id,null),[2]);case 2:return x=r.sent(),G=I.onPreviewOperationStart,J=I.onPreviewOperationFinished,re=l.F.viewState,[4,y.i.import()];case 3:ae=r.sent(),ie=ae(e.attachmentId),oe=e.strategy,ce=oe.isSaveToCloudSupported&&Object(F.g)(ie.model.AttachmentOriginalUrl),ue=ce?l.d.available:l.d.disabled,se={downloadUrl:ie.download.url,downloadShouldOpenNewTab:!1,fileName:ie.model.Name,useHighContrastCommandBar:!1,id:e.attachmentId},de=function(e,t,n,r,a,i){var o=8!==e.attachmentClass&&9!==e.attachmentClass&&Object(U.c)(e.model.Name||"")||e.model.ContentType||"",c=new P.a("PreviewAttachmentInSxSE2E",{isQos:!0});return c.addCustomData({previewMethod:H(t),isCloudy:n?"cloudy":"classic",isChangingFromEditing:r?"changingFromEdit":"",officeFileType:z(o),actionSource:l.c[a],attachmentFileType:i}),c.addCosmosOnlyData(JSON.stringify({attachmentId:e&&e.id&&e.id.Id,fileType:o,fileSize:e.model.Size})),c}(ie,oe.previewMethod,e.isCloudy,l.F.editState.mode!==l.b.View,o,e.fileType),le={id:(new Date).getTime()+"_"+Math.floor(1e3*Math.random()),attachmentId:e.attachmentId},G(le),r.label=4;case 4:return r.trys.push([4,27,,28]),[4,I.canCloseSxS()];case 5:switch(r.sent()||de.addCustomData({exitEditMode:"notSaved"}),S(),i(u,o,t,s),x.setPreviewLoading(re,"",se),I.showSxS(l.F.shouldShow?null:d,{previewMode:oe.previewMethod,attachmentId:e.attachmentId,selectionSource:o,isCloudy:e.isCloudy,saveToCloudStatus:ue,textPreviewReadMode:0},{editAllowed:oe.allowEdit,itemId:t,isDraft:n},null),Object(l.D)(null),oe.previewMethod){case O.b.Image:return[3,6];case O.b.Wac:return[3,8];case O.b.GoogleDoc:return[3,10];case O.b.NativeView:return[3,11];case O.b.PdfJs:return[3,13];case O.b.Audio:return[3,15];case O.b.Video:return[3,16];case O.b.Text:return[3,17];case O.b.ItemAttachment:return[3,19];case O.b.CalendarEvent:return[3,20]}return[3,22];case 6:return[4,f()];case 7:return r.sent(),[3,23];case 8:return[4,m()];case 9:return r.sent(),[3,23];case 10:return x.setIframePreviewState(re,ie.model.AttachLongPathName,se),[3,23];case 11:return[4,v()];case 12:return r.sent(),[3,23];case 13:return[4,w()];case 14:return r.sent(),[3,23];case 15:return x.setAudioPreviewState(re,ie.download.url,se),[3,23];case 16:return x.setVideoPreviewState(re,ie.download.url,se),[3,23];case 17:return[4,g()];case 18:return r.sent(),[3,23];case 19:return Object(ee.a)(e.attachmentId,null),x.setCustomPreviewState(re,se),[3,23];case 20:return[4,C()];case 21:return r.sent(),[3,23];case 22:throw new Error("Unsupported preview method");case 23:return[4,I.waitForPreviewLoadOrThrowError()];case 24:return r.sent(),S(),J(),a?[4,l.q.import()]:[3,26];case 25:r.sent()(ne),r.label=26;case 26:return de.end(),[3,28];case 27:return fe=r.sent(),de.endWithError(Q(fe)?"UserError":"ServerError",fe),[3,28];case 28:return[2]}})})}var ae=n(813),ie=n(1235);function oe(e){return Object(r.__awaiter)(this,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(n){switch(n.label){case 0:return(t=e.viewState&&Object(ae.a)(e.viewState.attachmentId))&&Object(y.e)(t.model)?[4,ie.n.import()]:[3,2];case 1:return n.sent()(t.model,e.parentItemId),[2];case 2:return e.onBeforePreview&&e.onBeforePreview(),[4,re(e.viewState,e.parentItemId,e.isDraft,!1,e.previewPaneSelectionSource,e.createImageGallery,{method:f.a.CopyMailReadingPaneContainer},e.instrumentationContext)];case 3:return n.sent(),[2]}})})}var ce=n(5623);function ue(e,t,n,a){return Object(r.__awaiter)(this,void 0,void 0,function(){var o,c,u,s,d,m,h,b;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return X.a.run(),[4,l.w.import()];case 1:return o=r.sent(),[4,l.v.import()];case 2:return c=r.sent(),u=null,a instanceof HTMLElement?[4,ce.b.import()]:[3,4];case 3:return s=r.sent(),u=s(a),[3,5];case 4:u=a,r.label=5;case 5:u||(u=l.F.viewState),d={downloadUrl:e.downloadUrl,downloadShouldOpenNewTab:!1,useHighContrastCommandBar:!1,id:e.id},m={id:(new Date).getTime()+"_"+Math.floor(1e3*Math.random()),attachmentId:e.id},o(m),r.label=6;case 6:return r.trys.push([6,9,,10]),[4,l.A.import()];case 7:return h=r.sent(),[4,Y.i.import()];case 8:return b=r.sent(),l.F.pendingPreviewOperation&&m.id===l.F.pendingPreviewOperation.id||Z("Preview changed before loading finished"),i({method:f.a.CopyMailReadingPaneContainer},l.c.ReadingPane,null,null),b(u,e.previewUrl,t,d),h(l.F.shouldShow?null:l.e.Mail,{previewMode:O.b.Image,attachmentId:e.id,selectionSource:l.c.ReadingPane,isCloudy:!1,saveToCloudStatus:l.d.disabled,textPreviewReadMode:0},{editAllowed:!1,itemId:n,isDraft:!1},null),Object(l.D)(null),c(),[3,10];case 9:return r.sent(),[3,10];case 10:return[2]}})})}function se(e,t,n,a,o,c,u,s){return void 0===s&&(s=l.e.Mail),Object(r.__awaiter)(this,void 0,void 0,function(){function d(){l.F.pendingPreviewOperation&&y.id===l.F.pendingPreviewOperation.id||Z("Preview changed before loading finished")}var f,m,h,b,v,p,w,g,y,C,S,_,I;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return X.a.run(),f=e(),[4,Y.s.import()];case 1:return m=r.sent(),[4,l.B.import()];case 2:h=r.sent(),b=h.onPreviewOperationStart,v=h.onPreviewOperationFinished,p=l.F.viewState,w={downloadUrl:null,downloadShouldOpenNewTab:!1,useHighContrastCommandBar:!1,id:null,fileName:null},g=function(e,t){var n=new P.a("PreviewLinkInSxSE2E");return n.addCustomData({previewMethod:H(e),actionSource:l.c[t]}),n}(O.b.Wac,n),y={id:(new Date).getTime()+"_"+Math.floor(1e3*Math.random()),attachmentId:null},b(y),r.label=3;case 3:return r.trys.push([3,10,,11]),[4,h.canCloseSxS()];case 4:r.sent(),d(),i(a,n,t,o),m.setPreviewLoading(p,"",w),h.showSxS(l.F.shouldShow?null:s,{previewMode:O.b.Wac,attachmentId:null,selectionSource:n,isCloudy:!0,saveToCloudStatus:l.d.disabled,textPreviewReadMode:0},{editAllowed:!1,itemId:t,isDraft:!1},c),Object(l.D)(c,u),r.label=5;case 5:return r.trys.push([5,7,,8]),[4,f];case 6:return C=r.sent(),d(),C.jsApiInfo&&(w.fileName=C.jsApiInfo.fileName,g.addCustomData({useJsApi:"true"})),m.setWacPreviewState(p,C.wacUrl,C.jsApiInfo,C.token,(new Date).getTime(),u,w),[3,8];case 7:throw S=r.sent(),(_=S)&&_.errorMessage?(m.setPreviewError(p,_.errorMessage),_.error):(m.setPreviewError(p,S.message||""+S),S);case 8:return[4,h.waitForPreviewLoadOrThrowError()];case 9:return r.sent(),d(),v(),g.end(),[3,11];case 10:return I=r.sent(),g.endWithError(Q(I)?"UserError":"ServerError",I),[3,11];case 11:return[2]}})})}n.d(t,"previewAttachment",function(){return oe}),n.d(t,"previewAttachmentInSxS",function(){return re}),n.d(t,"previewImageInSxS",function(){return ue}),n.d(t,"previewLinkInSxS",function(){return se})},4441:function(e){e.exports={a:"g_a"}},4442:function(e){e.exports={a:"i_a"}},4443:function(e){e.exports={a:"h_a"}},4588:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r=n(4441),a=n(4442),i=n(4443),o=n(4),c=n(788),u=n(4177);function s(e){return function(e){switch(Object(c.d)(e)){case c.a.Word:return{app:c.a.Word,displayName:Object(o.a)(i.a),className:u.word,appName:"Word"};case c.a.Excel:return{app:c.a.Excel,displayName:Object(o.a)(a.a),className:u.excel,appName:"Excel"};case c.a.PowerPoint:return{app:c.a.PowerPoint,displayName:Object(o.a)(r.a),className:u.powerpoint,appName:"PowerPoint"};default:return null}}(e&&e.substring(e.lastIndexOf(".")))}},5622:function(e,t,n){(t=e.exports=n(57)(!1)).push([e.i,'._2AgmdyJn3fNov57VaZDxoM{top:0;bottom:0;position:fixed;z-index:2}html[dir] ._2AgmdyJn3fNov57VaZDxoM{background:"[theme:white, default:#ffffff]"}html[dir=ltr] ._2AgmdyJn3fNov57VaZDxoM,html[dir=rtl] ._2AgmdyJn3fNov57VaZDxoM{left:0;right:0}._2AgmdyJn3fNov57VaZDxoM._229sBQxFJ4drfyKjIWkXrL{top:48px;height:calc(100% - 48px)}._1pe2rvEObT1HDN3h-ec1Iw{max-width:calc(100vw - 66px);height:100vh;max-height:calc(100vh - 76px);min-height:100px;overflow:hidden}html[dir] ._1pe2rvEObT1HDN3h-ec1Iw{margin:38px 33px;border-radius:2px;background:"[theme:white, default:#ffffff]"}._1pe2rvEObT1HDN3h-ec1Iw ._1XyC3P-lTM63ywVpBc3nhE{width:100vw}._1pe2rvEObT1HDN3h-ec1Iw .ms-Modal-scrollableContent{overflow:hidden;height:100%}.n6HeOr6RePaAY7uVODnmE{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;height:100%}html[dir=ltr] .n6HeOr6RePaAY7uVODnmE .ms-CommandBar-primaryCommands{margin-left:-4px}html[dir=rtl] .n6HeOr6RePaAY7uVODnmE .ms-CommandBar-primaryCommands{margin-right:-4px}html[dir=ltr] .n6HeOr6RePaAY7uVODnmE .ms-CommandBar-sideCommands{padding-right:0;margin-right:-4px}html[dir=rtl] .n6HeOr6RePaAY7uVODnmE .ms-CommandBar-sideCommands{padding-left:0;margin-left:-4px}._1cPFP118Kj1l5w4ETaiw7h{height:100%}._1cPFP118Kj1l5w4ETaiw7h.LYq6efsEPCIAZmDfweNmN{width:100%;min-width:auto}._3ODPm-UFo5sQvpLi13o_Zo{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;height:100%;-webkit-box-sizing:border-box;box-sizing:border-box;position:relative}html[dir=ltr] ._3ODPm-UFo5sQvpLi13o_Zo{border-left:1px solid "[theme:neutralLight, default:#eaeaea]"}html[dir=rtl] ._3ODPm-UFo5sQvpLi13o_Zo{border-right:1px solid "[theme:neutralLight, default:#eaeaea]"}._3PcY_c6Hos8oY_rUrXUZde{-webkit-box-flex:0;-ms-flex:0 0 44px;flex:0 0 44px}html[dir=ltr] ._3PcY_c6Hos8oY_rUrXUZde .ms-CommandBar-primaryCommand{margin-left:16px}html[dir=rtl] ._3PcY_c6Hos8oY_rUrXUZde .ms-CommandBar-primaryCommand{margin-right:16px}.PKTpY5TnCtiVPeKgU01CK{-webkit-box-flex:0;-ms-flex:0 0 44px;flex:0 0 44px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}html[dir] .PKTpY5TnCtiVPeKgU01CK{background:"[theme:white, default:#ffffff]";border-bottom:1px solid "[theme:neutralLight, default:#eaeaea]"}html[dir=ltr] .PKTpY5TnCtiVPeKgU01CK .ms-CommandBar-primaryCommand{margin-left:10px}html[dir=rtl] .PKTpY5TnCtiVPeKgU01CK .ms-CommandBar-primaryCommand{margin-right:10px}.PKTpY5TnCtiVPeKgU01CK ._3hCbzoGdLCTYiwLiYJ6P0O{-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:default;-webkit-box-flex:0;-ms-flex:0 0 auto;flex:0 0 auto;font-size:16px;font-weight:600;line-height:100%;display:none}html[dir] .PKTpY5TnCtiVPeKgU01CK ._3hCbzoGdLCTYiwLiYJ6P0O{margin-bottom:1px}html[dir=ltr] .PKTpY5TnCtiVPeKgU01CK ._3hCbzoGdLCTYiwLiYJ6P0O{margin-left:24px}html[dir=rtl] .PKTpY5TnCtiVPeKgU01CK ._3hCbzoGdLCTYiwLiYJ6P0O{margin-right:24px}.PKTpY5TnCtiVPeKgU01CK ._3hCbzoGdLCTYiwLiYJ6P0O._10zP7nLlkV0emaGS9TZt2Q{color:#2b569a;display:block}.PKTpY5TnCtiVPeKgU01CK ._3hCbzoGdLCTYiwLiYJ6P0O._3U1WID_PO0RPJSg-4tXXYd{color:#217345;display:block}.PKTpY5TnCtiVPeKgU01CK ._3hCbzoGdLCTYiwLiYJ6P0O._1HU6OGj3jqEQq9qu8WqNoa{color:#b9553b;display:block}.PKTpY5TnCtiVPeKgU01CK ._181cRZ2YFDknIdRumztVMd,.PKTpY5TnCtiVPeKgU01CK ._3f_c8kuGL6tDrquH8vVOdJ{-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:default;max-width:260px;font-size:14px;color:"[theme:neutralPrimary, default:#333333]";line-height:200%;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;-webkit-box-flex:0;-ms-flex:0 0 auto;flex:0 0 auto}html[dir=ltr] .PKTpY5TnCtiVPeKgU01CK ._181cRZ2YFDknIdRumztVMd,html[dir=ltr] .PKTpY5TnCtiVPeKgU01CK ._3f_c8kuGL6tDrquH8vVOdJ{margin-left:12px}html[dir=rtl] .PKTpY5TnCtiVPeKgU01CK ._181cRZ2YFDknIdRumztVMd,html[dir=rtl] .PKTpY5TnCtiVPeKgU01CK ._3f_c8kuGL6tDrquH8vVOdJ{margin-right:12px}html[dir=ltr] .PKTpY5TnCtiVPeKgU01CK ._181cRZ2YFDknIdRumztVMd:first-child,html[dir=ltr] .PKTpY5TnCtiVPeKgU01CK ._3f_c8kuGL6tDrquH8vVOdJ:first-child{margin-left:24px}html[dir=rtl] .PKTpY5TnCtiVPeKgU01CK ._181cRZ2YFDknIdRumztVMd:first-child,html[dir=rtl] .PKTpY5TnCtiVPeKgU01CK ._3f_c8kuGL6tDrquH8vVOdJ:first-child{margin-right:24px}.PKTpY5TnCtiVPeKgU01CK ._3f_c8kuGL6tDrquH8vVOdJ{width:116px;color:"[theme:neutralSecondary, default:#666666]"}html[dir=ltr] .PKTpY5TnCtiVPeKgU01CK ._3f_c8kuGL6tDrquH8vVOdJ{margin-left:6px}html[dir=rtl] .PKTpY5TnCtiVPeKgU01CK ._3f_c8kuGL6tDrquH8vVOdJ{margin-right:6px}.PKTpY5TnCtiVPeKgU01CK ._3BxJzj5Ynr65T_59QJyEf9{-webkit-box-flex:1;-ms-flex:1 0 auto;flex:1 0 auto}html[dir] .PKTpY5TnCtiVPeKgU01CK ._3BxJzj5Ynr65T_59QJyEf9 .ms-Button:not(:hover),html[dir] .PKTpY5TnCtiVPeKgU01CK ._3BxJzj5Ynr65T_59QJyEf9 .ms-CommandBar{background:"[theme:white, default:#ffffff]"}html[dir] .ms-CommandBar.lW23zZctzX6ymR0506r0b{border-bottom:1px solid "[theme:neutralLight, default:#eaeaea]"}._1T-YX5n2-mPNCD5DRlBlWE .ms-CommandBar{--themeDarker:var(--fallback-themeDarker);--themeDark:var(--fallback-themeDark);--themeDarkAlt:var(--fallback-themeDarkAlt);--themePrimary:var(--fallback-themePrimary);--themeSecondary:var(--fallback-themeSecondary);--themeTertiary:var(--fallback-themeTertiary);--themeLight:var(--fallback-themeLight);--themeLighter:var(--fallback-themeLighter);--themeLighterAlt:var(--fallback-themeLighterAlt);--headerBrandText:var(--fallback-headerBrandText);--headerTextIcons:var(--fallback-headerTextIcons);--headerSearchBoxIcon:var(--fallback-headerSearchBoxIcon);--headerSearchPlaceholderText:var(--fallback-headerSearchPlaceholderText);--headerSearchButtonIcon:var(--fallback-headerSearchButtonIcon);--headerSearchFilters:var(--fallback-headerSearchFilters);--headerSearchFiltersHover:var(--fallback-headerSearchFiltersHover);--headerBadgeText:var(--fallback-headerBadgeText);--headerSearchIcon:var(--fallback-headerSearchIcon);--black:var(--fallback-black);--blackTranslucent40:var(--fallback-blackTranslucent40);--white:var(--fallback-white);--whiteTranslucent40:var(--fallback-whiteTranslucent40);--whiteTranslucent90:var(--fallback-whiteTranslucent90);--neutralDark:var(--fallback-neutralDark);--neutralPrimary:var(--fallback-neutralPrimary);--neutralPrimaryAlt:var(--fallback-neutralPrimaryAlt);--neutralSecondary:var(--fallback-neutralSecondary);--neutralTertiary:var(--fallback-neutralTertiary);--neutralTertiaryAlt:var(--fallback-neutralTertiaryAlt);--neutralQuaternary:var(--fallback-neutralQuaternary);--neutralQuaternaryAlt:var(--fallback-neutralQuaternaryAlt);--neutralLight:var(--fallback-neutralLight);--neutralLighter:var(--fallback-neutralLighter);--neutralLighterAlt:var(--fallback-neutralLighterAlt);--redDark:var(--fallback-redDark);--flaggedMessage:var(--fallback-flaggedMessage)}html[dir] ._1T-YX5n2-mPNCD5DRlBlWE .ms-CommandBar{--headerBackground:var(--fallback-headerBackground);--headerBackgroundSearch:var(--fallback-headerBackgroundSearch);--headerSearchBoxBackground:var(--fallback-headerSearchBoxBackground);--headerSearchButtonBackground:var(--fallback-headerSearchButtonBackground);--headerSearchButtonBackgroundHover:var(--fallback-headerSearchButtonBackgroundHover);--headerButtonsBackground:var(--fallback-headerButtonsBackground);--headerButtonsBackgroundHover:var(--fallback-headerButtonsBackgroundHover);--headerButtonsBackgroundSearch:var(--fallback-headerButtonsBackgroundSearch);--headerButtonsBackgroundSearchHover:var(--fallback-headerButtonsBackgroundSearchHover);--headerBadgeBackground:var(--fallback-headerBadgeBackground);--searchBoxBackground:var(--fallback-searchBoxBackground);--richUserContentBackground:var(--fallback-richUserContentBackground);background:"[theme:black, default:#000000]"}html[dir] ._1T-YX5n2-mPNCD5DRlBlWE .ms-CommandBar-overflowButton,html[dir] ._1T-YX5n2-mPNCD5DRlBlWE .ms-CommandBarItem-link{background:"[theme:black, default:#000000]"}._1T-YX5n2-mPNCD5DRlBlWE .ms-CommandBar-overflowButton .ms-Button-menuIcon,._1T-YX5n2-mPNCD5DRlBlWE .ms-CommandBarItem-link:hover:not([disabled]) .ms-Button-icon,._1T-YX5n2-mPNCD5DRlBlWE .ms-CommandBarItem-link:hover:not([disabled]) .ms-Button-textContainer,._1T-YX5n2-mPNCD5DRlBlWE .ms-CommandBarItem-link:not([disabled]) .ms-Button-icon,._1T-YX5n2-mPNCD5DRlBlWE .ms-CommandBarItem-link:not([disabled]) .ms-Button-textContainer{color:"[theme:white, default:#ffffff]"}html[dir] ._1T-YX5n2-mPNCD5DRlBlWE .ms-CommandBar-overflowButton:hover,html[dir] ._1T-YX5n2-mPNCD5DRlBlWE .ms-CommandBarItem-link:hover,html[dir] ._1T-YX5n2-mPNCD5DRlBlWE .ms-CommandBarItem:hover{background:"[theme:neutralDark, default:#212121]"}._1T-YX5n2-mPNCD5DRlBlWE .ms-CommandBarItem-link[disabled] .ms-CommandBarItem-iconColor,._1T-YX5n2-mPNCD5DRlBlWE .ms-CommandBarItem-link:disabled{color:"[theme:neutralSecondary, default:#666666]"}._3lGb8Ny65JvILt8UzD2dU7{display:-webkit-box;display:-ms-flexbox;display:flex;height:calc(100% - 45px);-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto}._3lGb8Ny65JvILt8UzD2dU7:first-child:last-child{height:100%}.amdAASP-UuvTbedSo8gd_{opacity:0}html[dir] .amdAASP-UuvTbedSo8gd_{-webkit-transition:none;transition:none}._1IH6jWRgbk5jrrT7FA3EBR{opacity:0}#app._2dIGUGnogcskHGsQS7Z8zm .customScrollBar{overflow-x:hidden;overflow-y:hidden}',""]),t.locals={owaSxSLayer:"_2AgmdyJn3fNov57VaZDxoM",showOwaHeader:"_229sBQxFJ4drfyKjIWkXrL",owaSxSDialog:"_1pe2rvEObT1HDN3h-ec1Iw",owaSxSDialogSpacer:"_1XyC3P-lTM63ywVpBc3nhE",owaSxS:"n6HeOr6RePaAY7uVODnmE",owaSxSLeftPane:"_1cPFP118Kj1l5w4ETaiw7h",hideRightPane:"LYq6efsEPCIAZmDfweNmN",owaSxSRightPane:"_3ODPm-UFo5sQvpLi13o_Zo",commandBar:"_3PcY_c6Hos8oY_rUrXUZde",commandBarStyleUpdate:"PKTpY5TnCtiVPeKgU01CK",officeOnlineBranding:"_3hCbzoGdLCTYiwLiYJ6P0O",word:"_10zP7nLlkV0emaGS9TZt2Q",excel:"_3U1WID_PO0RPJSg-4tXXYd",powerpoint:"_1HU6OGj3jqEQq9qu8WqNoa",fileName:"_181cRZ2YFDknIdRumztVMd",saveStatus:"_3f_c8kuGL6tDrquH8vVOdJ",commandBarInner:"_3BxJzj5Ynr65T_59QJyEf9",newCommandBar:"lW23zZctzX6ymR0506r0b",highContrastCommandBar:"_1T-YX5n2-mPNCD5DRlBlWE",owaSxSMain:"_3lGb8Ny65JvILt8UzD2dU7",owaSxSDialogRoot:"amdAASP-UuvTbedSo8gd_",owaSxSLayerHidden:"_1IH6jWRgbk5jrrT7FA3EBR",excelWorkAroundForEdge:"_2dIGUGnogcskHGsQS7Z8zm"}},5623:function(e,t,n){"use strict";n.d(t,"b",function(){return i}),n.d(t,"a",function(){return o});var r=n(22),a=new r.c(function(){return Promise.all([n.e(584),n.e(13),n.e(18),n.e(26),n.e(438)]).then(n.bind(null,8204))}),i=new r.b(a,function(e){return e.getSxSViewStateFromElement}),o=Object(r.d)(a,function(e){return e.SxSLayerView});Object(r.d)(a,function(e){return e.SxSView})},6168:function(e,t,n){"use strict";n.d(t,"a",function(){return u});var r=n(0),a=n(2164),i=n(4),o=n(3515),c=n(3097);function u(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,function(){var u,s;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,Object(c.a)(e,t,n,!0)];case 1:return u=r.sent(),[3,3];case 2:throw s=r.sent(),{errorMessage:Object(i.a)(a.a),error:s};case 3:if(0===u.Status)return[2,{wacUrl:u.WacUrl,bootScriptUrl:u.BootScriptUrl,wopiSrcUrl:u.WopiSrcUrl,accessToken:u.AccessToken,token:u.Token}];throw{errorMessage:Object(o.a)(u.Status),error:new Error("GetWacAttachmentInfo failed with status: "+u.Status)}}})})}},6287:function(e,t,n){"use strict";n.d(t,"c",function(){return o}),n.d(t,"d",function(){return c}),n.d(t,"b",function(){return u});var r=n(22),a=n(3895);n.d(t,"a",function(){return a.a});var i=new r.c(function(){return Promise.all([n.e(2),n.e(8),n.e(76),n.e(552),n.e(280)]).then(n.bind(null,9094))}),o=new r.b(i,function(e){return e.addToCalendar}),c=(new r.b(i,function(e){return e.getIcsCalendarItem}),new r.b(i,function(e){return e.getIcsCalendarItemOrchestrator})),u=Object(r.d)(i,function(e){return e.IcsPreview})},7033:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var r=n(0),a=n(2166),i=n.n(a),o=n(25);function c(e,t,n,a){return Object(r.__awaiter)(this,void 0,void 0,function(){var c,u,s,d,l;return Object(r.__generator)(this,function(r){switch(r.label){case 0:c={error:null,errorMessage:"Something went wrong while the document preview was being created. Please try again later."},r.label=1;case 1:return r.trys.push([1,3,,4]),a&&(u="getAttachmentTextPreview"+a,(t=t||{}).headers=t.headers||new Headers,t.headers.set("X-OWA-ActionName",u)),[4,i()({AttachmentId:e,ReadMode:n},t)];case 2:if((s=r.sent())&&0===s.Status)return[2,s.Content];switch(d=s&&s.Status||1){case 2:c.errorMessage="The attachment has been moved or deleted.";break;case 3:c.errorMessage="Something went wrong while the document preview was being created. Please try again later.";break;case 1:default:c.errorMessage="Something went wrong while the document preview was being created. Please try again later."}return c.error=new Error("getAttachmentTextPreview failed with status: "+d),[3,4];case 3:return l=r.sent(),o.d.warn("getAttachmentTextPreview failed with error: "+l),c.error=l,[3,4];case 4:throw c}})})}},796:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(60),a=n(105);function i(){var e=Object(r.a)(),t=e&&e.SessionSettings&&e.SessionSettings.IsExplicitLogon;return(Object(a.e)("rp-3SPeopleSuggestions")||Object(a.e)("rp-linkedInPeopleSuggestions"))&&!t&&e.SessionSettings.IsSubstrateSearchServiceAvailable}},801:function(e,t,n){"use strict";n.d(t,"a",function(){return o}),n.d(t,"b",function(){return c});var r=n(812),a=n(2),i={tabs:[{id:"primaryTab",type:r.a.Primary,isShown:!0,isActive:!0,blink:!1}],tabBarWidth:0,isOverflowMenuShown:!1},o=Object(a.createStore)("tab",i),c=(o(),o().tabs[0])},812:function(e,t,n){"use strict";var r;n.d(t,"a",function(){return r}),function(e){e[e.Primary=0]="Primary",e[e.OverflowMenu=1]="OverflowMenu",e[e.SecondaryReadingPane=2]="SecondaryReadingPane",e[e.Compose=3]="Compose",e[e.FloatingChat=4]="FloatingChat"}(r||(r={}))},813:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(958);function a(e){return Object(r.a)().attachments.get(e.Id)}},845:function(e,t,n){"use strict";n.d(t,"c",function(){return i}),n.d(t,"b",function(){return o}),n.d(t,"h",function(){return c}),n.d(t,"g",function(){return u}),n.d(t,"f",function(){return s}),n.d(t,"d",function(){return d}),n.d(t,"e",function(){return l}),n.d(t,"a",function(){return f});var r=n(0),a=n(955),i="deeplink",o="compose",c="reply",u="replyall",s="read",d="group",l="/"+Object(r.__spread)(["mail"],Object(a.a)().split("/").slice(1)).join("/")+i+"/",f="/"+Object(r.__spread)(["calendar"],Object(a.a)().split("/").slice(1)).join("/")+i+"/"},866:function(e,t,n){"use strict";var r=n(845),a=n(88),i=n(870),o=n(59);function c(e,t){if(t){var n=t.displayName?t.displayName+"<"+t.smtpAddress+">":t.smtpAddress;return e?"&"+e+"="+n:n}return""}function u(e,t){return t?"&"+e+"="+t:""}function s(e){if(!e.to||!e.to.smtpAddress)return"";var t=o.parse(Object(a.a)().search.substr(1));return t.mailtouri=function(e){if(!e.to||!e.to.smtpAddress)return"";var t="mailto:"+c(null,e.to),n="";return n+=c("cc",e.cc),n+=c("bcc",e.bcc),n+=u("subject",e.subject),(n+=u("body",e.body))?t+"?"+n.slice(1):t}(e),Object(i.a)(r.e,r.b,"?"+o.stringify(t))}n.d(t,"a",function(){return s})},870:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(362);function a(e,t,n){var a={pathname:e+t,search:n};return r.format(a)}},903:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(845),a=n(88),i=n(870);function o(e){return e?Object(i.a)(r.e,r.f+"/"+encodeURIComponent(e),Object(a.a)().search):""}},909:function(e,t,n){"use strict";var r=n(6),a=n(2),i={viewStates:new r.ObservableMap,primaryComposeId:null,complianceConfigurations:new r.ObservableMap,messageClassifications:new r.ObservableMap,newMessageCreationInProgress:!1},o=Object(a.createStore)("compose",i),c=o();n.d(t,"a",function(){return c}),n.d(t,"b",function(){return o})},941:function(e,t,n){"use strict";var r=n(1378),a=n(22),i=(n(1641),n(1581),n(79)),o=n(1050),c=n(796),u=new a.c(function(){return n.e(388).then(n.bind(null,13937))}),s=new a.a(u,function(e){return e.initializeCache});Object(i.c)(function(){s.importAndExecute(),Object(c.a)()&&o.b.importAndExecute(!0)});var d=n(979),l=n(1080),f=(n(1329),n(1237)),m=n(1379),h=n(1331),b=n(2),v=Object(b.action)("onComposeAddinsInitialized",function(e){return{hostItemIndex:e}}),p=n(1380),w=n(909),g=n(999);function P(){var e=Object(g.c)(),t=Object(w.b)(),n=e?function(e,t){switch(e.type){case g.a.Primary:return t.primaryComposeId;case g.a.Compose:return e.data;default:return null}}(e,t):t.primaryComposeId,r=n?t.viewStates.get(n):null;return r&&!r.isInlineCompose?r:null}n.d(t,"v",function(){return y}),n.d(t,"m",function(){return C}),n.d(t,"g",function(){return S}),n.d(t,"j",function(){return _}),n.d(t,"p",function(){return I}),n.d(t,"s",function(){return T}),n.d(t,"z",function(){return x}),n.d(t,"q",function(){return j}),n.d(t,"t",function(){return k}),n.d(t,"y",function(){return A}),n.d(t,"u",function(){return D}),n.d(t,"r",function(){return E}),n.d(t,"x",function(){return B}),n.d(t,"i",function(){return R}),n.d(t,"o",function(){return U}),n.d(t,"l",function(){return F}),n.d(t,"w",function(){return M}),n.d(t,"n",function(){return L}),n.d(t,"h",function(){return N}),n.d(t,"k",function(){return V}),n.d(t,"c",function(){return d.c}),n.d(t,"a",function(){return d.b}),n.d(t,"f",function(){return l.d}),n.d(t,"e",function(){return f.a}),n.d(t,"b",function(){return m.a}),n.d(t,"A",function(){return h.a}),n.d(t,"C",function(){return v}),n.d(t,"D",function(){return p.a}),n.d(t,"d",function(){return P}),n.d(t,"B",function(){return r.a});var O=new a.c(function(){return Promise.all([n.e(2),n.e(3),n.e(4),n.e(5),n.e(310)]).then(n.bind(null,13404))}),y=new a.a(O,function(e){return e.replyToMessage}),C=new a.a(O,function(e){return e.forwardMessage}),S=new a.a(O,function(e){return e.closeCompose}),_=new a.a(O,function(e){return e.discardCompose}),I=new a.a(O,function(e){return e.loadDraftToCompose}),T=new a.a(O,function(e){return e.openCompose}),x=new a.a(O,function(e){return e.trySaveAndCloseCompose}),j=new a.a(O,function(e){return e.moveComposeToTab}),k=new a.a(O,function(e){return e.recreateComposeFromViewState}),A=new a.a(O,function(e){return e.tryCreateResendDraft}),D=new a.a(O,function(e){return e.replyToApprovalMessage}),E=new a.a(O,function(e){return e.onEditDraftButtonClicked}),B=new a.a(O,function(e){return e.showSubjectPickerButton}),R=(new a.b(O,function(e){return e.createComposeViewState}),new a.b(O,function(e){return e.createReply})),U=new a.b(O,function(e){return e.getToCcRecipientsForReply}),F=new a.b(O,function(e){return e.findComposePlugins}),M=new a.b(O,function(e){return e.replyToMessageAndCreateViewState}),L=(new a.b(O,function(e){return e.infoBarAddHandler}),new a.b(O,function(e){return e.infoBarRemoveHandler}),new a.b(O,function(e){return e.getNextComposeId})),N=new a.b(O,function(e){return e.createAttachments}),V=new a.b(O,function(e){return e.findComposeFromRecipientWell})},967:function(e,t,n){"use strict";var r=n(812),a=n(1330),i=n(990),o=n(1681),c=n(1761),u=n(30),s=n(1110);t.a=Object(u.b)("activateTab",a.a.TabViewActivateTab)(function(e,t){switch(Object(o.a)(e,!0),e.type){case r.a.FloatingChat:return void Object(c.a)(e);case r.a.Primary:case r.a.OverflowMenu:case r.a.SecondaryReadingPane:case r.a.Compose:if(!e.isActive){var n,a=Object(i.a)();if(a)a.isActive=!1,(n=Object(s.a)(a.type))&&n.onDeactivate&&n.onDeactivate(a);if(e)e.isActive=!0,e.blink=!1,(n=Object(s.a)(e.type))&&n.onActivate&&n.onActivate(e)}return}})},979:function(e,t,n){"use strict";n.d(t,"c",function(){return c}),n.d(t,"a",function(){return a}),n.d(t,"b",function(){return i});var r=n(60),a="HTML",i="Text",o="Html";function c(){return Object(r.a)().UserOptions.ComposeMarkup==o?"HTML":"Text"}},980:function(e,t,n){"use strict";n.d(t,"a",function(){return m}),n.d(t,"c",function(){return h}),n.d(t,"b",function(){return b});var r=n(0),a=n(4),i=n(1105),o=n(1561),c=n.n(o),u=n(60),s=n(228),d=n(25),l=Object(i.b)({timeBetweenRetryInMS:function(){return 3e4}}),f=function(){function e(e,t,n){var i=this;this.downloadTokenRefreshMinutes=e,this.downloadUrlBase=t,this.refreshDownloadTokenAndRetryInCaseOfFailure=function(){return Object(r.__awaiter)(i,void 0,void 0,function(){function e(){return Object(r.__awaiter)(this,void 0,void 0,function(){var e;return Object(r.__generator)(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,c()()];case 1:return[2,t.sent()];case 2:throw e=t.sent(),d.d.warn("Unable to get the download token "+e),e;case 3:return[2]}})})}var t,n,a,i,o=this;return Object(r.__generator)(this,function(c){switch(c.label){case 0:if(this.isRefreshingDownloadToken)return[3,4];this.isRefreshingDownloadToken=!0,t=0,n=l(function(){return Object(r.__awaiter)(o,void 0,void 0,function(){var n;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return t++,n=this,[4,e()];case 1:return n.downloadToken=r.sent(),this.isRefreshingDownloadToken=!1,[2]}})})}).retriableFunc,a=new s.b("AttachmentRefreshDownloadToken"),c.label=1;case 1:return c.trys.push([1,3,,4]),[4,n()];case 2:return c.sent(),a.addCustomData([t]),a.end(),[3,4];case 3:return i=c.sent(),d.d.warn("Retry to refresh token failed: "+i),a.addCustomData([t]),a.endWithError("ServerError",i),this.isRefreshingDownloadToken=!1,[3,4];case 4:return[2]}})})},this.useDownloadUrlBase=!Object(a.g)(this.downloadUrlBase),this.downloadToken=n,this.downloadTokenRefreshMinutes<1&&(this.downloadTokenRefreshMinutes=1),this.useDownloadUrlBase&&setInterval(this.refreshDownloadTokenAndRetryInCaseOfFailure,6e4*this.downloadTokenRefreshMinutes)}return e.getInstance=function(){if(!e.instance){var t=Object(u.a)().ApplicationSettings;e.instance=new e(t.DownloadTokenRefreshMinutes,t.DownloadUrlBase,t.FirstDownloadToken)}return e.instance},e.resetInstanceForTesting=function(){e.instance=null},e.prototype.getDownloadToken=function(){return this.downloadToken},e.prototype.getUseDownloadUrlBase=function(){return this.useDownloadUrlBase},e.prototype.getDownloadUrlBase=function(){return this.downloadUrlBase},e}();function m(){return f.getInstance().getDownloadToken()}function h(){return f.getInstance().getUseDownloadUrlBase()}function b(){return f.getInstance().getDownloadUrlBase()}},982:function(e,t,n){"use strict";var r;!function(e){e.InfoRestrictedAccess="infoRestrictedAccess"}(r||(r={}));var a=n(218);function i(e){switch(e){case 0:return r.InfoRestrictedAccess;default:return Object(a.a)(e)}}var o=n(60);function c(e){switch(e){case 0:return(t=Object(o.a)().AttachmentPolicy).ConditionalAccessDirectFileAccessOnPrivateComputersBlocked||t.ConditionalAccessDirectFileAccessOnPublicComputersBlocked||t.ConditionalAccessPrintWithoutDownloadBlocked||t.ConditionalAccessWacViewingOnPrivateComputersBlocked||t.ConditionalAccessWacViewingOnPublicComputersBlocked;default:return Object(a.a)(e)}var t}var u=[0],s=n(1534);function d(){return u.filter(c)}function l(e){return e&&e.length>0&&function(e){return e.some(function(e){return!((t=e).IsInline&&!function(e){return e.__type===s.a.attachmentTypes.REFERENCE_ATTACHMENT_TYPE}(t));var t})}(e)?u.filter(c):[]}var f=n(1868),m=n(4),h=n(821);function b(e){switch(e){case r.InfoRestrictedAccess:return{key:"access_control_info_bar",source:h.c.Compose,rank:h.b.Error,messageParts:[Object(m.a)(f.b),(t="https://docs.microsoft.com/en-us/intune-user-help/use-managed-devices-to-get-work-done",{text:Object(m.a)(f.a),action:function(){window.open(t,"_blank")}})],color:h.a.Red};default:return Object(a.a)(e)}var t}var v,p=n(788);!function(e){e[e.Undefined=0]="Undefined",e[e.Block=1]="Block",e[e.ForceSave=2]="ForceSave",e[e.Allow=3]="Allow",e[e.ConditionalAccess=4]="ConditionalAccess"}(v||(v={}));var w=function(){function e(e,t){this.attachmentPolicy=e,this.shouldTreatAsPublicLogon=t,this.shouldTreatAsPublicLogon?this.directFileAccessEnabled=this.attachmentPolicy.DirectFileAccessOnPublicComputersEnabled:this.directFileAccessEnabled=this.attachmentPolicy.DirectFileAccessOnPrivateComputersEnabled,this.saveAttachmentsToCloudEnabled=this.attachmentPolicy.AttachmentDataProviderAvailable&&this.attachmentPolicy.SaveAttachmentsToCloudEnabled,this.convertClassicToCloudyEnabled=this.attachmentPolicy.AttachmentDataProviderAvailable&&this.attachmentPolicy.ReferenceAttachmentsEnabled,this.convertCloudyToClassicEnabled=this.attachmentPolicy.AttachmentDataProviderAvailable&&this.attachmentPolicy.ClassicAttachmentsEnabled,this.fileTypeToPolicyMap=this.createPolicyMap(this.attachmentPolicy.BlockedFileTypes,this.attachmentPolicy.ForceSaveFileTypes,this.attachmentPolicy.AllowedFileTypes),this.mimeTypeToPolicyMap=this.createPolicyMap(this.attachmentPolicy.BlockedMimeTypes,this.attachmentPolicy.ForceSaveMimeTypes,this.attachmentPolicy.AllowedMimeTypes),this.policyForUnknownTypes=v[this.attachmentPolicy.ActionForUnknownFileAndMIMETypes],this.printWithoutDownloadEnabled=this.attachmentPolicy.PrintWithoutDownloadEnabled}return e.prototype.getPolicyInfo=function(e,t,n,r){e&&(e=e.toLowerCase());var a=this.getFileAccessLevel(e,t),i=!1,o=!1,c=!1,u="ReferenceAttachment:#Exchange"===r;return a!==v.Block&&n&&(this.isWacViewingEnabled(e)&&(i=!0),!this.directFileAccessEnabled&&u&&(i=!1),o=this.isForceBrowserViewingFirst(i),i&&null!=this.attachmentPolicy.WacEditableFileTypes&&null!=e&&(c="FileAttachment:#Exchange"===r?this.attachmentPolicy.WacEditableFileTypes.indexOf(e)>=0||this.attachmentPolicy.WacConvertibleFileTypes.indexOf(e)>=0:this.attachmentPolicy.WacEditableFileTypes.indexOf(e)>=0&&-1===this.attachmentPolicy.WacConvertibleFileTypes.indexOf(e)),i||this.directFileAccessEnabled||(a=v.ConditionalAccess)),{directFileAccessEnabled:this.directFileAccessEnabled,level:a,useWac:i,forceBrowserViewingFirst:o,wacEdit:c}},e.prototype.isPdfPreviewEnabled=function(){return this.shouldTreatAsPublicLogon?this.attachmentPolicy.WacViewingOnPublicComputersEnabled||this.attachmentPolicy.DirectFileAccessOnPublicComputersEnabled:this.attachmentPolicy.WacViewingOnPrivateComputersEnabled||this.attachmentPolicy.DirectFileAccessOnPrivateComputersEnabled},e.prototype.getFileAccessLevel=function(e,t){var n=this.fileTypeToPolicyMap[e];if(n||(n=v.Undefined),n===v.Block)return v.Block;var r=this.mimeTypeToPolicyMap[t];return r===v.Block?v.Block:n===v.ForceSave||r===v.ForceSave?v.ForceSave:n===v.Allow||r===v.Allow?v.Allow:this.policyForUnknownTypes},e.prototype.isWacViewingEnabled=function(e){return(this.shouldTreatAsPublicLogon?this.attachmentPolicy.WacViewingOnPublicComputersEnabled:this.attachmentPolicy.WacViewingOnPrivateComputersEnabled)&&this.attachmentPolicy.WacViewableFileTypes.indexOf(e)>=0},e.prototype.isForceBrowserViewingFirst=function(e){return!!e&&(this.shouldTreatAsPublicLogon?this.attachmentPolicy.ForceWacViewingFirstOnPublicComputers:this.attachmentPolicy.ForceWacViewingFirstOnPrivateComputers)},e.prototype.addPolicyIntoMap=function(e,t,n){t&&t.forEach(function(t){e[t]=n})},e.prototype.createPolicyMap=function(e,t,n){var r={};return this.addPolicyIntoMap(r,n,v.Allow),this.addPolicyIntoMap(r,t,v.ForceSave),this.addPolicyIntoMap(r,e,v.Block),r},e}(),g=null,P=null;function O(){if(!g){var e=Object(o.a)(),t=e.AttachmentPolicy,n=e.SessionSettings.IsPublicLogon||e.PublicComputersDetectionEnabled&&e.SessionSettings.IsPublicComputerSession;g=new w(t,n),n&&(P=g)}return g}function y(e,t){var n=Object(p.b)(e.Name),r=e.ContentType;return O().getPolicyInfo(n,r,t,e.__type)}function C(e,t){var n=Object(p.b)(e.Name),r=e.ContentType;return function(){if(!P){var e=Object(o.a)();if(e.SessionSettings.IsPublicLogon||e.PublicComputersDetectionEnabled&&e.SessionSettings.IsPublicComputerSession)return O();P=new w(e.AttachmentPolicy,!0)}return P}().getPolicyInfo(n,r,t,e.__type)}function S(e,t,n,r){if(r)return!1;var a=y(e,!0),i=O();return a.level!==v.Block&&i.saveAttachmentsToCloudEnabled&&!t&&n}n.d(t,"a",function(){return u}),n.d(t,"i",function(){return b}),n.d(t,"b",function(){return r}),n.d(t,"d",function(){return d}),n.d(t,"e",function(){return l}),n.d(t,"h",function(){return i}),n.d(t,"j",function(){return S}),n.d(t,"c",function(){return v}),n.d(t,"f",function(){return y}),n.d(t,"g",function(){return C}),n.d(t,"k",function(){return O})},985:function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"b",function(){return i});var r=n(1010);function a(e){return o(e.type)}function i(e){return o(Object(r.a)(e))}function o(e){return 1===e||3===e}},990:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var r=n(0),a=n(812),i=n(801),o=n(25);function c(){var e,t,n=Object(i.a)();try{for(var c=Object(r.__values)(n.tabs),u=c.next();!u.done;u=c.next()){var s=u.value;if(s.isActive&&s.type!=a.a.FloatingChat)return s}}catch(t){e={error:t}}finally{try{u&&!u.done&&(t=c.return)&&t.call(c)}finally{if(e)throw e.error}}return o.d.error("There is no active tab. Something went very wrong."),null}},999:function(e,t,n){"use strict";var r=n(1110),a=n(812),i=n(0),o=n(801);function c(e){var t,n,r=Object(o.a)();try{for(var c=Object(i.__values)(r.tabs),u=c.next();!u.done;u=c.next()){var s=u.value;if(s.type!==a.a.Primary&&s.data==e)return s}}catch(e){t={error:e}}finally{try{u&&!u.done&&(n=c.return)&&n.call(c)}finally{if(t)throw t.error}}return null}var u=n(990),s=n(22),d=n(967),l=n(1716),f=n(1324),m=n(2);Object(m.mutator)(f.a,function(e){var t,n;try{for(var r=Object(i.__values)(Object(o.a)().tabs),c=r.next();!c.done;c=r.next()){var u=c.value;if(u.type==a.a.FloatingChat&&u.data==e.chatConversationId)return void Object(d.a)(u,!0)}}catch(e){t={error:e}}finally{try{c&&!c.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}Object(l.a)(a.a.FloatingChat,!0,!0,e.chatConversationId)});var h=n(849);Object(m.orchestrator)(h.y,function(){Object(d.a)(o.b)}),n.d(t,"e",function(){return v}),n.d(t,"f",function(){return p}),n.d(t,"g",function(){return w}),n.d(t,"h",function(){return g}),n.d(t,"a",function(){return a.a}),n.d(t,"b",function(){return c}),n.d(t,"c",function(){return u.a}),n.d(t,"d",function(){return o.a}),n.d(t,"i",function(){return o.b}),n.d(t,"j",function(){return r.b});var b=new s.c(function(){return Promise.all([n.e(49),n.e(66),n.e(442)]).then(n.bind(null,13647))}),v=new s.a(b,function(e){return e.activateTab}),p=new s.a(b,function(e){return e.addTab}),w=new s.a(b,function(e){return e.closeTab}),g=new s.a(b,function(e){return e.setTabIsShown})}},0,[2,3,8,11,386,4,5,310,39,88,350,0,1,532,182,13,46,124,527,145,531,178,23,119,318,337,433]]);
//# sourceMappingURL=owa.AttachmentPreviewSxS.js.map
self.scriptsLoaded['owa.AttachmentPreviewSxS.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.AttachmentPreviewSxS.js'] = (new Date()).getTime();