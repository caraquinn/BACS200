self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailFolderTreeContainerView~ReadWriteRecipientWell.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[70],{1034:function(e,t,n){"use strict";var r=n(2),i=Object(r.action)("addReadWriteRecipients",function(e,t,n){return void 0===n&&(n=!0),{recipientWell:e,recipientData:t,resetFindResult:n}});t.a=i},1103:function(e,t,n){"use strict";var r=n(1170),i=n(822),a=n(276),s=n(1648);t.a=function(e,t,n){e||(e={EmailAddress:{MailboxType:"OneOff",RoutingType:"SMTP",EmailAddress:n,Name:n}});var c=!e.EmailAddress.Name||Object(s.a)(e.EmailAddress.Name)?e.EmailAddress.EmailAddress:e.EmailAddress.Name;if(!Object(a.a)()){var o=e.EmailAddress.EmailAddress?e.EmailAddress.EmailAddress.split("@")[1]:"",u="ExternalMailbox"===e.EmailAddress.MailboxType||"LinkedIn"===e.EmailAddress.MailboxType;!c||Object(i.a)(c)&&c.split("@")[1]===o||!u||(c=c+" ("+o+")")}return{persona:e,displayText:c,isValid:t,isContextMenuOpen:!1,isSelected:!1,isExpanding:!1,isEditing:!1,isFadedOut:!1,expansionStatus:r.a.None,members:[]}}},1106:function(e,t,n){"use strict";var r=n(4),i=n(890),a=n(956),s=n(7),c=n(184),o=n(25),u=n(43),d=n(760),l=Object(u.action)("localCacheTransactionCompleted")(function(e,t,n,u,l,b){if(void 0===b&&(b=Object(s.Kb)()),e&&e.hasSessionStarted){var f={TransactionRequestTime:Object(s.mb)(b),TransactionRequestDuration:Object(s.w)(Object(s.Kb)(),b),QueryString:Object(r.g)(t)?"":t,QueryStringLength:Object(c.b)(t)?0:t.length,FeatureData:null!=u?u:void 0,personaTypeList:l,ImpressionId:Object(d.a)(),Cvid:e.conversationId},p=JSON.stringify(f),O=JSON.stringify(n),j=Object(a.a)(e,"","LocalCacheTransactionCompleted",O,0,p);Object(i.a)(e,j,!1),o.d.info(Object(r.b)("{0} LocalCacheTransactionCompleted. Session id: {1}",e.entityScenarioName,e.clientSessionId))}}),b=n(1314);function f(e){if(e.findResultSet&&e.findResultSet.length>0){var t=[];e.findResultSet.forEach(function(e){t.push(b.a[e.PersonaTypeString])}),l(e.findPeopleFeedbackManager,e.queryString,(n=e.findResultSet,r=[],n&&n.forEach(function(e,t){r[t]=e.EmailAddress.EmailAddress}),r),null,t)}var n,r}n.d(t,"a",function(){return f})},1119:function(e,t,n){"use strict";var r=n(43);t.a=Object(r.action)("setCommonWellItemSelectedState")(function(e,t){e.isSelected=t})},1136:function(e,t,n){"use strict";n.d(t,"a",function(){return s}),n.d(t,"c",function(){return c}),n.d(t,"b",function(){return u});var r=n(4),i=n(925),a=n(228);function s(e,t,n,i){return o(u(e),t,n,i,function(t,n){Object(a.o)("RecipientCacheHitIndex",[Math.ceil(n/50),!Object(r.g)(e),t.sessionAdd])})}function c(e,t,n,r){return o(e,t,n,r)}function o(e,t,n,r,a){for(var s=[],c=0;s.length<t&&i.a.recipientCache&&c<i.a.recipientCache.length;){var o=i.a.recipientCache[c];if(e(o)){var u=!1,l=o.EmailAddress;n&&d(l,n)&&(u=!0),r&&r.indexOf(l.MailboxType)>=0&&(u=!0),u||(s.push(o),a&&a(o,c))}c++}return s}var u=function(e){return function(t){var n=t.EmailAddress;if(n.EmailAddress&&0==n.EmailAddress.toLowerCase().indexOf(e))return!0;if(n.Name){if(0==n.Name.toLowerCase().indexOf(e))return!0;for(var r=n.Name.toLowerCase().split(" "),i=0;i<r.length;i++)if(0==r[i].indexOf(e))return!0}return!1}};function d(e,t){for(var n=0;n<t.length;n++)if(e.EmailAddress==t[n].EmailAddress.EmailAddress)return!0;return!1}},1217:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r=n(4),i=n(956),a=n(25);function s(e,t){if(Object(r.g)(e.clientSessionId))return a.d.warn(Object(r.b)("{0} - Attempting to create session feedback entry with empty client session id",e.entityScenarioName)),null;var n="";t&&(n=null==t.recipientEmailAddresses?"":JSON.stringify(t.recipientEmailAddresses));var s="";if(!Object(r.g)(t.endSessionAction)){var c={EndSessionAction:t.endSessionAction};s=JSON.stringify(c)}return Object(i.a)(e,"",t.eventType,n,0,s)}},1230:function(e,t,n){"use strict";var r=n(43);t.a=Object(r.action)("updateIsEditing")(function(e,t){e.isEditing=t})},1259:function(e,t,n){"use strict";var r=n(43);t.a=Object(r.action)("setForceResolveState")(function(e,t){e.inForceResolve=t})},1270:function(e,t,n){"use strict";var r=n(0),i=n(1136),a=n(43);t.a=Object(a.action)("getAndPopulateSuggestedContacts")(function(e,t){var n=Object(i.a)("",5,t).map(function(e){return{EmailAddress:e.EmailAddress,PersonaId:e.PersonaId,ADObjectId:e.ADObjectId}});e.splice.apply(e,Object(r.__spread)([0,e.length],n))})},1287:function(e,t,n){"use strict";var r=n(2),i=Object(r.action)("onRecipientsChanged",function(e,t){return{recipientWellRecipients:e,recipientData:t}});t.a=i},1310:function(e,t,n){"use strict";function r(e){return void 0!==e.recipients}n.d(t,"a",function(){return r})},1311:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(1310);function i(e,t){return Object(r.a)(e)?e.recipients:t||[]}},1312:function(e,t,n){"use strict";var r=n(4),i=n(890),a=n(1217),s=n(25),c=n(43);t.a=Object(c.action)("pauseSession")(function(e){if(e&&e.hasSessionStarted&&!e.isSessionPaused){var t=Object(a.a)(e,{eventType:"SessionPaused",recipientEmailAddresses:null,endSessionAction:null});Object(i.a)(e,t,!1),e.isSessionPaused=!0,s.d.info(Object(r.b)("{0} pauseSession : Session paused. Session id: {1}",e.entityScenarioName,e.clientSessionId))}})},1313:function(e,t,n){"use strict";var r=n(4),i=n(890),a=n(1217),s=n(25),c=n(43);t.a=Object(c.action)("resumeSession")(function(e){if(e&&e.isSessionPaused){var t=Object(a.a)(e,{eventType:"SessionResumed",recipientEmailAddresses:null,endSessionAction:null});Object(i.a)(e,t,!1),e.isSessionPaused=!1,s.d.info(Object(r.b)("{0} FeedbackManagerBase.ResumeSession: Session resumed. Session id: {1}",e.entityScenarioName,e.clientSessionId))}})},1314:function(e,t,n){"use strict";t.a={Unknown:0,Person:1,DistributionList:2,ModernGroup:5,ImplicitGroup:10,ExplicitGroup:11,LinkedIn:12}},1315:function(e,t,n){"use strict";var r=n(0),i=n(43),a=n(1658);t.a=Object(i.action)("processSubstrateSuggestionsResponse")(function(e,t,n,i,s){var c,o;if(!t||!t.Groups)throw new Error("Response groups should not be null");var u=[];i=i||20,i=n?i-e.length:i;var d=t.Instrumentation&&t.Instrumentation.TraceId;try{for(var l=Object(r.__values)(t.Groups),b=l.next();!b.done;b=l.next()){var f=b.value;if("People"===f.Type){f.Suggestions.forEach(function(e){if(u.length<i){var t=Object(a.a)(e,d,s);t&&u.push(t)}});break}}}catch(e){c={error:e}}finally{try{b&&!b.done&&(o=l.return)&&o.call(l)}finally{if(c)throw c.error}}n?e.push.apply(e,Object(r.__spread)(u)):e.splice.apply(e,Object(r.__spread)([0,e.length],u))})},1316:function(e,t,n){"use strict";var r=n(2),i=Object(r.action)("removePersonaFromWell",function(e,t,n){return void 0===n&&(n=!1),{targetRecipientWell:e,personaToRemove:t,shouldRemoveAllOccurrences:n}});t.a=i},1335:function(e,t,n){"use strict";t.a={SearchPeopleIndex:{name:"SearchPeopleIndex"},AddRecipientFromFindControl:{name:"AddRecipientFromFindControl",customData:function(e,t){return{index:(e>23?23:e).toString(),source:t.toString()}}},SearchCacheFirst:{name:"SearchCacheFirst"}}},1354:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(925);function i(){return null===r.a.recipientCache||0==r.a.recipientCache.length}},1381:function(e,t,n){"use strict";function r(e){if(e){var t=(e=(e=e.replace(/['"]+/g,"")).trim()).split(/([<\[\({])+/g),n=void 0,r=e;return t.length>=3&&(n=t.slice(0,t.length-2).join("").trim(),r=t[t.length-1].split(/([>\]\)}])+/g)[0].trim()),{EmailAddress:{MailboxType:"OneOff",RoutingType:"SMTP",EmailAddress:r,Name:n||r}}}return{EmailAddress:{EmailAddress:e}}}n.d(t,"a",function(){return r})},1395:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(199),i=n(1548);t.default=function(e,t){return void 0===e||e.__type||(e=i.default(e)),r.makeServiceRequest("AddEntityFeedback",e,t)}},1396:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"AddEntityFeedbackRequest:#Exchange"},e)}},1429:function(e,t,n){"use strict";var r=n(0),i=n(1783),a=n(1259),s=n(918),c=n(1230),o=n(43),u=n(228);t.a=Object(o.action)("resolveAllUnresolvedRecipients")(function(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,function(){var o,d,l;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return Object(a.a)(e,!0),e.queryString=e.queryString.trim(),e.recipients&&e.queryString?(n&&n(),[4,Object(i.a)(e,!1,!0,!0)]):[3,2];case 1:return r.sent(),[3,3];case 2:for(o=-1,d=0;d<t.length;d++)if(t[d].persona&&t[d].persona.EmailAddress&&!t[d].persona.EmailAddress.EmailAddress&&"PrivateDL"!=(l=t[d].persona).EmailAddress.MailboxType&&Object(u.o)("EmptyEmailAddress",[l.EmailAddress.MailboxType,l.EmailAddress.RoutingType]),!t[d].isValid){o=d;break}-1!=o?Object(c.a)(t[o],!0):(Object(a.a)(e,!1),Object(s.a)(e,!1)),r.label=3;case 3:return[2]}})})})},1547:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r=["Id","ADObjectId","DisplayName","EmailAddresses","PeopleSubtype","PeopleType","PDLItemId","PersonaId","ImAddress","JobTitle"]},1548:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"AddEntityFeedbackJsonRequest:#Exchange"},e)}},1568:function(e,t,n){"use strict";var r=n(0),i=n(944);function a(){return"Bound"==Object(i.e)().status}var s=n(105),c=n(760),o=n(174),u=n(1093),d=n(276),l=n(1547),b=n(502),f=n(25);n.d(t,"a",function(){return g});var p="/search/api/v1/init?",O="https://outlook.office365.com/search",j="https://substrate.office.com/SubstrateSearch-Internal.ReadWrite",m="/search/api/v1/suggestions?",h="owa.react.compose",S="20",v="5";function g(e,t,n,i,a){return Object(r.__awaiter)(this,void 0,void 0,function(){var s,u,d,l;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return""!=e?[3,1]:[2,y()];case 1:return[4,R(e,t,a)];case 2:return s=r.sent(),u=function(e,t){return{AppName:"OWA",Scenario:{Name:h},Cvid:t||Object(c.a)(),EntityRequests:[e]}}(s,i&&i.conversationId),d=o.d,l=[m+A(),u,n,!1],[4,I(i&&i.clientSessionId)];case 3:return[2,d.apply(void 0,l.concat([r.sent(),!0,!0,!1])).then(function(e){return e}).catch(function(e){return f.d.error(e),null})]}})})}function y(){return Object(r.__awaiter)(this,void 0,void 0,function(){var e,t,n,i,c,l;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return Object(d.a)()&&Object(s.e)("rp-linkedInPeopleSuggestions")&&a()?((e={}).headers=new Headers,[4,Object(b.getDelegationTokenForOwa)(j)]):[3,3];case 1:return t=r.sent(),e.headers.set("X-User-Context","litoken=bearer"),e.headers.set("Authorization","Bearer "+t),(n=Object(u.c)())&&e.headers.append("X-AnchorMailbox",n),e.method="GET",[4,fetch(window.location.origin+p+A(),e)];case 2:return(i=r.sent())&&200==i.status?[2,i]:(f.d.error("makeInitRequest: Unsuccessful response status"),[2,null]);case 3:return c=o.b,l=[p+A(),void 0,!0],[4,I()];case 4:return[2,c.apply(void 0,l.concat([r.sent(),!0,!1])).then(function(e){return e.json()}).catch(function(e){return f.d.error(e),null})]}})})}function R(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,function(){var i,c;return Object(r.__generator)(this,function(r){return i=Object(s.e)("rp-linkedInPeopleSuggestions")&&a(),c={Query:{QueryString:e},EntityType:"People",Provenances:E(t,i),Size:t?S:v},n&&n.length>0&&(c.Context=function(e){var t={};e&&(t.RecipientsTo=e.toString());return t}(n)),c.Fields=l.a,[2,c]})})}function E(e,t){var n=["Mailbox"];return e&&n.push("Directory"),t&&n.push("LinkedIn"),n}function A(){var e={scenario:h};return Object.keys(e).map(function(t){return t+"="+e[t]}).join("&")}function I(e){return Object(r.__awaiter)(this,void 0,void 0,function(){var t,n;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return t={},e&&(t["client-session-id"]=e),Object(s.e)("rp-linkedInPeopleSuggestions")&&a()?Object(d.a)()?(t["X-User-Context"]="litoken=bearer",[3,3]):[3,1]:[3,3];case 1:return[4,Object(b.getAccessTokenforResource)(O)];case 2:n=r.sent(),t["X-User-Context"]="litoken="+n,r.label=3;case 3:return[2,t]}})})}},1647:function(e,t,n){"use strict";var r=n(0),i=n(2),a=Object(i.action)("removeRecipientFromRecipientWell",function(e,t,n,r){return{recipientIndex:e,recipientWellRecipients:t,onRecipientDeletedCallback:n,deletedRecipient:t.recipients[e],newRecipients:r}});Object(i.mutator)(a,function(e){var t;e.recipientWellRecipients.isDirty=!0,(t=e.recipientWellRecipients.recipients).splice.apply(t,Object(r.__spread)([e.recipientIndex,1],e.newRecipients||[]))}),Object(i.orchestrator)(a,function(e){e.onRecipientDeletedCallback([e.deletedRecipient],e.recipientIndex,e.recipientWellRecipients)}),t.a=a},1648:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=["\t","\n","\v","\f","\r"," ",""," "," "," "," "," "," "," "," "," "," "," "," "," ","\u2028","\u2029"," "," ","　","؜","​","‌","‍","‎","‏","\u2028","\u2029","‪","‫","‬","‭","‮"," ","⁠","⁦","⁧","⁨","⁩"],i=null,a=function(e){return null===i&&(i=new Set,r.forEach(function(e){return i.add(e)})),e.split("").every(function(e){return i.has(e)})}},1658:function(e,t,n){"use strict";var r=n(4),i=n(1061);function a(e,t,n){var a=e.EmailAddresses,u=e.DisplayName,d=e.Text,l=e.PDLItemId,b=e.ADObjectId,f=e.PersonaId,p=e.FeatureData,O=e.Id,j=e.ReferenceId,m=e.ImAddress,h=e.JobTitle,S=e.PeopleSubtype,v=a?a[0]:null;if(!n&&function(e){return Object(i.b)().sessionMaskedRecipients[e]}(v))return null;var g={EmailAddress:v,Name:Object(r.g)(u)?d:u,MailboxType:o(S),RoutingType:s(S),ItemId:l?{Id:l,__type:"ItemId:#Exchange"}:null};return{DisplayName:u,ADObjectId:b,FeatureData:p,Id:O,ImAddress:m,EmailAddress:g,EmailAddresses:[g],PersonaTypeString:c(S),PersonaId:{Id:f},Title:h,ReferenceId:j,TransactionId:t}}function s(e){return"PersonalDistributionList"==e?"MAPIPDL":"SMTP"}function c(e){switch(e){case"PublicDistributionList":case"PersonalDistributionList":return"DistributionList";case"UnifiedGroup":return"ModernGroup";case"OrganizationUser":case"PersonalContact":case"ImplicitContact":case"OrganizationContact":return"Person";case"LinkedIn":return"LinkedIn";case"ImplicitGroup":return"ImplicitGroup";default:return"Unknown"}}function o(e){switch(e){case"PublicDistributionList":return"PublicDL";case"PersonalDistributionList":return"PrivateDL";case"UnifiedGroup":return"GroupMailbox";case"ImplicitGroup":return"RecommendedGroup";case"OrganizationUser":return"InternalMailbox";case"LinkedIn":return"LinkedIn";case"PersonalContact":case"OrganizationContact":case"ImplicitContact":case"Guest":case"Unknown":return"ExternalMailbox";default:return e}}n.d(t,"a",function(){return a})},1686:function(e,t,n){"use strict";function r(e,t){return null!=e&&null!=t&&(e==t||e.EmailAddress&&t.EmailAddress&&null!=e.EmailAddress.EmailAddress&&null!=t.EmailAddress.EmailAddress&&e.EmailAddress.EmailAddress.toLowerCase()==t.EmailAddress.EmailAddress.toLowerCase()||e.ADObjectId&&t.ADObjectId&&e.ADObjectId==t.ADObjectId||e.PersonaId&&t.PersonaId&&e.PersonaId==t.PersonaId)}n.d(t,"a",function(){return r})},1733:function(e,t,n){"use strict";var r=n(0),i=n(1287),a=n(1647),s=n(1119),c=n(43);function o(e,t,n){e[0].isSelected&&n.recipients.length>0&&Object(s.a)(n.recipients[Math.max(0,t-1)],!0)}t.a=Object(c.action)("removeReadWriteRecipients")(function(e,t,n){var s,c;void 0===n&&(n=!0);var u=!1;try{for(var d=Object(r.__values)(t),l=d.next();!l.done;l=d.next()){var b=l.value,f=-1;if((f="number"==typeof b?b:e.recipients.indexOf(b))>=0){if(e.recipients[f].blockWellItemRemoval)return;Object(a.a)(f,e,o),u=!0}}}catch(e){s={error:e}}finally{try{l&&!l.done&&(c=d.return)&&c.call(d)}finally{if(s)throw s.error}}n&&u&&Object(i.a)(e)})},1734:function(e,t,n){"use strict";var r=n(2),i=Object(r.action)("removeRecipientsFromRecipientWells",function(e,t){return{emailAddresses:e,recipientWells:t}});t.a=i},1735:function(e,t,n){"use strict";function r(e){return e?e.EmailAddress&&e.EmailAddress.EmailAddress||e.PersonaId&&e.PersonaId.Id:null}n.d(t,"a",function(){return r})},1767:function(e,t,n){"use strict";var r=n(0),i=n(43);t.a=Object(i.action)("processFindPeopleResult")(function(e,t,n,i){if("Success"!=t.ResponseClass||!t.ResultSet)throw new Error("Response resultSet should not be null");i=i||20,i=n?i-e.length:i,i=t.ResultSet.length>i?i:t.ResultSet.length;for(var c=t.TransactionId,o=[],u=0;u<i;u++){var d=t.ResultSet[u];d.EmailAddress?o.push({EmailAddress:a(d.EmailAddress),PersonaId:d.PersonaId,ADObjectId:d.ADObjectId,PersonaTypeString:d.PersonaTypeString,DisplayName:d.DisplayName,TransactionId:c}):"ImplicitGroup"==d.PersonaTypeString&&o.push({EmailAddress:s(d),PersonaId:d.PersonaId,ADObjectId:d.ADObjectId,Members:d.Members,PersonaTypeString:d.PersonaTypeString,DisplayName:d.DisplayName,TransactionId:c})}n?e.push.apply(e,Object(r.__spread)(o)):e.splice.apply(e,Object(r.__spread)([0,e.length],o))});var a=function(e){return e.RoutingType&&"EX"===e.RoutingType.toUpperCase()?Object(r.__assign)(Object(r.__assign)({},e),{EmailAddress:e.OriginalDisplayName}):e},s=function(e){return{EmailAddress:e.FeedbackId,OriginalDisplayName:e.FeedbackId,Name:e.DisplayName,MailboxType:"GroupMailbox",RoutingType:"SMTP"}}},1783:function(e,t,n){"use strict";var r=n(0),i=n(1034),a=n(904),s=n(43),c=Object(s.action)("setDirectorySearchType")(function(e,t){e.directorySearchType=t}),o=n(928),u=n(918),d=n(1381),l=n(786),b=n(822);t.a=Object(s.action)("resolveQueryStringToRecipient")(function(e,t,n,s){return Object(r.__awaiter)(this,void 0,void 0,function(){var f,p;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return c(e,n?l.a.Manual:l.a.None),(f=e.queryString.trim())?t?(Object(o.a)(e,!1),p=Object(d.a)(f),Object(i.a)(e,[{isValid:Object(b.a)(p.EmailAddress.EmailAddress),newPersona:p}]),[3,4]):[3,1]:[3,5];case 1:return e.queryString.indexOf("@")>=0&&e.inForceResolve?(Object(o.a)(e,!1),Object(i.a)(e,[{isValid:Object(b.a)(f),newPersona:null,newEmailAddress:f}]),[3,4]):[3,2];case 2:return Object(o.a)(e,!0),[4,Object(a.a)(e,e.queryString,n,s)];case 3:r.sent(),r.label=4;case 4:return[3,6];case 5:Object(o.a)(e,!1),Object(u.a)(e,!0,!0),r.label=6;case 6:return[2]}})})})},890:function(e,t,n){"use strict";var r=n(4),i=n(43),a=n(1395),s=n.n(a),c=n(1396),o=n.n(c),u=n(239),d=n(25);function l(e){var t=o()({EntityFeedbackEntries:e});return s()({Header:Object(u.getJsonRequestHeader)(),Body:t}).then(function(e){!function(e){if(e&&e.Body){var t=e.Body;d.d.info(Object(r.b)("addEntityFeedback Error count: {0}",t.ErrorCount)),d.d.info(Object(r.b)("addEntityFeedback error details: {0}",t.ErrorDetails))}}(e)})}t.a=Object(i.action)("attemptToSubmitAddEntityFeedback")(function(e,t,n){e&&t&&(e.entityFeedbackEntries.push(t),(n||e.entityFeedbackEntries.length>=e.maxActionBatchSize)&&(l(e.entityFeedbackEntries),d.d.info(Object(r.b)("{0} Submitted {1} entities.",e.entityScenarioName,e.entityFeedbackEntries.length)),e.entityFeedbackEntries=[]))})},904:function(e,t,n){"use strict";var r=n(0),i=n(1173),a=n.n(i),s=n(943),c=n.n(s),o=n(1078),u=n.n(o),d=n(817),l=n.n(d),b=n(1060),f=n.n(b),p=n(768),O=n.n(p),j=n(1079),m=n.n(j),h=n(239),S=20,v=10,g="owa.react.compose";function y(e){return l()({BasePoint:"Beginning",Offset:0,MaxEntriesReturned:e?S:v})}function R(e){return{__type:"FindPeopleContextInfo:#Exchange",RecipientsTo:e}}function E(e,t,n,r,i){var s=function(e,t,n){var r,i=["Mailbox"];return t&&i.push("Directory"),u()({IndexedPageItemView:y(t),PersonaShape:(r=[O()({FieldURI:"PersonaEmailAddress"}),O()({FieldURI:"EmailAddresses"}),O()({FieldURI:"PersonaDisplayName"}),O()({FieldURI:"PersonaDisplayNames"}),O()({FieldURI:"PersonaId"}),O()({FieldURI:"PersonaType"})],f()({BaseShape:"IdOnly",AdditionalProperties:r})),QuerySources:i,QueryString:e,SearchPeopleSuggestionIndex:!0,ShouldResolveOneOffEmailAddress:!1,Context:[a()({Key:"AppName",Value:"OWA"}),a()({Key:"AppScenario",Value:g})],ContextInfo:R(n||[])})}(e,t,i);return m()(c()({Header:Object(h.getJsonRequestHeader)(),Body:s})).then(function(e){return e.Body})}var A=n(1568),I=n(796);function P(){return Object(I.a)()?A.a:E}var T=n(43),_=n(1034),w=n(1310),C=n(918),F=Object(T.action)("postProcessSuggestionsResult")(function(e,t,n,r){1==e.findResultSet.length&&r&&Object(w.a)(e)?Object(_.a)(e,[{isValid:!0,newPersona:e.findResultSet[0],newEmailAddress:null}]):(e.findResultType=n,Object(C.a)(e,!0,!1,t))}),x=n(1315);function k(e,t){Object(I.a)()?function(e,t){var n,i;try{for(var a=Object(r.__values)(t.Groups),s=a.next();!s.done;s=a.next()){var c=s.value;if("People"===c.Type){var o=c.Suggestions.filter(function(t){return null==e[t.EmailAddresses?t.EmailAddresses[0]:""]});c.Suggestions=o;break}}}catch(e){n={error:e}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(n)throw n.error}}}(e,t):function(e,t){var n=t.ResultSet.filter(function(t){return null==e[t.EmailAddress?t.EmailAddress.EmailAddress:""]});t.ResultSet=n}(e,t)}var D=n(1767),N=Object(T.action)("processResponseResults")(function(e,t,n,r,i){if(n){var a=new Map;e.forEach(function(e){a[e.EmailAddress.EmailAddress]=e}),k(a,t)}Object(I.a)()?Object(x.a)(e,t,n,r,i):Object(D.a)(e,t,n,r)}),M=n(930),q=n(928),L=n(994);function W(e){var t,n="";e&&(Object(I.a)()?(t=e).Groups&&t.Instrumentation&&(n=t.Instrumentation.TraceId):"Success"==(t=e).ResponseClass&&t.ResultSet&&(n=t.TransactionId));return n}var G=n(7),U=n(760),Q=n(786),J=n(4),K=n(890),B=n(956),V=n(184),H=n(25),z=Object(T.action)("transactionCompleted")(function(e,t,n,r,i,a,s,c){if(void 0===c&&(c=null),e&&e.hasSessionStarted){var o={TransactionRequestTime:Object(G.mb)(i),TransactionRequestDuration:Object(G.w)(Object(G.Kb)(),i),QueryString:Object(J.g)(t)?"":t,QueryStringLength:Object(V.b)(t)?0:t.length,PersonaTypeList:s,ImpressionId:r,Cvid:e.conversationId};c&&Object.keys(c).forEach(function(e){o[e]=c[e]}),a&&(o.Context=a);var u=JSON.stringify(o),d=JSON.stringify(n),l=Object(B.a)(e,r,"TransactionCompleted",d,0,u);Object(K.a)(e,l,!1),H.d.info(Object(J.b)("{0} TransactionComplete. Session id: {1}",e.entityScenarioName,e.clientSessionId))}}),X=n(1314);function $(e,t,n){var r=[];e.findResultSet&&e.findResultSet.length>0&&e.findResultSet.forEach(function(e){r.push(X.a[e.PersonaTypeString])});var i,a;z(e.findPeopleFeedbackManager,e.queryString,(i=e.findResultSet,a=[],i&&i.forEach(function(e,t){a[t]=e.Id||e.EmailAddress.EmailAddress||e.EmailAddress.Name}),a),n,t,{Action:"Type Down"},r)}var Y=Object(T.action)("autoSearchDirectory")(function(e,t,n,i){return Object(r.__awaiter)(this,void 0,void 0,function(){var a,s,c,o;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return a=P(),s=Object(G.Kb)(),c=Object(U.a)(),Object(M.b)(e,s,c,!0),[4,a(n,!0,c,e.findPeopleFeedbackManager)];case 1:return o=r.sent(),Object(q.a)(e,!1),e.queryString.trim()==n&&(20,Object(L.a)(e,n),N(e.findResultSet,o,!1,20,!0),Object(M.d)(e,!0,o),$(e,s,W(o)),e.directorySearchType=Q.a.Auto,0==e.findResultSet.length&&(e.findResultSet=[]),F(e,t,Q.b.SearchDirectory,i)),[2]}})})}),Z=n(2),ee=n(1316),te=n(1686),ne=n(1733),re=(Object(Z.orchestrator)(ee.a,function(e){var t=e.targetRecipientWell,n=e.personaToRemove,r=e.shouldRemoveAllOccurrences,i=t.recipients.filter(function(e){return Object(te.a)(e.persona,n)});if(i&&i.length>0){for(var a=r?i.length-1:0,s=[],c=0;c<=a;c++)i[c]&&!i[c].blockWellItemRemoval&&s.push(i[c]);s.length>0&&Object(ne.a)(t,s)}}),n(1734)),ie=(Object(Z.orchestrator)(re.a,function(e){var t=e.recipientWells;t&&0!==t.length&&e.emailAddresses.forEach(function(e){var n={EmailAddress:e};t.filter(function(e){return!!e}).forEach(function(e){return Object(ee.a)(e,n,!0)})})}),n(1103)),ae=Object(Z.action)("addRecipientsToRecipientWell",function(e,t){return{newRecipients:e,recipientWellRecipients:t}}),se=ae;Object(Z.mutator)(ae,function(e){var t,n=e.recipientWellRecipients;(t=n.recipients).splice.apply(t,Object(r.__spread)([n.recipients.length,0],e.newRecipients)),n.isDirty=!0});var ce=Object(Z.mutatorAction)("resetRecipientWell",function(e){e&&(e.queryString="",e.findResultType=Q.b.None)}),oe=n(1429),ue=n(925),de=n(1735),le=Object(T.action)("addToCache")(function(e){e&&0!=e.length&&null!==ue.a.recipientCache&&e.forEach(function(e){if("LinkedIn"!=e.PersonaTypeString){var t=Object(de.a)(e);if(t&&!ue.a.allKeys[t]){var n=Object(r.__assign)(Object(r.__assign)({},e),{sessionAdd:!0});ue.a.recipientCache.push(n),ue.a.allKeys[t]=!0}}})}),be=n(1287),fe=(Object(Z.orchestrator)(_.a,function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var t,n,i,a,s,c,o,u,d,l,b,f,p,O,j;return Object(r.__generator)(this,function(m){switch(m.label){case 0:t=e.recipientWell,n=e.recipientData,i=e.resetFindResult,a=[];try{for(s=Object(r.__values)(n),c=s.next();!c.done;c=s.next())o=c.value,l=Object(ie.a)(o.newPersona,o.isValid,o.newEmailAddress),a.push(l)}catch(e){f={error:e}}finally{try{c&&!c.done&&(p=s.return)&&p.call(s)}finally{if(f)throw f.error}}se(a,t),m.label=1;case 1:m.trys.push([1,7,8,9]),u=Object(r.__values)(a),d=u.next(),m.label=2;case 2:return d.done?[3,6]:(l=d.value,i&&t?(ce(t),Object(C.a)(t,!0,!0),t.inForceResolve?[4,Object(oe.a)(t,t.recipients)]:[3,4]):[3,4]);case 3:m.sent(),m.label=4;case 4:l.isValid&&le([l.persona]),m.label=5;case 5:return d=u.next(),[3,2];case 6:return[3,9];case 7:return b=m.sent(),O={error:b},[3,9];case 8:try{d&&!d.done&&(j=u.return)&&j.call(u)}finally{if(O)throw O.error}return[7];case 9:return Object(be.a)(t,n),[2]}})})}),Object(Z.createStore)("readwriterecipientwell",{pendingFindPeopleRequests:0})()),pe=Object(T.action)("transactionFailed")(function(e,t,n,r,i,a){if(void 0===a&&(a=null),e&&e.hasSessionStarted){var s={TransactionRequestTime:Object(G.mb)(r),TransactionRequestDuration:Object(G.w)(Object(G.Kb)(),r),QueryString:Object(J.g)(t)?"":t,QueryStringLength:Object(V.b)(t)?0:t.length,ImpressionId:n};a&&Object.keys(a).forEach(function(e){s[e]=a[e]}),i&&(s.Context=i);var c=JSON.stringify(s),o=Object(B.a)(e,n,"TransactionFailed",null,0,c);Object(K.a)(e,o,!1),H.d.info(Object(J.b)("{0} TransactionComplete. Session id: {1}",e.entityScenarioName,e.clientSessionId))}});function Oe(e,t,n){pe(e.findPeopleFeedbackManager,e.queryString,n,t,{Action:"Type Down"})}var je=Object(T.action)("backfillCache")(function(e,t){return Object(r.__awaiter)(this,void 0,void 0,function(){var n,i,a,s,c,o,u;return Object(r.__generator)(this,function(r){switch(r.label){case 0:fe.pendingFindPeopleRequests++,n=P(),i=Object(G.Kb)(),a=Object(U.a)(),Object(M.b)(e,i,a,!1),s="",r.label=1;case 1:return r.trys.push([1,3,4,5]),[4,n(t,!1,a)];case 2:return c=r.sent(),s=W(c),o=function(e){if(Object(I.a)()){var t=[];return Object(x.a)(t,e,!1),t}return e.ResultSet}(c),le(o),function(e){if(Object(I.a)()){var t=e;return!t||!t.Groups}var t=e;return"Success"!=t.ResponseClass||0==t.ResultSet.length}(c)||e.queryString!=t||(u=e.findResultSet.length>0,Object(M.d)(e,!1,c),N(e.findResultSet,c,u,5),$(e,i,s)),[3,5];case 3:return r.sent(),Oe(e,i,s),[3,5];case 4:return fe.pendingFindPeopleRequests--,[7];case 5:return[2]}})})});var me=n(1335),he=n(228),Se=Object(T.action)("setFindResultSet")(function(e,t){e.findResultSet=t});var ve=n(1106),ge=Object(T.action)("processCacheResult")(function(e,t,n,i,a){return Object(r.__awaiter)(this,void 0,void 0,function(){var s;return Object(r.__generator)(this,function(c){return i&&(s=new Map,e.findResultSet.forEach(function(e){s[e.EmailAddress.EmailAddress]=e}),t=function(e,t){return t.filter(function(t){return null==e[t.EmailAddress?t.EmailAddress.EmailAddress:""]})}(s,t),(t=Object(r.__spread)(e.findResultSet,t)).splice(5)),Object(q.a)(e,!1),Se(e,t),Object(ve.a)(e),F(e,n,Q.b.Cache,a),[2]})})}),ye=n(1136);function Re(e,t){var n=Object(ye.a)(e,5,t);return 0==n.length?[]:n.map(function(e){return{EmailAddress:e.EmailAddress,PersonaId:e.PersonaId,ADObjectId:e.ADObjectId,PersonaTypeString:e.PersonaTypeString}})}var Ee=n(976),Ae=Object(T.action)("findPeopleCacheFirst")(function(e,t,n,i,a){return Object(r.__awaiter)(this,void 0,void 0,function(){var s,c,o;return Object(r.__generator)(this,function(r){switch(r.label){case 0:if(s=Q.b.Cache,c=new he.a(me.a.SearchCacheFirst.name),e.directorySearchType=Q.a.None,Object(q.a)(e,!0),function(e,t,n,r,i){var a=Object(G.Kb)(),s=Re(e,Object(Ee.a)(t));Object(M.a)(n,a,s),ge(n,s,t,r,i)}(t,n,e,i,a),Object(L.a)(e,t),!(e.findResultSet.length<5))return[3,6];r.label=1;case 1:return r.trys.push([1,5,,6]),e.findResultSet.length>0&&fe.pendingFindPeopleRequests<3?(je(e,t),s=Q.b.MixedCacheLive,[3,4]):[3,2];case 2:return 0!=e.findResultSet.length?[3,4]:[4,je(e,t)];case 3:r.sent(),s=Q.b.FindPeople,r.label=4;case 4:return[3,6];case 5:return o=r.sent(),fe.pendingFindPeopleRequests--,c.endWithError("ServerError",o),[3,6];case 6:return e.findResultSet.length>0?(F(e,n,s,a),[3,9]):[3,7];case 7:return[4,Y(e,n,t,a)];case 8:r.sent(),s=Q.b.SearchDirectory,r.label=9;case 9:return Object(q.a)(e,!1),c.addCustomData([s,t==e.queryString]),c.end(),[2]}})})}),Ie=5;var Pe=n(1311),Te=n(105),_e=n(1354),we=Object(T.action)("searchCacheFallback")(function(e,t,n,r,i,a){if(e.queryString.trim()==t.trim()){var s=Object(G.Kb)(),c=Re(t,Object(Ee.a)(n));Object(M.a)(e,s,c,!0),Object(L.a)(e,t),e.directorySearchType=Q.a.None,c.length>0?ge(e,c,n,r,i):a&&(a.isCacheEmpty=!0)}});t.a=Object(T.action)("findReadWriteRecipient")(Object(T.select)({store:function(){return fe}})(function(e,t,n,i,a,s,c,o){return Object(r.__awaiter)(this,void 0,void 0,function(){var u,d,l,b,f,p,O,j,m,h,S,v,g,y,R,E,A,T,_;return Object(r.__generator)(this,function(w){switch(w.label){case 0:return n||Object(M.c)(e),u=Object(Pe.a)(e,a),d=!1,e.shouldShowFindResult||Object(C.a)(e,!0,!1,u),s&&s.length>0&&(l=function(e,t){var n=[];if(t){var r=0;for(e=e.toLowerCase();n.length<Ie&&r<t.length;){var i=t[r].persona.EmailAddress;(i.EmailAddress&&0==i.EmailAddress.toLowerCase().indexOf(e)||i.Name&&0==i.Name.toLowerCase().indexOf(e))&&n.push({EmailAddress:i}),r++}}return n}(t,s))&&l.length>0&&(e.findResultSet=l,d=!0),!c&&!Object(Te.e)("rp-peopleSuggestionsCacheFirst")||n?[3,2]:[4,Ae(e,t,u,d,i)];case 1:return w.sent(),[2];case 2:return b=!1,o.store.pendingFindPeopleRequests<3?(_=new he.a(me.a.SearchPeopleIndex.name),Object(q.a)(e,!0),f=e.currentRenderedQueryString,p=e.directorySearchType,Object(Te.e)("rp-optimizeAutoSearchDirectory")&&""!=f&&!n&&p==Q.a.Auto&&f.length<t.length&&0==t.indexOf(e.currentRenderedQueryString)?[4,Y(e,u,t,i)]:[3,4]):[3,12];case 3:return w.sent(),b=!0,_.addCustomData([!1,!0,!0,!1,!0,Object(I.a)()]),_.end(),[3,11];case 4:O={isTimedOut:!1,isCacheEmpty:!1},j=n||Object(_e.a)()?null:setTimeout(function(e,t,n,i,a,s){return function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(r){return s.isTimedOut=!0,we(e,n,t,i,a,s),[2]})})}}(e,u,t,d,i,O),1e3),m=Object(G.Kb)(),h="",w.label=5;case 5:return w.trys.push([5,10,,11]),o.store.pendingFindPeopleRequests++,S=P(),v=[],u.forEach(function(e){v.push(e.persona.EmailAddress.EmailAddress)}),g=Object(U.a)(),Object(M.b)(e,m,g,n),[4,S(t,n,g,e.findPeopleFeedbackManager,v)];case 6:return y=w.sent(),o.store.pendingFindPeopleRequests--,clearTimeout(j),R=e.queryString==t,Object(M.d)(e,n,y),O.isTimedOut&&!O.isCacheEmpty||!R?[3,9]:(Object(L.a)(e,t),e.directorySearchType=n?Q.a.Manual:Q.a.None,E=n?20:5,N(e.findResultSet,y,d,E,n),h=W(y),$(e,m,h),e.findResultSet.length>0?(Object(q.a)(e,!1),A=n?Q.b.SearchDirectory:Q.b.FindPeople,F(e,u,A,i),[3,9]):[3,7]);case 7:return we(e,t,u,d,i),0!==e.findResultSet.length?[3,9]:(b=!0,[4,Y(e,u,t,i)]);case 8:w.sent(),w.label=9;case 9:return _.addCustomData([O.isTimedOut,R,n,O.isCacheEmpty,b,Object(I.a)()]),_.end(),[3,11];case 10:return T=w.sent(),o.store.pendingFindPeopleRequests--,_.endWithError("ServerError",T),Oe(e,m,h),we(e,t,u,d,i),[3,11];case 11:return[3,13];case 12:_=new he.a("FindPeopleThresholdHit"),we(e,t,u,d,i),_.end(),w.label=13;case 13:return Object(q.a)(e,!1),[2]}})})}))},918:function(e,t,n){"use strict";var r=n(1311),i=n(1312),a=n(1313),s=n(1270),c=n(1106),o=n(976),u=n(43);t.a=Object(u.action)("showHideFindResult")(function(e,t,n,u){var d=e.findResultSet?e.findResultSet.length:0;if(e.findResultHightlightIndex=-1,n&&d&&e.findResultSet.splice(0,d),t)if(Object(a.a)(e.findPeopleFeedbackManager),0!=e.queryString.length||e.inForceResolve)e.findResultHightlightIndex=0;else{var l=Object(r.a)(e,u);Object(s.a)(e.findResultSet,Object(o.a)(l)),Object(c.a)(e)}else Object(i.a)(e.findPeopleFeedbackManager);e.shouldShowFindResult=t})},925:function(e,t,n){"use strict";var r=n(2),i=Object(r.createStore)("recipientcache",{recipientCache:null,allKeys:{}})();t.a=i},928:function(e,t,n){"use strict";var r=n(43);t.a=Object(r.action)("setIsSearching")(function(e,t){e.isSearching!=t&&(e.isSearching=t)})},930:function(e,t,n){"use strict";var r=n(7),i=n(796);n.d(t,"c",function(){return u}),n.d(t,"b",function(){return d}),n.d(t,"d",function(){return l}),n.d(t,"a",function(){return b});var a="Cache",s="Mailbox",c="Directory",o=" Fallback";function u(e){e.peopleFeedbackState={live:null,cache:null,directory:null}}function d(e,t,n,a){if(Object(i.a)()&&e.peopleFeedbackState){var o={CorrelationId:"",TimeStamp:"",QueryString:"",SuggestionSource:"",RawResponse:""};o.TimeStamp=Object(r.wb)(t),o.QueryString=e.queryString,o.SuggestionSource=a?c:s,o.RawResponse="pending",n&&(o.CorrelationId=n),a?e.peopleFeedbackState.directory=o:e.peopleFeedbackState.live=o}}function l(e,t,n){if(Object(i.a)()&&e.peopleFeedbackState){var r=n?JSON.stringify(n):"no response";t?e.peopleFeedbackState.directory.RawResponse=r:e.peopleFeedbackState.live.RawResponse=r}}function b(e,t,n,s){if(Object(i.a)()&&e.peopleFeedbackState){var c={CorrelationId:"",TimeStamp:"",QueryString:"",SuggestionSource:"",RawResponse:""};c.QueryString=e.queryString,c.TimeStamp=Object(r.wb)(t),c.SuggestionSource=s?a+o:a,c.RawResponse=JSON.stringify(n),e.peopleFeedbackState.cache=c}}},956:function(e,t,n){"use strict";var r=n(4),i=n(43),a=Object(i.action)("increaseEntrySequenceNumber")(function(e){e&&e.entrySequenceNumber++}),s=n(184),c=n(25),o=n(7);function u(e,t,n,i,u,d,l,b){if(void 0===b&&(b=Object(o.Kb)()),!e)return c.d.warn("Attempting to create entity feedback entry with invalid feedbackManager"),null;if(Object(s.b)(e.clientSessionId))return c.d.warn(Object(r.b)("{0} - Attempting to create entity feedback entry with empty client session id",e.entityScenarioName)),null;var f={ClientEventTimeUtc:Object(o.ob)(b),ClientEventTimeLocal:Object(o.mb)(b),ClientSessionId:e.clientSessionId,ClientVersion:e.clientVersion,ClientId:e.clientId,EntityType:e.entityType,EntrySequenceNumber:e.entrySequenceNumber,TransactionId:t,EventType:n,TargetEntityList:i,EntityAddSource:u,JsonPropertyBag:d,ScenarioName:l||e.entityScenarioName};return a(e),f}n.d(t,"a",function(){return u})},976:function(e,t,n){"use strict";function r(e){var t=[];return e&&(t=e.map(function(e){return e.persona})),t}n.d(t,"a",function(){return r})},994:function(e,t,n){"use strict";var r=n(43);t.a=Object(r.action)("updateCurrentRenderedQueryString")(function(e,t){e.currentRenderedQueryString=t})}}]);
//# sourceMappingURL=owa.MailFolderTreeContainerView~ReadWriteRecipientWell.js.map
self.scriptsLoaded['owa.MailFolderTreeContainerView~ReadWriteRecipientWell.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailFolderTreeContainerView~ReadWriteRecipientWell.js'] = (new Date()).getTime();