self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.OutlookServiceOptions.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[351],{13917:function(e,t,n){"use strict";n.r(t);var o=n(0),r=n(184),a=n(43),i=Object(a.action)("setFeatureSettings")(function(e,t,n){e.options[t]=n}),u=n(826),c=n(1277),s=n(1018),d=n(760),f=n(174),p=n(105),O=n(25),l="ows/v1.0/OutlookOptions/{0}";function b(e,t){var n=Object(r.a)(l,u.a[e]);if(Object(s.a)().loadState===c.a.OptionsLoaded){if(Object(s.a)().options[e]&&Object(s.a)().options[e].lastModifiedDateTime){if(t&&0!==Object.keys(t).length){var a=t;a["feature@is.Queryable"],a["feature@odata.type"],a.createdDateTime,a.lastModifiedDateTime;return j(1,n,Object(o.__rest)(a,["feature@is.Queryable","feature@odata.type","createdDateTime","lastModifiedDateTime"]))}return O.d.info("createOrUpdateOptionsForFeature called with no changes to options"),Promise.resolve()}return j(0,n,t)}return Promise.reject("Options are not loaded. Cannot update options.")}function j(e,t,n){var o={correlationId:Object(d.a)(),options:n};return(1==e?f.c:f.d)(t,o,o.correlationId,void 0,{PreferOption:Object(p.e)("fwk-option-useRestCore")&&"Ows.UseRestCore"}).then(function(e){if(!function(e){if(e&&e.options&&1==e.options.length){var t=e.options[0];return i(Object(s.a)(),t.feature,t),!0}return!1}(e))throw new Error("Error processing options response")})}var w=n(912),v=n(112),m=Object(a.action)("applyDefaultOptions")(function(e){void 0===e&&(e=Object(w.a)()),Object.keys(Object(s.a)().options).forEach(function(t){Object(s.a)().options[t].lastModifiedDateTime||e[t]&&v(Object(s.a)().options[t],e[t])})}),h=n(1295),S=null,A=Object(a.action)("loadOptions")(function(){switch(Object(s.a)().loadState){case c.a.OptionsNotLoaded:return Object(s.a)().loadState=c.a.OptionsLoading,S=Object(f.b)("ows/v1.0/OutlookOptions",void 0,void 0,{PreferOption:Object(p.e)("fwk-option-useRestCore")&&"Ows.UseRestCore"}).then(function(e){!function(e){e?(e.options&&e.options.forEach(function(e){null!=e&&i(Object(s.a)(),e.feature,e)}),m(),Object(s.a)().loadState=c.a.OptionsLoaded):(O.d.info("Error loading options"),Object(h.a)(),Object(s.a)().loadState=c.a.OptionsNotLoaded)}(e),S=null});case c.a.OptionsLoading:return S;case c.a.OptionsLoaded:return Promise.resolve()}});var k=n(1024);function E(e){return Object(o.__awaiter)(this,void 0,void 0,function(){return Object(o.__generator)(this,function(t){switch(t.label){case 0:return[4,A()];case 1:return t.sent(),[2,Object(k.a)(e)]}})})}var P=Object(a.action)("updateAddinPinStatus")(function(e,t,n){var o=Object(k.a)(u.a.SurfaceActions),r=Object(k.a)(u.a.CalendarSurfaceAddins),a=!!n.readMode&&g(o.readSurfaceAddins,e,t);a=n.composeMode&&g(o.composeSurfaceAddins,e,t)||a;var i=!!n.calendarMode&&g(r.calendarSurfaceAddins,e,t);a&&b(u.a.SurfaceActions,o),i&&b(u.a.CalendarSurfaceAddins,r)}),g=function(e,t,n){var o=!1;return n?-1===e.indexOf(t)&&(e.push(t),o=!0):-1!==e.indexOf(t)&&(e.splice(e.indexOf(t),1),o=!0),o};n.d(t,"createOrUpdateOptionsForFeature",function(){return b}),n.d(t,"loadOptions",function(){return A}),n.d(t,"getServerOptionsForFeature",function(){return E}),n.d(t,"updateAddinPinStatus",function(){return P})},174:function(e,t,n){"use strict";n.d(t,"d",function(){return a}),n.d(t,"c",function(){return i}),n.d(t,"e",function(){return u}),n.d(t,"b",function(){return c}),n.d(t,"a",function(){return s});var o=n(22),r=(n(280),new o.c(function(){return n.e(362).then(n.bind(null,697))})),a=(new o.a(r,function(e){return e.makeOwsPrimeRequest}).importAndExecute,new o.a(r,function(e){return e.makePostRequest}).importAndExecute),i=new o.a(r,function(e){return e.makePatchRequest}).importAndExecute,u=new o.a(r,function(e){return e.makePutRequest}).importAndExecute,c=new o.a(r,function(e){return e.makeGetRequest}).importAndExecute,s=new o.a(r,function(e){return e.makeDeleteRequest}).importAndExecute},280:function(e,t,n){"use strict";n.d(t,"b",function(){return o}),n.d(t,"a",function(){return r});var o="owsserver",r="owsapi"}}]);
//# sourceMappingURL=owa.OutlookServiceOptions.js.map
self.scriptsLoaded['owa.OutlookServiceOptions.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.OutlookServiceOptions.js'] = (new Date()).getTime();