self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailSmartPill.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[330],{1053:function(e,t,n){"use strict";var r=n(2);t.a=Object(r.action)("TOGGLE_CHARM",function(e){return{charm:e}})},1112:function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"b",function(){return i}),n.d(t,"c",function(){return o});var r=n(2),a=Object(r.createStore)("UserVoiceNpsStore",{npsSurveyBody:"",npsSurveyRatings:"",isRatingSelected:!1,isSent:!1}),i=Object(r.createStore)("UserVoiceSuggestionStore",{message:"",isMessageEnabled:!1,isSent:!1,customFields:[]})(),o=Object(r.createStore)("userVoiceTrendingIdeasStore",{suggestions:[],pagination:{page:0,per_page:0,total_pages:0,total_records:0}})},1272:function(e,t,n){"use strict";var r=n(2),a=n(6),i=n(1565),o={providers:new a.ObservableMap,loadState:i.a.NotLoaded,removalPending:new a.ObservableMap},c=Object(r.createStore)("fileProviderStoreV2",o);t.a=c},12776:function(e){e.exports={a:"jZb"}},12777:function(e){e.exports={a:"mZb"}},12778:function(e){e.exports={l:"ZYb",f:"_Yb",a:"$Yb",b:"aZb",c:"bZb",d:"cZb",e:"dZb",g:"eZb",h:"fZb",i:"gZb",j:"hZb",k:"iZb"}},12779:function(e,t,n){var r=n(12780),a=n(58);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)a.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},12780:function(e,t,n){(t=e.exports=n(57)(!1)).push([e.i,"html[dir] ._1BIi6rH1j5rnLh1OlF1NvI{padding-top:10px}html[dir=ltr] ._1BIi6rH1j5rnLh1OlF1NvI{margin-left:52px}html[dir=rtl] ._1BIi6rH1j5rnLh1OlF1NvI{margin-right:52px}",""]),t.locals={bar:"_1BIi6rH1j5rnLh1OlF1NvI"}},1299:function(e,t,n){"use strict";n.d(t,"f",function(){return u}),n.d(t,"g",function(){return s}),n.d(t,"h",function(){return l}),n.d(t,"b",function(){return d});var r=n(22),a=n(938);n.d(t,"a",function(){return a.l}),n.d(t,"c",function(){return a.m}),n.d(t,"e",function(){return a.n});var i=n(1112);n.d(t,"i",function(){return i.b});var o=n(1322);n.d(t,"d",function(){return o.a});var c=new r.c(function(){return Promise.all([n.e(3),n.e(4),n.e(5),n.e(6),n.e(465)]).then(n.bind(null,2850))}),u=new r.a(c,function(e){return e.launchInAppFeedback}),s=new r.b(c,function(e){return e.postSuggestionAndSendLogDatapoint}),l=new r.b(c,function(e){return e.showUserVoiceSuggestionDialog}),d=Object(r.d)(c,function(e){return e.UserVoiceNps})},1318:function(e,t,n){"use strict";n.d(t,"b",function(){return i}),n.d(t,"a",function(){return a}),n.d(t,"c",function(){return o});var r=n(2),a=Object(r.action)("FILE_PROVIDER_ADDED",function(e){return{providerViewState:e}}),i=Object(r.action)("FILE_PROVIDER_REMOVED",function(e){return{providerType:e}}),o=Object(r.action)("PROVIDERS_LOADED",function(e){return{providers:e}})},1322:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(2),a=Object(r.action)("DEACTIVATE_HELP_CHARM")},1341:function(e,t,n){"use strict";var r=n(105),a=n(110),i=n(804);function o(){return(!Object(i.u)()||!window.opener)&&(Object(r.e)("cal-time-panel")&&!Object(a.f)().SessionSettings.IsShadowMailbox)}var c=n(2),u=Object(c.action)("openTimePanel",function(e){return{source:e}}),s=Object(c.action)("popView");n.d(t,"a",function(){return o}),n.d(t,"b",function(){return u}),n.d(t,"c",function(){return s})},13744:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n(2),i=Object(a.action)("setSmartPillBlockVisibility",function(e,t){return{viewState:e,smartPillBlockVisible:t}}),o=Object(a.action)("setSmartPillFeedbackSubmitted",function(e,t){return{item:e,smartPillFeedbackSubmitted:t}}),c=n(105),u=n(25),s=n(2199),l=n(1341);function d(e){var t=e.featureName;if("SmartReply"===t)return Object(c.e)("mc-smartReply");if("SmartTime"===t)return Object(c.e)("mc-smartReplyWithCustomMeeting");if("SmartDoc"===t)return Object(c.e)("mc-smartReplyWithDoc");if("SmartTodo"===t||"SmartReminder"===t){var n=Object(l.a)()||Object(s.a)();return n||u.d.info("[isPillTypeEnabled] Disable Smart Todo - Todo/Time panel is unavailable."),Object(c.e)("mc-smartTask")&&n}return u.d.info("[isPillTypeEnabled] Unknown pill type: "+t),!1}function m(e){switch(e.logData.mainPayload.language){case"English":return!0;case"Spanish":return Object(c.e)("mc-smartReplySpanishMexico");default:return!1}}function f(e){if(e){if("SmartDoc"===e.featureName)return!0;null==e.confidenceScore&&u.d.info("[isConfidenceScoreAcceptable] confidence score is null. Feature: "+e.featureName+" EntityId: "+e.logData.mainPayload.EID);var t=e.confidenceScore;if(t>0){if(Object(c.e)("mc-smartPillConfidenceLevel_LOW"))return!0;if(Object(c.e)("mc-smartPillConfidenceLevel_MID"))switch(e.featureName){case"SmartTime":case"SmartTask":return t>=70;default:return!0}else switch(e.featureName){case"SmartTime":case"SmartTask":return t>=90;default:return!0}}}return!1}var g=1,p=2,b=3;function S(){var e=Object(c.e)("mc-smartReplyWithTextPositionThird");return[{aggregation:{SmartDoc:3},arrangement:["SmartDoc"]},{aggregation:{SmartReply:2,SmartTime:1},arrangement:e?["SmartTime","SmartReply"]:["SmartReply","SmartTime"]},{aggregation:{SmartReply:1,SmartTodo:1,SmartReminder:1},arrangement:e?["SmartTodo","SmartReminder","SmartReply"]:["SmartReply","SmartTodo","SmartReminder"]},{aggregation:{SmartTodo:1,SmartReminder:1},arrangement:["SmartTodo","SmartReminder"]},{aggregation:{SmartTime:1},arrangement:["SmartTime"]},{aggregation:{SmartReply:2,SmartTodo:1},arrangement:e?["SmartTodo","SmartReply"]:["SmartReply","SmartTodo"]},{aggregation:{SmartTodo:1},arrangement:["SmartTodo"]},{aggregation:{SmartReply:3},arrangement:["SmartReply"]}]}function h(e){if(e)for(var t=function(e){var t,n,a={};try{for(var i=Object(r.__values)(e),o=i.next();!o.done;o=i.next()){var c=o.value;a[c.featureName]=void 0===a[c.featureName]?1:a[c.featureName]+1}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return a}(e),n=S(),a=0;a<n.length;a++){for(var i=!0,o=n[a],c=0;c<o.arrangement.length;c++){if(o.aggregation[o.arrangement[c]]>(void 0===t[o.arrangement[c]]?0:t[o.arrangement[c]])){i=!1;break}}if(i)return o}return null}var v={selectPills:function(e){return function(e,t){var n=[];return t&&e.length>0&&t.arrangement.forEach(function(a){n.push.apply(n,Object(r.__spread)(function(e,t,n){return e.filter(function(e){return e.featureName===t}).slice(0,n)}(e,a,t.aggregation[a])))}),n}(e,h(e))}};function O(e,t,n,r){var a=[];return e.forEach(function(e){n(e)?a.push(e):(e.logData.mainPayload.renderStory|=r,t.push(e))}),a}var y={arbitratePills:function(e){var t=[],n=[];if(e){var a=O(e,n,d,1),i=O(a,n,m,8),o=O(i,n,f,4);if(o.length>0){if(Object(c.e)("mc-smartPillsRenderingStrategiesV2")){var u=v;t.push.apply(t,Object(r.__spread)(u.selectPills(o)))}else{var s=function(e){if(e){var t=e.some(function(e){return"SmartTime"===e.featureName}),n=e.some(function(e){return"SmartReply"===e.featureName}),r=e.some(function(e){return"SmartDoc"===e.featureName}),a=e.some(function(e){return"SmartTodo"===e.featureName}),i=e.some(function(e){return"SmartReminder"===e.featureName});if(r)return{smartDoc:{numOfPills:b}};if(t&&n)return{smartTime:{numOfPills:g},smartReply:{numOfPills:p}};if(a&&i&&n)return{smartReply:{numOfPills:g},smartReminder:{numOfPills:g},smartTodo:{numOfPills:g}};if(a&&n)return{smartTodo:{numOfPills:g},smartReply:{numOfPills:p}};if(a&&i)return{smartReminder:{numOfPills:g},smartTodo:{numOfPills:g}};if(a)return{smartTodo:{numOfPills:g}};if(t)return{smartTime:{numOfPills:g}};if(n)return{smartReply:{numOfPills:b}}}return null}(o);if(s)new Map([["SmartDoc",s.smartDoc],["SmartReply",s.smartReply],["SmartTime",s.smartTime],["SmartTodo",s.smartTodo],["SmartReminder",s.smartReminder]]).forEach(function(e,n){var a,i;e&&t.push.apply(t,Object(r.__spread)((a=n,i=e,o.filter(function(e){return e.featureName===a}).slice(0,i.numOfPills))))})}for(var l=function(e){var r=o[e];t.some(function(e){return e===r})||(r.logData.mainPayload.renderStory|=2,n.push(r))},S=0;S<o.length;S++)l(S)}}return{pillsToShow:t,pillsToHide:n,arbitratorId:"complexArbitrator"}}};var j=3;function P(e,t){void 0===t&&(t=j);var n=[],r=null;if(e)for(var a=Object.keys(e),i=0;i<a.length;i++)for(var o=e[a[i]],c=0;c<o.length;c++)if(r=o&&o[c]){if(!(n.length<t))return n;n.push(r)}else u.d.info("[extractAttachmentSuggestions] ReplyWithAttachmentSuggestion is null");return n}var T="EntityExtraction/SubstrateSearchSuggestions",I="EntityExtraction/ReplyWithQueryCoverage";var w=n(174),R="/ows/search/api/v1/";function _(e){return Object(r.__awaiter)(this,void 0,void 0,function(){var t,n,a,i,o=this;return Object(r.__generator)(this,function(c){switch(c.label){case 0:return c.trys.push([0,3,,4]),t=function(e){var t={},n=function(e){var t=[];if(null!=e.ReplyWithQueryCoverage)for(var n=JSON.parse(e.ReplyWithQueryCoverage.Value)[0],r=n.coverageCheckResults,a=Object.keys(r),i=0;i<a.length;i++){var o=a[i];r[o]||t.push(o)}return t}(e);return JSON.parse(e.SubstrateSearchSuggestions.Value)[0].requests.forEach(function(e){var r=e.InputText;if(!n.includes(r)){var a=function(e,t){for(var n,r,a=R+e,i=0;i<t.length;i++)n=t[i].Key,r=t[i].Value,a+=0==i?"?":"&",a+=n+"="+r;return a}(e.Endpoint,e.UrlParameters);t[r]=a}}),t}(e),n={},(a=Object.keys(t)).length>0?[4,Promise.all(a.map(function(e){return Object(r.__awaiter)(o,void 0,void 0,function(){var a,i;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return a=n,i=e,[4,D(t[e])];case 1:return[2,a[i]=r.sent()]}})})}))]:[3,2];case 1:return c.sent(),[2,E(n)];case 2:return[3,4];case 3:return i=c.sent(),u.d.info("Failed to parse property, error: "+i.message),[3,4];case 4:return[2,null]}})})}function D(e){return Object(r.__awaiter)(this,void 0,void 0,function(){var t,n;return Object(r.__generator)(this,function(r){switch(r.label){case 0:t=null,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,Object(w.b)(e)];case 2:return t=r.sent(),[3,4];case 3:return n=r.sent(),u.d.info("[getReplyWithSuggestions_executeAndLog3SQuery] Failed to make service call, error: "+n.message),[3,4];case 4:return[2,t]}})})}function E(e){try{var t={};return Object.keys(e).forEach(function(n){t[n]=e[n].Groups[0].Suggestions;for(var r=0;r<t[n].length;r++)t[n][r].Endpoint=0}),t}catch(e){return u.d.info("getSentenceToAttachmentSuggestionsMap: Failed to execute, error: "+e.message),null}}var x=n(3227),k=n(3264);function C(e){return Object(r.__awaiter)(this,void 0,void 0,function(){var t,n,a;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return t=null,e?[4,x.c.import()]:[3,4];case 1:return[4,r.sent()(e.ItemId.Id,k.a.SmartDoc)];case 2:return(n=r.sent())&&(a=function(e){var t={SubstrateSearchSuggestions:null,ReplyWithQueryCoverage:null},n=e.ExtendedProperty;if(n)for(var r=n.length,a=0;a<r;a++){var i=n[a];i.ExtendedFieldURI.PropertyName===T?t.SubstrateSearchSuggestions=i:i.ExtendedFieldURI.PropertyName===I&&(t.ReplyWithQueryCoverage=i)}return t}(n))?[4,_(a)]:[3,4];case 3:t=r.sent(),r.label=4;case 4:return[2,t]}})})}var A=n(12776),N=Object(a.action)("createMessageWithAttachmentAction",function(e,t){return{item:e,attachment:t}}),F=n(4),L=n(3258);function M(e){return Object(r.__awaiter)(this,void 0,void 0,function(){var t,n;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return(n=e.AttachmentSuggestions)?[3,2]:[4,C(e)];case 1:n=r.sent(),r.label=2;case 2:return(t=n)?[2,P(t).map(function(t,n){return function(e,t,n){var r=Object(L.b)("SmartDoc","suggestion"+n);return{ariaLabel:Object(F.b)(Object(F.a)(A.a),e.FileName),featureName:"SmartDoc",icon:{iconName:V(e.FileExtension)},onClick:function(){N(t,e)},logData:r,index:n,text:e.FileName}}(t,e,n)})]:[2,[]]}})})}function V(e){return e.indexOf("doc")>=0?"WordLogo":e.indexOf("ppt")>=0?"PowerPointLogo":e.indexOf("xls")>=0?"ExcelLogo":e.indexOf("pdf")>=0?"Pdf":"OfficeLogo"}var U=n(911),B=n(1483);function G(e,t){return Object(r.__awaiter)(this,void 0,void 0,function(){var n;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return n=null,Object(B.i)()!==B.c.NotLoaded?[3,2]:[4,B.k.import()];case 1:return r.sent()(function(r){n=W(Object(B.g)(),e),t(n)}),[3,3];case 2:n=W(Object(B.g)(),e),t(n),r.label=3;case 3:return[2]}})})}function W(e,t){var n=function(e){for(var t=0;t<e.length;t++)if(0===e[t].type)return e[t].model.Id;return u.d.warn("createCloudFileFromAttachmentData: Could not get OneDrive Pro provider ID. Attachment will not upload."),""}(e);return{fileType:U.a.CloudSuggestion,name:t.FileName,size:null,providerId:n,providerType:0,location:t.Url,providerEndpointUrl:null,isFolder:!1,fileId:t.Id,fileParentId:null,thumbnailUrl:null,previewUrl:null,type:null}}var H=n(941);Object(a.orchestrator)(N,function(e){return Object(r.__awaiter)(this,void 0,void 0,function(){var t,n,a,i=this;return Object(r.__generator)(this,function(o){switch(o.label){case 0:t=e.item,n=e.attachment,o.label=1;case 1:return o.trys.push([1,3,,4]),[4,G(n,function(e){return Object(r.__awaiter)(i,void 0,void 0,function(){return Object(r.__generator)(this,function(n){return function(e,t){Object(r.__awaiter)(this,void 0,void 0,function(){var n,a,i;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return t?[4,H.w.import()]:[3,5];case 1:return n=r.sent(),[4,H.h.import()];case 2:return a=r.sent(),(i=Object(H.b)(e.ConversationId.Id))?[3,4]:[4,n({referenceItemOrId:e,isReplyAll:!0,useFullCompose:!1,actionSource:null,instrumentationContexts:null,conversationId:e.ConversationId.Id,body:null})];case 3:i=r.sent(),r.label=4;case 4:a([t],i,{isInline:!1,isHiddenInline:!1,shouldShare:!0},null,null,null,null),r.label=5;case 5:return[2]}})})}(t,e),[2]})})})];case 2:return o.sent(),[3,4];case 3:return a=o.sent(),u.d.error("[createMessageWithAttachmentOrchestrator] Error when creating cloud file: "+a.message),[3,4];case 4:return[2]}})})});var Z="EntityExtraction/SmartReplyForEmail",z=n(12777),q=Object(a.action)("updateSIGSDataOnClickAction",function(e,t,n){return{composeViewState:e,timeClicked:t,clickIndex:n}}),J=n(2377);var Q=Object(a.action)("cacheSmartReplyDataAction",function(e,t,n,r,a){return{item:e,validPropertyExists:t,smartReplies:n,loggableSmartReplies:r,smartReplyExtractionID:a}}),K="2018-06-20T00:00:00.0000000Z",Y="@extractionTimeUtc",$="@EntityId",X=3;function ee(e,t){var n=!1;if(e&&t)try{var r=JSON.parse(t.Value)[0],a=r[Y];if(a)Date.parse(a)>=Date.parse(K)&&(n=function(e,t){for(var n=t[$],r=[],a=[],i=!1,o=t.entities.length,c=0;c<o;c++)r.push(t.entities[c].value),a.push(t.entities[c].valueRaw||t.entities[c].value);n&&r.length==X?Q(e,i=!0,r,a,n):u.d.info("[getSmartRepliesForItem_extractAndCacheSmartRepliesFromProperty] Unexpected number of smart replies on item. Expected "+X+" but found "+r.length);return i}(e,r));else u.d.info("[getSmartRepliesForItem_parseSmartReplyProperty] Time stamp not found on property, aborting smart reply parsing.")}catch(e){u.d.info("[getSmartRepliesForItem_parseSmartReplyProperty] Malformed property, cannot parse. Error: "+e.message)}else u.d.info("[getSmartRepliesForItem_parseSmartReplyProperty] No item or property found.");e&&!n&&Q(e,n)}function te(e){return Object(r.__awaiter)(this,void 0,void 0,function(){var t,n;return Object(r.__generator)(this,function(a){switch(a.label){case 0:return e?e.SmartReplyData?[3,3]:[4,x.c.import()]:[3,4];case 1:return[4,a.sent()(e.ItemId.Id,k.a.SmartReply)];case 2:(t=a.sent())&&(n=function(e,t){var n=e.ExtendedProperty;if(n)for(var r=n.length,a=0;a<r;a++){var i=n[a];if(i.ExtendedFieldURI.PropertyName===t)return i}return null}(t,Z),ee(t,n)),a.label=3;case 3:return e.SmartReplyData&&e.SmartReplyData.ExtractionID?[2,e.SmartReplyData.SmartReplies.map(function(t,n){return function(e,t,n,a,i){var o=this,c=Object(L.b)("SmartReply",n);return c.mainPayload.EID=a,c.mainPayload.confidenceScore=i+1,{ariaLabel:Object(F.b)(Object(F.a)(z.a),t),featureName:"SmartReply",onClick:function(n){return Object(r.__awaiter)(o,void 0,void 0,function(){var a;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return[4,J.h.importAndExecute(e.ItemId.Id,e.ConversationId.Id,t,1)];case 1:return a=r.sent(),q(a,n.logData.mainPayload.timeClicked,n.logData.mainPayload.position),[2]}})})},logData:c,index:i,text:t,toolTip:t,confidenceScore:c.mainPayload.confidenceScore}}(e,t,e.SmartReplyData.LoggableSmartReplies[n],e.SmartReplyData.ExtractionID,n)})]:[3,5];case 4:u.d.info("[getSmartRepliesForItem] No item, cannot produce smart replies."),a.label=5;case 5:return[2,[]]}})})}var ne=n(6),re=(Object(a.mutator)(Q,function(e){var t={SmartReplies:null,LoggableSmartReplies:null,ExtractionID:null,SuggestionAppropriatenessMap:null,FeedbackSubmitted:!1},n=e.item,r=e.validPropertyExists,a=e.smartReplies,i=e.loggableSmartReplies,o=e.smartReplyExtractionID;if(r){t={SmartReplies:a,LoggableSmartReplies:i,ExtractionID:o,SuggestionAppropriatenessMap:new ne.ObservableMap,FeedbackSubmitted:!1};for(var c=0;c<a.length;c++){var u=String(c);t.SuggestionAppropriatenessMap.set(u,"")}}n.SmartReplyData=t}),Object(a.mutator)(q,function(e){var t=e.composeViewState,n=e.timeClicked,r=e.clickIndex;t&&(t.smartReplyComposeSIGSData={isSmartSuggestionsClicked:!0,suggestionsClickedTime:n,clickIndex:r})}),n(8760));var ae="EntityExtraction/Events1.0";var ie=n(7),oe=n(364);var ce=Object(a.action)("cacheSmartTimeExtendedPropertyAction",function(e,t,n){return{item:e,validPropertyExists:t,smartTimesExtendedProp:n}}),ue="@EntityId",se="confidence";var le=n(1249),de=n(7018),me=n(853);function fe(e){return Object(r.__awaiter)(this,void 0,void 0,function(){var t,n,a,i,o,s,l,d,m,f,g,p;return Object(r.__generator)(this,function(b){switch(b.label){case 0:return t=[],e?e.SmartTimeExtendedProperty?[3,3]:[4,x.c.import()]:[3,7];case 1:return[4,b.sent()(e.ItemId.Id,k.a.SmartTime)];case 2:(n=b.sent())&&(a=function(e){var t=null;if(e){var n=e.ExtendedProperty;n&&n.some(function(e){return e.ExtendedFieldURI.PropertyName==ae&&(t=e,!0)})}return t}(n),function(e,t){var n,a;if(t){var i=null,o=!1;try{var c=JSON.parse(t.Value);if(c&&c.length>0){var s=c[0][ue],l=c[0][se];try{for(var d=Object(r.__values)(c),m=d.next();!m.done;m=d.next()){var f=m.value;if(f.times&&f.times.length>0){var g=f.times[0];i={beginingOfTimeRange:g.beginingOfTimeRange,endOfTimeRange:g.endOfTimeRange,duration:g.duration,entityId:s,hasIntent:!0,confidenceScore:l},o=!0}}}catch(e){n={error:e}}finally{try{m&&!m.done&&(a=d.return)&&a.call(d)}finally{if(n)throw n.error}}}}catch(e){u.d.warn("[getSmartTimeForItem_parseSmartTimeProperty] Malformed property, cannot parse. Error: "+e.message)}finally{ce(e,o,i)}}else u.d.info("[getSmartTimeForItem_parseSmartTimeProperty] No smart time extended property found.")}(n,a)),b.label=3;case 3:return(i=e.SmartTimeExtendedProperty)?(o=i.entityId,s=100*i.confidenceScore,l=null,d=null,Object(c.e)("mc-smartReplyWithMeeting-SuggestedTimeToCAS")&&(l=function(e){var t=null;if(e&&e.SmartTimeExtendedProperty){var n=Object(oe.g)();try{var r=Object(ie.fc)(e.SmartTimeExtendedProperty.beginingOfTimeRange),a=Object(ie.fc)(e.SmartTimeExtendedProperty.endOfTimeRange);r>=n&&(t={startTime:r,endTime:a})}catch(e){u.d.error("[getSmartTimeSuggestion] Unable to parse suggested time. "+e)}}return t}(e))?[4,Object(de.a)(e,l)]:[3,5]):[3,6];case 4:b.sent(),d=Object(me.b)().conversationReadingPaneViewState.calendarInlineComposeViewState,b.label=5;case 5:m=e,f=Object(c.e)("mc-smartReplyWithMeeting-Cortana"),g=function(e,t,n,r,a){var i=Object(L.b)("SmartTime",Object(F.a)(re.d)),o=null!=r,c=n.ToRecipients?n.ToRecipients.length:0,u=n.CcRecipients?n.CcRecipients.length:0;i.mainPayload.EID=e,i.mainPayload.confidenceScore=t,i.mainPayload.hasSuggestedTime=o,i.mainPayload.NumToRecipient=c,i.mainPayload.NumCCRecipient=u,i.mainPayload.isCortanaEnabled=a,o&&(i.mainPayload.suggestedStartTime=r.startTime,i.mainPayload.suggestedEndTime=r.endTime);return i}(o,s,m,l,f),p=null,f&&(p={items:be(e,d,o,m,g)}),t.push(function(e,t,n,r,a,i,o){return{ariaLabel:Object(F.a)(re.d),featureName:"SmartTime",onClick:n,index:e,logData:r,text:t,toolTip:t,icon:i,confidenceScore:a,menuProps:o}}(t.length,Object(F.a)(re.d),function(){return ge(e,d,o,m)},g,s,{iconName:"DateTime2"},p)),b.label=6;case 6:return[3,8];case 7:u.d.info("[getSmartTimesForItem] No item, cannot produce smart times."),b.label=8;case 8:return[2,t]}})})}function ge(e,t,n,r){le.j.importAndExecute(e.ItemId.Id,t,!1,null,n,r.InternetMessageId)}function pe(e,t,n,r){var a={data:[e.mainPayload]};a.data[0].subtype=t,a.data[0].timeClicked=r,Object(L.g)("SmartPillClicked",[JSON.stringify(a)],n)}function be(e,t,n,r,a){var i=[];return i.push({key:"OutlookMeeting",text:Object(F.a)(re.c),onClick:function(){pe(a,"OutlookMeeting",r.InternetMessageId,(new Date).toISOString()),ge(e,t,n,r)}}),i.push({key:"CortanaMeeting",text:Object(F.a)(re.a),onClick:function(){pe(a,"CortanaMeeting",r.InternetMessageId,(new Date).toISOString()),function(e){J.h.importAndExecute(e.ItemId.Id,e.ConversationId.Id,Object(F.a)(re.b),2)}(e)}}),i}Object(a.mutator)(ce,function(e){var t={beginingOfTimeRange:null,endOfTimeRange:null,duration:null,entityId:null,hasIntent:!1,confidenceScore:0},n=e.item,r=e.validPropertyExists,a=e.smartTimesExtendedProp;r&&a&&(t={beginingOfTimeRange:a.beginingOfTimeRange,endOfTimeRange:a.endOfTimeRange,duration:a.duration,entityId:a.entityId,hasIntent:!0,confidenceScore:a.confidenceScore}),n.SmartTimeExtendedProperty=t});var Se=n(7654),he=n(1666),ve=n(962);function Oe(e,t,n,r){var a=Object(L.b)("SmartTodo",n);return a.mainPayload.confidenceScore=e.confidenceScore,a.mainPayload.EID=e.entityId,{ariaLabel:Object(F.a)(Se.a),featureName:"SmartTodo",icon:{iconName:"ToDoLogoOutline"},onClick:function(){!function(e,t,n){if(Object(l.a)())return void he.i.importAndExecute("SmartTask",e,t,n);if(Object(s.a)())ve.k.importAndExecute(e,t,n)}(e.description,t,e.entityId)},logData:a,index:r,text:n,toolTip:n,confidenceScore:e.confidenceScore}}var ye=Object(a.action)("cacheSmartTaskData",function(e,t,n){return{item:e,validPropertyExists:t,smartTasks:n}}),je="@EntityId",Pe="@sourceConfidenceScore";function Te(e,t){var n=!1;if(e&&t)try{n=function(e,t){var n=JSON.parse(t.Value),r=!1;if(!t)return u.d.info("[getSmartTaskForItem_parseSmartTaskProperty] No smart task extended property found."),r;var a=[];if(n&&n.length>0)for(var i=n.length,o=0;o<i;o++){var c=n[o];a.push({entityId:c[je],description:c.description,confidenceScore:100*Number(c[Pe])})}a.length>0?ye(e,r=!0,a):u.d.info("[getSmartTasksForItem_extractAndCacheSmartTaskFromProperty] There are zero smart tasks for this item");return r}(e,t)}catch(e){u.d.info("[getSmartTasksForItem_parseSmartTaskProperty] Malformed property, cannot parse. Error: "+e.message)}else u.d.info("[getSmartTasksForItem_parseSmartTaskProperty] No item or property found.");e&&!n&&ye(e,!1)}var Ie,we="EntityExtraction/RequestForAction1.0";function Re(e,t){return Object(r.__awaiter)(this,void 0,void 0,function(){var n,a;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return e?e.SmartTaskData?[3,3]:[4,x.c.import()]:[3,4];case 1:return[4,r.sent()(e.ItemId.Id,k.a.SmartTask)];case 2:(n=r.sent())&&(a=function(e){var t=null;if(e){var n=e.ExtendedProperty;n&&n.some(function(e){return e.ExtendedFieldURI.PropertyName==we&&(t=e,!0)})}return t}(n),Te(n,a)),r.label=3;case 3:return e.SmartTaskData&&e.SmartTaskData.SmartTasks?[2,e.SmartTaskData.SmartTasks.map(function(n,r){return t==Ie.Todo&&e.ItemId?Oe(n,e.ItemId.Id,Object(F.a)(Se.a),r):function(e,t,n,r,a){var i=Object(L.b)("SmartReminder",r);return i.mainPayload.confidenceScore=e.confidenceScore,i.mainPayload.EID=e.entityId,{ariaLabel:Object(F.a)(Se.b),featureName:"SmartReminder",icon:{iconName:"AddEvent"},onClick:function(){le.j.importAndExecute(t,null,!1,null,e.entityId,n,!0)},logData:i,index:a,text:r,toolTip:r,confidenceScore:e.confidenceScore}}(n,e.ItemId.Id,e.InternetMessageId,Object(F.a)(Se.b),r)})]:[3,5];case 4:u.d.info("[getSmartTodosOrRemindersForItem] No item, cannot produce smart tasks."),r.label=5;case 5:return[2,[]]}})})}!function(e){e[e.Todo=0]="Todo",e[e.Reminder=1]="Reminder"}(Ie||(Ie={}));Object(a.mutator)(ye,function(e){var t={SmartTasks:null},n=e.item;if(e.validPropertyExists){var r=e.smartTasks;t.SmartTasks=r}n.SmartTaskData=t});function _e(e){var t=[];return t.push(function(e){return{buildPills:function(){return fe(e)}}}(e)),t.push(function(e){return{buildPills:function(){return M(e)}}}(e)),t.push(function(e){return{buildPills:function(){return te(e)}}}(e)),t.push(function(e){return{buildPills:function(){return Re(e,Ie.Todo)}}}(e)),Object(c.e)("mc-smartTaskWithReminder")&&t.push(function(e){return{buildPills:function(){return Re(e,Ie.Reminder)}}}(e)),t}function De(e){var t=this;return{updateLogData:function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,a,i;return Object(r.__generator)(this,function(r){return e&&(t=e.stampedLanguage&&e.stampedLanguage.language,a=e.stampedLanguage&&e.stampedLanguage.locale,i=e.InternetMessageId,n.forEach(function(e){e.logData.mainPayload.language=t,e.logData.mainPayload.locale=a,e.logData.cosmosOnlyData=i})),[2]})})}}}var Ee=Object(a.action)("updateItemLanguageAction",function(e){return{item:e}});function xe(e){var t=this;return{preRun:function(){return Object(r.__awaiter)(t,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(n){switch(n.label){case 0:return[4,x.c.import()];case 1:return[4,n.sent()(e.ItemId.Id,k.a.LanguageAndLocale)];case 2:return(t=n.sent())&&!t.stampedLanguage&&Ee(t),[2]}})})}}}var ke=n(12778);function Ce(e,t){var n;t.UniqueBody?n=t.UniqueBody.Value:t.NormalizedBody&&(n=t.NormalizedBody.Value);var r={subtitle:void 0,dSATOptions:void 0,donationJson:{messageBody:n}},a=e.some(function(e){return"SmartTime"===e.featureName});return e.some(function(e){return"SmartReply"===e.featureName})?(r.subtitle=Object(F.a)(ke.f),r.dSATOptions=a?[{logString:"They aren't relevant",uiString:Object(F.a)(ke.a)},{logString:"They don't sound like me",uiString:Object(F.a)(ke.c)},{logString:"They're offensive or rude",uiString:Object(F.a)(ke.d)},{logString:"I'm not the person who should schedule the meeting",uiString:Object(F.a)(ke.i)},{logString:"I don't want help scheduling a meeting",uiString:Object(F.a)(ke.k)},{logString:"Other",uiString:Object(F.a)(ke.e)}]:[{logString:"They aren't relevant",uiString:Object(F.a)(ke.a)},{logString:"The meaning isn't clear",uiString:Object(F.a)(ke.b)},{logString:"They don't sound like me",uiString:Object(F.a)(ke.c)},{logString:"They're offensive or rude",uiString:Object(F.a)(ke.d)},{logString:"Other",uiString:Object(F.a)(ke.e)}]):a?(r.subtitle=Object(F.a)(ke.l),r.dSATOptions=[{logString:"The meeting is already on my calendar",uiString:Object(F.a)(ke.g)},{logString:"A meeting suggestion isn't relevant",uiString:Object(F.a)(ke.h)},{logString:"I'm not the person who should schedule the meeting",uiString:Object(F.a)(ke.i)},{logString:"I want to schedule the meeting later",uiString:Object(F.a)(ke.j)},{logString:"I don't want help scheduling a meeting",uiString:Object(F.a)(ke.k)},{logString:"Other",uiString:Object(F.a)(ke.e)}]):r.subtitle=Object(F.a)(ke.f),r}var Ae=n(4906);var Ne=n(6359),Fe=n(173),Le=n(7635),Me=n(1),Ve=n(12779),Ue=function(e){function t(t){var n=e.call(this,t)||this,r=n.props.item;return n.smartPillBuilders=_e(r),n.smartPillArbitrator=y,n.smartPillLogDataUpdaters=function(e){return[De(e)]}(r),n.smartPillPreRunners=function(e){return[xe(e)]}(r),n.loggedToSIGS=!1,n}return Object(r.__extends)(t,e),t.prototype.componentDidMount=function(){this.runSmartPillBuilders()},t.prototype.componentDidUpdate=function(){this.loggedToSIGS||(Object(Ne.b)(this.props.item),this.loggedToSIGS=!0)},t.prototype.componentWillUnmount=function(){this.smartPillBuilders=null,this.smartPillArbitrator=null,this.smartPillData=null,this.smartPillPreRunners=null,i(this.props.viewState,!1)},t.prototype.render=function(){var e=this.props,t=e.item,n=e.viewState.smartPillBlockVisible;if(!!t.RightsManagementLicenseData||!n||!this.smartPillData||0==this.smartPillData.pillsToShow.length&&0==this.smartPillData.pillsToHide.length)return null;var r=this.smartPillData.pillsToShow.length>0;return Me.createElement("div",{className:r?Ve.bar:void 0},Me.createElement(Le.a,{arbitratedPills:this.smartPillData,enableFeedbackForm:!t.smartPillFeedbackSubmitted,feedbackData:Ce(this.smartPillData.pillsToShow,t)}))},t.prototype.runSmartPillBuilders=function(){return Object(r.__awaiter)(this,void 0,void 0,function(){var e;return Object(r.__generator)(this,function(t){switch(t.label){case 0:return u.d.info("[MailSmartPillBlock] Running smart pill builders"),e=this,[4,Object(L.a)(this.smartPillBuilders,this.smartPillArbitrator,this.smartPillPreRunners,this.smartPillLogDataUpdaters,5e3)];case 1:return e.smartPillData=t.sent(),n=this.props.item,r=this.smartPillData,a=r?r.pillsToShow.filter(function(e){return"SmartReply"===e.featureName}):[],o=a.length>0?a[0].logData.mainPayload.EID:"",c=r&&r.pillsToShow.length>0?"True":"False",s="True"===c?r.pillsToShow.map(function(e){return e.featureName}).toString():"",l="True"===c?r.pillsToShow.map(function(e){return e.text}).join("$"):"",Object(Ae.a)(n.ItemId.Id,c,s,l,o),this.smartPillData&&this.smartPillData.pillsToShow.length>0&&i(this.props.viewState,!0),[2]}var n,r,a,o,c,s,l})})},t=Object(r.__decorate)([Fe.observer],t)}(Me.Component),Be=(Object(a.mutator)(i,function(e){e.viewState.smartPillBlockVisible=e.smartPillBlockVisible}),Object(a.mutator)(o,function(e){e.item.smartPillFeedbackSubmitted=e.smartPillFeedbackSubmitted}),n(4684));function Ge(e){var t=function(e){var t=e.ExtendedProperty;if(t){var n=t.filter(function(e){return e.ExtendedFieldURI.PropertyName===Be.a});if(n.length>0)return n[0]}return null}(e),n=void 0,r=void 0,a=0,i=void 0;try{if(t){var o=JSON.parse(t.Value)[0],c=o[Be.c],s=o[Be.d];i=o[Be.b],r=Object.keys(s)[0],n=c&&c[Be.e]&&c[Be.e].toLowerCase(),a=parseInt(Object.values(s)[0])}}catch(e){u.d.info("[getStampedLanguage] Failed to parse property, error: "+e.message)}return{locale:n,language:r,confidenceScore:a,entityId:i}}Object(a.mutator)(Ee,function(e){var t=e.item;t.stampedLanguage=Ge(t)});n.d(t,"MailSmartPillBlock",function(){return Ue})},1386:function(e,t,n){"use strict";var r=n(0),a=n(2600),i=n.n(a),o=n(1946),c=n.n(o);function u(e){var t=c()({ProviderType:e});return i()(t)}var s=n(2601),l=n.n(s),d=n(1947),m=n.n(d);function f(e){var t=m()({ProviderType:e});return l()(t)}var g=n(2505),p=n(105);n.d(t,"a",function(){return P}),n.d(t,"b",function(){return w});var b="code",S="token",h=3e3,v=3;function O(e){return{state:e}}function y(e){return e.state}function j(e){return e.code}function P(e,t,n,a,i){var o={providerType:e,getAuthUrlInfo:null,getCSRFToken:y,getOAuthCode:j};return function e(t,n,a,i,o,c,s){return Object(r.__awaiter)(this,void 0,void 0,function(){var l,d;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),l=void 0,7!==t&&9!==t&&8!==t?[3,2]:[4,f(t)];case 1:return d=r.sent(),l=d.AttachmentDataProviderCreator.ProviderAppKey,a=d.AttachmentDataProviderCreator.AuthorizationUri,[3,4];case 2:return[4,u(t)];case 3:d=r.sent(),l=d.ProviderAppKey,r.label=4;case 4:return n.getAuthUrlInfo=Object(g.d)(t,a,i,l,o,c),[3,6];case 5:return r.sent(),s>0&&setTimeout(function(){return e(t,n,a,i,o,c,--s)},h),[3,6];case 6:return[2]}})})}(e,o,t,n,a,i,v),o}var T=null;function I(){if(!T){(T={})[3]=P(3,"https://app.box.com/api/oauth2/authorize",Object(g.c)(3),b,O),T[2]=P(2,"https://www.dropbox.com/oauth2/authorize",Object(g.b)(2),b,O);var e=P(6,"https://www.facebook.com/dialog/oauth",Object(g.b)(6),S,function(e){return{state:e,scope:"user_photos,email"}});e.getCSRFToken=y,e.getOAuthCode=function(e){return e.access_token},T[6]=e;var t=P(5,"https://accounts.google.com/o/oauth2/auth",g.a+"/ADPRedirect.aspx",b,function(e){var t={state:e,provider:5..toString(),url:Object(g.b)()};return{state:JSON.stringify(t),scope:"https://www.googleapis.com/auth/drive",access_type:"offline",prompt:"consent",include_granted_scopes:"true"}});t.getCSRFToken=function(e){return JSON.parse(e.state).state},T[5]=t,T[1]=P(1,"https://login.live.com/oauth20_authorize.srf",Object(g.c)(1),b,function(e){return{state:e,scope:"wl.basic onedrive.readwrite wl.offline_access"}}),Object(p.e)("doc-fileProvider-wopiClient")&&(T[7]=P(7,"",Object(g.c)(7),b,O),T[8]=P(8,"",Object(g.c)(8),b,O),T[9]=P(9,"",Object(g.c)(9),b,O))}return T}function w(e){var t=I();return e in t?t[e]:null}},1399:function(e,t,n){"use strict";n.d(t,"b",function(){return i}),n.d(t,"a",function(){return o});var r=n(0),a=n(1272),i=function(){return Object(r.__spread)(Object(a.a)().providers.values())},o=function(e){return Object(a.a)().providers.get(e)||null}},1453:function(e,t,n){"use strict";n.d(t,"b",function(){return r}),n.d(t,"a",function(){return i}),n.d(t,"c",function(){return o});var r,a=n(0);!function(e){e[e.Groups=1e4]="Groups"}(r||(r={}));var i=Object.freeze([1,3,2,6,5,7,8,9]),o=Object.freeze(Object(a.__spread)(i,[0,4,10]))},1483:function(e,t,n){"use strict";var r=n(22),a=n(1880),i=n(1770),o=(n(1272),n(1318)),c=n(1453),u=(n(2457),n(2363),n(1399));var s=n(1738),l=n(1565),d=n(1386);n.d(t,"k",function(){return f}),n.d(t,"m",function(){return g}),n.d(t,"j",function(){return p}),n.d(t,"l",function(){return b}),n.d(t,"b",function(){return a.a}),n.d(t,"h",function(){return i.a}),n.d(t,"d",function(){return o.a}),n.d(t,"e",function(){return o.b}),n.d(t,"n",function(){return o.c}),n.d(t,"a",function(){return c.b}),n.d(t,"g",function(){return u.b}),n.d(t,"i",function(){return s.a}),n.d(t,"c",function(){return l.a}),n.d(t,"f",function(){return d.b});var m=new r.c(function(){return Promise.all([n.e(6),n.e(7),n.e(9),n.e(19),n.e(230)]).then(n.bind(null,13845))}),f=new r.b(m,function(e){return e.loadProviders}),g=new r.b(m,function(e){return e.removeFileProvider}),p=new r.b(m,function(e){return e.addFileProvider}),b=new r.b(m,function(e){return e.removeAndAddFileProvider})},1500:function(e,t,n){"use strict";var r=n(22),a=n(79),i=n(2569),o=n(2570);function c(){var e=Object(i.a)();return e.cards?Object.keys(e.cards).filter(function(t){return e.cards[t].status===o.a.Unread}).length:0}n(1787);var u=n(2197);n.d(t,"a",function(){return l}),n.d(t,"b",function(){return c}),n.d(t,"c",function(){return u.a});var s=new r.c(function(){return n.e(471).then(n.bind(null,13754))}),l=Object(r.d)(s,function(e){return e.WhatsNewFluentPane}),d=new r.b(s,function(e){return e.initializeWhatsNew});Object(a.c)(function(){d.import().then(function(e){return e()})})},1565:function(e,t,n){"use strict";var r;n.d(t,"a",function(){return r}),function(e){e[e.Loaded=0]="Loaded",e[e.Loading=1]="Loading",e[e.NotLoaded=2]="NotLoaded"}(r||(r={}))},1666:function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"b",function(){return o}),n.d(t,"e",function(){return c}),n.d(t,"h",function(){return u}),n.d(t,"f",function(){return s}),n.d(t,"c",function(){return l}),n.d(t,"i",function(){return d}),n.d(t,"j",function(){return m}),n.d(t,"g",function(){return f}),n.d(t,"d",function(){return g});var r=n(22),a=new r.c(function(){return Promise.all([n.e(587),n.e(28),n.e(72),n.e(443)]).then(n.bind(null,3364))}),i=Object(r.d)(a,function(e){return e.TimePanel}),o=Object(r.d)(a,function(e){return e.TimePanelHeaderBar}),c=new r.a(a,function(e){return e.preloadTimePanelData}),u=new r.a(a,function(e){return e.openEventDetailsView}),s=new r.a(a,function(e){return e.openAttendeeTrackingView}),l=new r.a(a,function(e){return e.closeAttendeeTrackingView}),d=new r.a(a,function(e){return e.openTasksView}),m=new r.a(a,function(e){return e.openCalendarView}),f=new r.a(a,function(e){return e.openConflictsView}),g=new r.a(a,function(e){return e.closeConflictsView});new r.a(a,function(e){return e.openEventQuickComposeView})},1738:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(1272);function a(){return Object(r.a)().loadState}},1770:function(e,t,n){"use strict";n.d(t,"a",function(){return u});var r=n(2599),a=n(2362),i=n(2536),o=n(4),c=n(218);function u(e,t){if(void 0===t&&(t=!1),t)return"";switch(e){case 0:return Object(o.a)(i.b);case 1:return Object(o.a)(i.a);case 2:case 9:return Object(o.a)(r.b);case 3:case 7:return Object(o.a)(r.a);case 5:return Object(o.a)(r.e);case 6:return Object(o.a)(r.d);case 4:return Object(o.a)(r.f);case 10:return Object(o.a)(a.b);case 8:return Object(o.a)(r.c);default:return Object(c.a)(e)}}},1786:function(e){e.exports={c:"Hea",f:"Iea",e:"Jea",b:"Kea",g:"Lea",a:"Mea",d:"Nea"}},1787:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(2),a=Object(r.action)("OPEN_QUICK_SETTINGS")},1880:function(e,t,n){"use strict";var r;!function(e){e[e.None=0]="None",e[e.Images=1]="Images"}(r||(r={})),t.a=r},1899:function(e,t,n){"use strict";var r=n(2);t.a=Object(r.action)("SHOW_QUICK_OPTIONS",function(){return{}})},1946:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"GetNewAttachmentDataProviderCreationInfoRequest:#Exchange"},e)}},1947:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"GetAttachmentDataProviderCreatorRequest:#Exchange"},e)}},2197:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(2),a=Object(r.action)("openPremiumDashboard")},2199:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(105),a=n(110),i=n(804);function o(){return(!Object(i.u)()||!window.opener)&&(Object(r.e)("todo-panel")&&!Object(r.e)("cal-time-panel")&&!Object(a.f)().SessionSettings.IsShadowMailbox)}},2248:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(2),a=Object(r.action)("contactSupport")},2362:function(e){e.exports={a:"qia",b:"ria"}},2363:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var r=n(60),a=n(276),i=n(218),o=n(105);function c(e){var t=Object(r.a)();switch(e){case 5:return t.AttachmentPolicy.GoogleDriveAttachmentsEnabled&&t.AttachmentPolicy.ThirdPartyAttachmentsEnabled&&Object(o.e)("doc-fileProvider-gdrive");case 4:case 0:return!0;case 3:return t.AttachmentPolicy.BoxAttachmentsEnabled&&t.AttachmentPolicy.ThirdPartyAttachmentsEnabled&&Object(o.e)("doc-fileProvider-box");case 2:return t.AttachmentPolicy.DropboxAttachmentsEnabled&&t.AttachmentPolicy.ThirdPartyAttachmentsEnabled&&Object(o.e)("doc-fileProvider-dropbox");case 6:return t.AttachmentPolicy.ThirdPartyAttachmentsEnabled&&Object(o.e)("doc-fileProvider-facebook");case 1:return!!Object(a.a)()||Object(o.e)("doc-filePicker-oneDriveConsumerForO365")&&t.AttachmentPolicy.OnedriveAttachmentsEnabled&&t.AttachmentPolicy.ThirdPartyAttachmentsEnabled;case 10:return Object(o.e)("doc-filePicker-mailMessageAttachment");case 7:case 8:case 9:return t.AttachmentPolicy.ThirdPartyAttachmentsEnabled&&Object(o.e)("doc-fileProvider-wopiClient");default:return Object(i.a)(e)}}},2457:function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"b",function(){return i});var r=n(1453),a="file provider is not addable";function i(e){return r.a.indexOf(e)>-1}},2505:function(e,t,n){"use strict";var r=n(804),a=n(3);function i(e,t,n){if(!e||!t||!n)throw new Error("Key and Value parameters should not be null");return e.indexOf("?")>0?e+"&"+t+"="+n:e+"?"+t+"="+n}n.d(t,"a",function(){return o}),n.d(t,"b",function(){return c}),n.d(t,"c",function(){return u}),n.d(t,"d",function(){return s});var o=Object(a.r)()?"https://exchangelabs.live-int.com/owa":"https://outlook.office.com/owa";function c(e){var t=e?encodeURIComponent("?provider="+e):"",n=e&&6===e?"AddFacebookFileProvider.html":"AddFileProvider.html";return Object(r.n)()+"/mail/"+n+t}function u(e){var t=Object(r.n)()+"/mail/AddFileProvider.html",n=encodeURIComponent("provider="+e+"&url="+t);return o+"/ADPRedirect.aspx?"+n}function s(e,t,n,r,a,o){return function(){var e=function(){for(var e="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789".split(""),t=e.length-1,n=[],r=0;r<16;r++)n.push(e[Math.round(Math.random()*t)]);return"owa_csrf_token_"+n.join("")}(),c=i(t,"client_id",r);if(c=i(c,"redirect_uri",n),c=i(c,"response_type",a),o){var u=o(e);c=Object.keys(u).reduce(function(e,t){return i(e,t,u[t])},c)}return{authUrl:c,redirectUrl:n,csrfToken:e}}}},2536:function(e){e.exports={b:"zia",a:"Aia"}},2569:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(2),a=Object(r.createStore)("whatsNewStore",{cards:null})},2570:function(e,t,n){"use strict";var r;n.d(t,"a",function(){return r}),function(e){e.Read="Read",e.Unread="Unread"}(r||(r={}))},2599:function(e){e.exports={b:"tia",a:"uia",e:"via",d:"wia",f:"xia",c:"yia"}},2600:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(199),a=n(1946);t.default=function(e,t){return void 0===e||e.__type||(e=a.default(e)),r.makeServiceRequest("GetNewAttachmentDataProviderCreationInfo",e,t)}},2601:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(199),a=n(1947);t.default=function(e,t){return void 0===e||e.__type||(e=a.default(e)),r.makeServiceRequest("GetAttachmentDataProviderCreator",e,t)}},2737:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(2),a=Object(r.action)("TRY_TODO_PANEL")},2882:function(e,t,n){"use strict";var r=n(2),a=n(2737),i=n(932),o=n(105);Object(r.orchestrator)(a.a,function(){Object(o.e)("fwk-o365shellheader")?window.O365Shell.FlexPane.OpenFlexPaneForProvider("OwaToDo"):Object(i.c)(9)})},3258:function(e,t,n){"use strict";var r=n(0),a=2500,i=n(25);function o(e,t,n,o,c){return Object(r.__awaiter)(this,void 0,void 0,function(){var u,s,l;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return r.trys.push([0,6,,7]),n?[4,Promise.all(n.map(function(e){return e.preRun()}))]:[3,2];case 1:r.sent(),r.label=2;case 2:return[4,Promise.all(e.map(function(e){return Promise.race([e.buildPills(),(t=c||a,new Promise(function(e){setTimeout(e,t,[])}))]);var t}))];case 3:return u=r.sent(),s=[].concat.apply([],u),o?[4,Promise.all(o.map(function(e){return e.updateLogData(s)}))]:[3,5];case 4:r.sent(),r.label=5;case 5:return[2,t.arbitratePills(s)];case 6:return l=r.sent(),i.d.warn("[getPillsToRender] Please investigate error: "+l.message),[2,{pillsToShow:[],pillsToHide:[],arbitratorId:void 0}];case 7:return[2]}})})}function c(e,t,n){return{mainPayload:{renderStory:0,loggableText:t,type:e,timeClicked:null,position:-1},cosmosOnlyData:n}}var u=n(194),s=n(411);function l(e,t,n){var r=new s.a(e,t,{isCore:!0,isCosmosDatapoint:!0});n&&r.addCosmosOnlyData(n),u.g.importAndExecute(r)}function d(e,t,n){var r=void 0;e.concat(t).forEach(function(e){!r&&e.logData.cosmosOnlyData&&(r=e.logData.cosmosOnlyData)});var a={data:e.map(function(e){return e.logData.mainPayload})},i={data:t.map(function(e){return e.logData.mainPayload})};l("SmartPillsRendered",[e.length,t.length,JSON.stringify(a),JSON.stringify(i),n],r)}function m(e,t,n,r,a,i,o){l("SmartReply_Rendered",[e,!1,t.join("$"),!1,n.toString(),r.toString(),a,i],o)}function f(e){var t={data:[e.logData.mainPayload]};l("SmartPillClicked",[JSON.stringify(t)],e.logData.cosmosOnlyData)}function g(e,t,n,r,a,i,o){l("SmartReply_Clicked",[e,t,n,!1,r,a,i],o)}n(228);n.d(t,"a",function(){return o}),n.d(t,"b",function(){return c}),n.d(t,"e",function(){return d}),n.d(t,"f",function(){return m}),n.d(t,"c",function(){return f}),n.d(t,"d",function(){return g}),n.d(t,"g",function(){return l})},3264:function(e,t,n){"use strict";var r,a=n(22),i=n(4906),o=n(2),c=n(759);Object(o.mutator)(i.a,function(e){var t=e.itemId,n=e.isSmartSuggestionsRendered,r=e.suggestionTypesRendered,a=e.suggestionsRendered,i=e.extractionId,o=Object(c.t)().items.get(t);o&&o.SIGSData&&(o.SIGSData.SmartPillData={IsSmartSuggestionsRendered:n,SuggestionTypesRendered:r,SuggestionsRendered:a,ExtractionId:i})});!function(e){e.LanguageAndLocale="SmartPill_LanguageAndLocale",e.SmartDoc="SmartPill_SmartDoc",e.SmartReply="SmartPill_SmartReply",e.SmartTask="SmartPill_SmartTask",e.SmartTime="SmartPill_SmartTime"}(r||(r={})),n.d(t,"b",function(){return s}),n.d(t,"a",function(){return r});var u=new a.c(function(){return n.e(428).then(n.bind(null,13685))}),s=new a.a(u,function(e){return e.logToSIGSOnMessageSent})},4684:function(e,t,n){"use strict";n.d(t,"c",function(){return i}),n.d(t,"e",function(){return o}),n.d(t,"d",function(){return c}),n.d(t,"b",function(){return u}),n.d(t,"a",function(){return s}),n.d(t,"f",function(){return l}),n.d(t,"h",function(){return d}),n.d(t,"i",function(){return m}),n.d(t,"j",function(){return f}),n.d(t,"k",function(){return g}),n.d(t,"g",function(){return p});var r=n(503),a=n.n(r),i="Language",o="Locale",c="LanguageScores",u="@EntityId",s="EntityExtraction/ExtractLanguage1.0",l=a()({PropertyName:s,DistinguishedPropertySetId:"Common",PropertyType:"String"}),d=a()({PropertyName:"EntityExtraction/SmartReplyForEmail",DistinguishedPropertySetId:"Common",PropertyType:"String"}),m=a()({PropertyName:"EntityExtraction/Events1.0",DistinguishedPropertySetId:"Common",PropertyType:"String"}),f=a()({PropertyName:"EntityExtraction/RequestForAction1.0",DistinguishedPropertySetId:"Common",PropertyType:"String"}),g=a()({PropertyName:"EntityExtraction/SubstrateSearchSuggestions",DistinguishedPropertySetId:"Common",PropertyType:"String"}),p=a()({PropertyName:"EntityExtraction/ReplyWithQueryCoverage",DistinguishedPropertySetId:"Common",PropertyType:"String"})},4906:function(e,t,n){"use strict";var r=n(2);t.a=Object(r.action)("initializeSIGSDataAction",function(e,t,n,r,a){return{itemId:e,isSmartSuggestionsRendered:t,suggestionTypesRendered:n,suggestionsRendered:r,extractionId:a}})},6359:function(e,t,n){"use strict";n.d(t,"b",function(){return u}),n.d(t,"a",function(){return s});var r=n(0),a=n(228),i=n(759),o=n(25),c=4e3;function u(e){if(e.SIGSData&&e.SIGSData.SmartPillData){var t=e.SIGSData.SmartPillData,n=t.IsSmartSuggestionsRendered,r=t.SuggestionTypesRendered,i=t.SuggestionsRendered,u=t.ExtractionId,s=e.InternetMessageId,l=e.UniqueBody&&e.UniqueBody.Value||e.NormalizedBody&&e.NormalizedBody.Value;if(l&&(l=l.substring(0,c)),"True"===n){var d={InternetMessageId:s,MessageBody:l,SuggestionTypesRendered:r,SuggestionsRendered:i,ExtractionId:u};a.k.importAndExecute("SmartSuggestionsRendered",{compliance:"CustomerContent",customProperties:d})}}else o.d.warn("SIGSData object not initialized on item.")}function s(e,t,n){try{if(e){var u=Object(i.t)().items.get(e);if(u&&u.SIGSData&&u.SIGSData.SmartPillData){var s=u.InternetMessageId,l=u.NormalizedBody&&u.NormalizedBody.Value||u.UniqueBody&&u.UniqueBody.Value;l&&(l=l.substring(0,c));var d=t.substring(0,c);a.k.importAndExecute("SmartSuggestionsClicked",{compliance:"CustomerContent",customProperties:Object(r.__assign)(Object(r.__assign)({InternetMessageId:s,MessageBody:l},u.SIGSData.SmartPillData),{IsSmartSuggestionsClicked:n&&n.isSmartSuggestionsClicked?"True":"False",SuggestionsClickedTime:n&&n.suggestionsClickedTime,ClickIndex:n&&n.clickIndex.toString(),ReplyBody:d})})}}}catch(e){o.d.error("[logToSIGSOnMessageSent] Error: "+e.message)}}},7635:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(22),a=new r.c(function(){return n.e(429).then(n.bind(null,9122))}),i=(Object(r.d)(a,function(e){return e.SmartPill}),Object(r.d)(a,function(e){return e.SmartPillBlock}))},7654:function(e){e.exports={a:"kZb",b:"lZb"}},8760:function(e){e.exports={d:"nZb",c:"oZb",a:"pZb",b:"qZb"}},932:function(e,t,n){"use strict";var r=n(2),a=Object(r.action)("DEACTIVATE_CHARM",function(e){return{charm:e}}),i=Object(r.createStore)("headerViewState",{activeCharm:null});Object(r.mutator)(a,function(e){var t=e.charm,n=i();n.activeCharm===t&&(n.activeCharm=null)});var o=n(1053);Object(r.mutator)(o.a,function(e){var t=e.charm,n=i();n.activeCharm===t?n.activeCharm=null:n.activeCharm=t});var c=n(1899),u=(Object(r.orchestrator)(c.a,function(){Object(o.a)(4)}),Object(r.action)("HIDE_QUICK_OPTIONS",function(){return{}})),s=(Object(r.orchestrator)(u,function(){a(4)}),n(1299));Object(r.orchestrator)(s.d,function(){a(2)});function l(){return i().activeCharm}n.d(t,"a",function(){return a}),n.d(t,"b",function(){return l}),n.d(t,"c",function(){return o.a})},938:function(e,t,n){"use strict";n.d(t,"g",function(){return u}),n.d(t,"b",function(){return s}),n.d(t,"a",function(){return l}),n.d(t,"i",function(){return d}),n.d(t,"h",function(){return m}),n.d(t,"c",function(){return f}),n.d(t,"j",function(){return g}),n.d(t,"f",function(){return p}),n.d(t,"l",function(){return b}),n.d(t,"m",function(){return S}),n.d(t,"n",function(){return h}),n.d(t,"o",function(){return v}),n.d(t,"p",function(){return O}),n.d(t,"k",function(){return y}),n.d(t,"e",function(){return j}),n.d(t,"d",function(){return P});var r=n(0),a=n(1786),i=n(4),o=n(438),c=n.n(o),u="N/A",s="",l="CheckErrorDetails",d="React/Nps",m="UVNpsRating",f="UVFeedback",g="Search_{0}",p="NoUserMessage",b="https://outlook.uservoice.com/forums/{0}",S=601444,h=907141,v=4,O=15;function y(){return[{name:"NoResults",label:Object(i.a)(a.c)},{name:"SlowResults",label:Object(i.a)(a.f)},{name:"ResultsNotRelevant",label:Object(i.a)(a.e)},{name:"ItemNotFound",label:Object(i.a)(a.b)},{name:"SuggestionsNotUseful",label:Object(i.a)(a.g)},{name:"ClientUXHardToUse",label:Object(i.a)(a.a)},{name:"Other",label:Object(i.a)(a.d)}]}function j(e){return e?"1":"2"}function P(){return Object(r.__awaiter)(this,void 0,void 0,function(){var e;return Object(r.__generator)(this,function(t){switch(t.label){case 0:return[4,c()()];case 1:return[2,(e=t.sent()).ConsumerSubscriptions?e.ConsumerSubscriptions.join(","):s]}})})}},962:function(e,t,n){"use strict";var r=n(22),a=n(0),i=n(1500),o=n(105),c=n(1165),u=n(2),s=(Object(u.orchestrator)(i.c,function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){return Object(o.e)("auth-PremiumDashboardApril")?c.e.importAndExecute("premium","features"):Object(o.e)("auth-PremiumDashboard")?c.e.importAndExecute("general","Premium"):window.open("https://premium.outlook.com","_blank"),[2]})})}),n(2248)),l=n(932),d=(Object(u.orchestrator)(s.a,function(){Object(o.e)("fwk-o365shellheader")?window.O365Shell.FlexPane.OpenFlexPaneForProvider("OwaHelp"):Object(l.c)(2)}),n(1787));Object(u.orchestrator)(d.a,function(){Object(o.e)("fwk-o365shellheader")?window.O365Shell.FlexPane.OpenFlexPaneForProvider("OwaSettings"):Object(l.c)(4)}),n(2882);n.d(t,"b",function(){return f}),n.d(t,"e",function(){return g}),n.d(t,"c",function(){return p}),n.d(t,"d",function(){return b}),n.d(t,"h",function(){return S}),n.d(t,"l",function(){return h}),n.d(t,"n",function(){return v}),n.d(t,"f",function(){return O}),n.d(t,"q",function(){return y}),n.d(t,"g",function(){return j}),n.d(t,"r",function(){return P}),n.d(t,"p",function(){return T}),n.d(t,"o",function(){return I}),n.d(t,"m",function(){return w}),n.d(t,"a",function(){return R}),n.d(t,"j",function(){return _}),n.d(t,"k",function(){return D}),n.d(t,"i",function(){return E});var m=new r.c(function(){return Promise.all([n.e(3),n.e(4),n.e(549),n.e(50),n.e(274)]).then(n.bind(null,13768))}),f=Object(r.d)(m,function(e){return e.DiagnosticsPane}),g=Object(r.d)(m,function(e){return e.FeatureFlagsPane}),p=Object(r.d)(m,function(e){return e.FeatureFlagsHeader}),b=Object(r.d)(m,function(e){return e.FeatureFlagsList}),S=Object(r.d)(m,function(e){return e.HelpPane}),h=Object(r.d)(m,function(e){return e.MeCardPane}),v=Object(r.d)(m,function(e){return e.SettingsPane}),O=Object(r.d)(m,function(e){return e.FeedbackPane}),y=Object(r.d)(m,function(e){return e.WafflePane}),j=Object(r.d)(m,function(e){return e.GetStartedPane}),P=Object(r.d)(m,function(e){return e.WhatsNewPane}),T=Object(r.d)(m,function(e){return e.TodoPane}),I=Object(r.d)(m,function(e){return e.TimePanelPane}),w=Object(r.d)(m,function(e){return e.MiniMavenPane}),R=Object(r.d)(m,function(e){return e.ActivityFeedPane}),_=new r.a(m,function(e){return e.launchHelpPane}),D=new r.a(m,function(e){return e.showTodoPanelWithSubject}),E=new r.a(m,function(e){return e.toggleGetStartedPane})}},0,[2,3,4,5,310,11,39,88,350,6,7,9,19,230,549,50,274,587,28,72,443,0,1,532,182,527,145,531,178,23,119,117,246,318,322,337,429,433]]);
//# sourceMappingURL=owa.MailSmartPill.js.map
self.scriptsLoaded['owa.MailSmartPill.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailSmartPill.js'] = (new Date()).getTime();