self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.Skype.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[424],{1018:function(e,t,n){"use strict";var r,i=n(826),a=n(1277),o=n(2);t.a=Object(o.createStore)("owsOptionsStore",{options:(r={},r[i.a.SmartSuggestions]={feature:i.a.SmartSuggestions,smartSuggestionsEnabled:!1,browserLocationEnabled:!1},r[i.a.DiverseEmojis]={feature:i.a.DiverseEmojis,diverseEmojisSelectedSkinTone:""},r[i.a.SurfaceActions]={feature:i.a.SurfaceActions,readSurfaceActions:[],readSurfaceAddins:[],composeSurfaceActions:[],composeSurfaceAddins:[]},r[i.a.SkypeNotifications]={feature:i.a.SkypeNotifications,skypeMessageNotification:1,skypeCallingNotification:1},r[i.a.WebPushNotifications]={feature:i.a.WebPushNotifications,enabled:!1,applicationServerKey:null},r[i.a.Confetti]={feature:i.a.Confetti,confettiEnabled:!1},r[i.a.GdprAdsPrefs]={feature:i.a.GdprAdsPrefs,consentString:null,allowStorageAndAccess:!1,allowPersonalization:!1,allowAdSelectionDeliveryReporting:!1,allowContentSelectionDeliveryReporting:!1,allowMeasurement:!1},r[i.a.CalendarSurfaceAddins]={feature:i.a.CalendarSurfaceAddins,calendarSurfaceAddins:[]},r[i.a.ExternalImages]={feature:i.a.ExternalImages,externalImagesSelectedOption:null},r[i.a.EventCapture]={autoCollectionEnabled:!1},r[i.a.LinkedInBindingDismissed]={linkedInBindingDismissedInPeoplePicker:!1},r[i.a.Translation]={feature:i.a.Translation,translationMode:0,targetLanguage:"",excludedLanguages:[]},r[i.a.CalendarSurfaceOptions]={feature:i.a.CalendarSurfaceOptions,agendaPaneIsClosed:!0},r[i.a.MentionEventNotifications]={feature:i.a.MentionEventNotifications,enabled:!1},r[i.a.TxpEventNotifications]={feature:i.a.TxpEventNotifications,enabled:!1},r[i.a.ComposeAssistance]={feature:i.a.ComposeAssistance,composeAssistanceEnabled:!1},r[i.a.AmpDeveloper]={feature:i.a.AmpDeveloper,enabled:!0,allowedSender:[]},r[i.a.ActivityFeed]={feature:i.a.ActivityFeed,OWASurfaceOptions:{SupportedTypes:[],DisabledInFeedPanel:[]}},r),loadState:a.a.OptionsNotLoaded})},1024:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(1018);function i(e){return Object(r.a)().options[e]}},10309:function(e,t,n){var r=n(10310),i=n(58);"string"==typeof r&&(r=[[e.i,r]]);for(var a=0;a<r.length;a++)i.loadStyles(r[a][1],!1);r.locals&&(e.exports=r.locals)},10310:function(e,t,n){(t=e.exports=n(57)(!1)).push([e.i,'._2pS8bOl0ieaAzwdy9cg-RS{width:235px}html[dir] ._2pS8bOl0ieaAzwdy9cg-RS{padding:25px 20px 12px 20px}._3pvswtalYV4ocp_1VIkJf_{font-size:21px;font-weight:100;font-weight:600;color:"[theme:neutralPrimary, default:#333333]"}html[dir] ._3pvswtalYV4ocp_1VIkJf_{padding-bottom:12px}._3X7BCE3fToVD-QESwyP6QO{font-size:14px;font-weight:400;font-weight:300;color:"[theme:neutralPrimary, default:#333333]"}._2MPHJUqJOlnhTp6IV8zYmR{font-weight:400}html[dir] ._2MPHJUqJOlnhTp6IV8zYmR{padding-top:8px}._3z1qBgV0wtr6fLZexRdIIk{color:"[theme:themePrimary, default:#0078D4]"}',""]),t.locals={notificationContent:"_2pS8bOl0ieaAzwdy9cg-RS",notificationTitle:"_3pvswtalYV4ocp_1VIkJf_",notificationSubtext:"_3X7BCE3fToVD-QESwyP6QO",goToTeams:"_2MPHJUqJOlnhTp6IV8zYmR",teamsLink:"_3z1qBgV0wtr6fLZexRdIIk"}},10311:function(e,t,n){var r=n(10312),i=n(58);"string"==typeof r&&(r=[[e.i,r]]);for(var a=0;a<r.length;a++)i.loadStyles(r[a][1],!1);r.locals&&(e.exports=r.locals)},10312:function(e,t,n){(t=e.exports=n(57)(!1)).push([e.i,".xpcE12DTdKx2lSq2Rp9cN{--themeDarker:var(--fallback-themeDarker);--themeDark:var(--fallback-themeDark);--themeDarkAlt:var(--fallback-themeDarkAlt);--themePrimary:var(--fallback-themePrimary);--themeSecondary:var(--fallback-themeSecondary);--themeTertiary:var(--fallback-themeTertiary);--themeLight:var(--fallback-themeLight);--themeLighter:var(--fallback-themeLighter);--themeLighterAlt:var(--fallback-themeLighterAlt);--headerBrandText:var(--fallback-headerBrandText);--headerTextIcons:var(--fallback-headerTextIcons);--headerSearchBoxIcon:var(--fallback-headerSearchBoxIcon);--headerSearchPlaceholderText:var(--fallback-headerSearchPlaceholderText);--headerSearchButtonIcon:var(--fallback-headerSearchButtonIcon);--headerSearchFilters:var(--fallback-headerSearchFilters);--headerSearchFiltersHover:var(--fallback-headerSearchFiltersHover);--headerBadgeText:var(--fallback-headerBadgeText);--headerSearchIcon:var(--fallback-headerSearchIcon);--black:var(--fallback-black);--blackTranslucent40:var(--fallback-blackTranslucent40);--white:var(--fallback-white);--whiteTranslucent40:var(--fallback-whiteTranslucent40);--whiteTranslucent90:var(--fallback-whiteTranslucent90);--neutralDark:var(--fallback-neutralDark);--neutralPrimary:var(--fallback-neutralPrimary);--neutralPrimaryAlt:var(--fallback-neutralPrimaryAlt);--neutralSecondary:var(--fallback-neutralSecondary);--neutralTertiary:var(--fallback-neutralTertiary);--neutralTertiaryAlt:var(--fallback-neutralTertiaryAlt);--neutralQuaternary:var(--fallback-neutralQuaternary);--neutralQuaternaryAlt:var(--fallback-neutralQuaternaryAlt);--neutralLight:var(--fallback-neutralLight);--neutralLighter:var(--fallback-neutralLighter);--neutralLighterAlt:var(--fallback-neutralLighterAlt);--redDark:var(--fallback-redDark);--flaggedMessage:var(--fallback-flaggedMessage);color:var(--neutralPrimary);bottom:0;position:absolute;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:end;-ms-flex-align:end;align-items:flex-end;max-width:calc(100% - 300px)}html[dir] .xpcE12DTdKx2lSq2Rp9cN{--headerBackground:var(--fallback-headerBackground);--headerBackgroundSearch:var(--fallback-headerBackgroundSearch);--headerSearchBoxBackground:var(--fallback-headerSearchBoxBackground);--headerSearchButtonBackground:var(--fallback-headerSearchButtonBackground);--headerSearchButtonBackgroundHover:var(--fallback-headerSearchButtonBackgroundHover);--headerButtonsBackground:var(--fallback-headerButtonsBackground);--headerButtonsBackgroundHover:var(--fallback-headerButtonsBackgroundHover);--headerButtonsBackgroundSearch:var(--fallback-headerButtonsBackgroundSearch);--headerButtonsBackgroundSearchHover:var(--fallback-headerButtonsBackgroundSearchHover);--headerBadgeBackground:var(--fallback-headerBadgeBackground);--searchBoxBackground:var(--fallback-searchBoxBackground);--richUserContentBackground:var(--fallback-richUserContentBackground);background:var(--white)}html[dir=ltr] .xpcE12DTdKx2lSq2Rp9cN{right:0}html[dir=rtl] .xpcE12DTdKx2lSq2Rp9cN{left:0}.xpcE12DTdKx2lSq2Rp9cN .conversation{display:initial}",""]),t.locals={chatWrapper:"xpcE12DTdKx2lSq2Rp9cN"}},1108:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"SetMailboxMessageConfigurationRequest:#Exchange"},e)}},1277:function(e,t,n){"use strict";var r;n.d(t,"a",function(){return r}),function(e){e[e.OptionsNotLoaded=0]="OptionsNotLoaded",e[e.OptionsLoading=1]="OptionsLoading",e[e.OptionsLoaded=2]="OptionsLoaded"}(r||(r={}))},1295:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(2),i=n(912),a=Object(r.action)("APPLY_DEFAULT_OPTIONS_ON_LOAD_FAIL",function(e){return void 0===e&&(e=Object(i.a)()),{defaultOptions:e}})},13791:function(e,t,n){"use strict";n.r(t);var r=n(2),i=n(3188),a=n(6997);function o(e){window.swc&&"function"==typeof window.swc.setTheme&&window.swc.setTheme(e)}Object(r.orchestrator)(i.a,function(e){o("dark")}),Object(r.orchestrator)(a.a,function(e){o(e.themeId)});var c=n(0),u=n(2025),s=n(43),l=Object(s.action)("updateIsRecentsInitialized ")(function(e){u.a.isRecentsInitialized=e});function d(e){u.a.isSwcInitialized?f(e):window.addEventListener("swc:core:ready",function(){!function e(t){window.removeEventListener("swc:core:ready",function(){e(t)});f(t)}(e)})}function f(e){window.swc&&(window.swc.API.registerEvent("recentsReady",p),window.swc.create("recents",{},e))}function p(){l(!0)}var v=n(173),h=n(716),b=n(86),g=n(1),w=n(10309),m=n(324),k=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(c.__extends)(t,e),t.prototype.populateRecentsContent=function(e){e&&(u.a.isRecentsInitialized?function(e){window.swc&&window.swc.SDK.Recents.refreshDOM(e)}(e):d(e))},t.prototype.render=function(){return g.createElement(h.a,{onDismiss:this.props.onDismiss,target:this.props.target,isBeakVisible:!1,beakWidth:15,gapSpace:0,directionalHint:b.a.bottomCenter,calloutWidth:320,setInitialFocus:!0},this.renderSkypeRecents())},t.prototype.renderSkypeRecents=function(){return g.createElement("div",{"data-style":"outlook",className:m("skype-recents",w.recentsWrapper),ref:this.populateRecentsContent})},t=Object(c.__decorate)([v.observer],t)}(g.Component),O=n(228),S=Object(s.action)("updateIsGlimpseOpen ")(function(e){u.a.isGlimpseOpen=e,window.swc&&(e?window.swc.API.triggerEvent("recentsShown"):window.swc.API.triggerEvent("recentsHidden")),Object(O.o)("Skype_Recents",[e])});var y=n(1324),_=n(2015),A=n(1247);function T(e){A.a.notificationViewStates.forEach(function(t){t.actionType!=_.c.SkypeNotification||t.actionContext.id!=e||Object(_.j)(t)})}var j=n(5952),x=0,E=1;function C(e){var t=e.type,n=e.title,r=e.description,i=e.actions,a=e.avatarUrl,o=j.c.tryImportForRender();if(o&&function(e,t){switch(t){case _.b:case _.e:return!u.a.isGlimpseOpen&&e.skypeMessageNotification!==j.b.None;case _.a:return e.skypeCallingNotification!==j.b.None;default:return null}}(o(),t)){Object(_.g)(_.c.SkypeNotification,I);var c={actionType:_.c.SkypeNotification,title:n,description:r,actionLink:i.length>x?i[x].title:null,cancelLink:i.length>E?i[E].title:null,image:a,actionContext:e,ignore:!1,playSound:N(o(),t),type:e.type};Object(_.f)(c)}}function I(e){var t=e.actionContext,n=t.actions,r=t.type,i=e.ignore,a=e.timedOut;i&&n.length>E?n[E].action():!i&&!a&&n.length>x&&(n[x].action(),r===_.e&&S(!0)),Object(O.o)("Skype_Notification",[r,a?null:i,a])}function N(e,t){switch(t){case _.b:case _.e:return e.skypeMessageNotification!==j.b.ToastOnly;case _.a:return e.skypeCallingNotification!==j.b.ToastOnly;default:return!1}}var D=n(2419),R=Object(s.action)("updateIsSwcInitialized ")(function(e){u.a.isSwcInitialized=e}),B=Object(s.action)("updateUnreadConversationCount")(function(e){u.a.unreadConversationCount=e}),P=n(168),L=n(60),F=n(276),M=n(167),z=n(502),U="dark",V={IsVirtual:!0,ParallelView:!Object(D.a)(),Style:"outlook",CanCollapse:!0};function q(e){var t,n=this,r=Object(P.c)()?U:Object(M.d)();window.swc&&window.swc.init(null,(t={toLoadUnreadConversationsCount:!0,locale:Object(L.a)().SessionSettings.UserLanguage},Object(F.a)()?t:Object(c.__assign)({tokenProvider:H,tokenType:"aad"},t))).then(function(){return Object(c.__awaiter)(n,void 0,void 0,function(){return Object(c.__generator)(this,function(t){return R(!0),window.swc.API.registerEvent("receivedNotification",C),window.swc.API.registerEvent("unreadConversationsUpdate",J),window.swc.API.registerEvent("hideNotification",T),window.swc.API.registerEvent("onRecentItemSelected",G),window.swc.create("chat",V,e),Object(D.a)()&&window.swc.getRecents().then(function(e){return e.setOptions({PreventOpenChat:!0})}),window.swc.setTheme(r),[2]})})})}function H(e){return Object(c.__awaiter)(this,void 0,void 0,function(){return Object(c.__generator)(this,function(t){switch(t.label){case 0:return[4,Object(z.getAccessTokenforResource)(e)];case 1:return[2,t.sent()]}})})}function G(e){S(!1),Object(D.a)()&&Object(r.dispatch)(Object(y.a)(e))}function J(e){B(e)}function W(e){window.addEventListener("swc:core:ready",function(){!function e(t){window.removeEventListener("swc:core:ready",function(){e(t)});q(t)}(e)})}var K=n(10311),Q=n(324),Y="chat-wrapper";var X=function(){var e=document.createElement("div");return e.className=Q(Y,K.chatWrapper),document.body.appendChild(e),e};function Z(){var e;W(X()),(e=document.createElement("script")).type="text/javascript",e.setAttribute("data-style","outlook"),e.setAttribute("data-manual-boot","true"),e.src="https://swc.cdn.skype.com/sdk/v1/sdk.min.js",document.head.appendChild(e)}function $(){var e=j.c.tryImportForRender();return e&&e().skypeMessageNotification!==j.b.None}var ee="swc:ready";function te(){window.addEventListener(ee,function(){!function e(){window.removeEventListener(ee,function(){e()});j.d.importAndExecute()}()})}n.d(t,"SkypeGlimpse",function(){return k}),n.d(t,"updateIsGlimpseOpen",function(){return S}),n.d(t,"beginSkypeInitialization",function(){return Z}),n.d(t,"shouldShowUnreadConversationCount",function(){return $}),n.d(t,"onNotificationReceived",function(){return C}),n.d(t,"onHideNotificationReceived",function(){return T}),n.d(t,"createOnSwcReadyEvent",function(){return te})},1442:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"MailboxMessageConfigurationOptions:#Exchange"},e)}},1443:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(199),i=n(1108);t.default=function(e,t){return void 0===e||e.__type||(e=i.default(e)),r.makeServiceRequest("SetMailboxMessageConfiguration",e,t)}},212:function(e,t,n){"use strict";var r=n(0),i=n(219),a=n(200),o=n(231),c=n(325),u=n.n(c),s=n(73),l=n(373),d=n.n(l),f=500;function p(e){return Object(r.__awaiter)(this,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(n){return t={isUserActivity:!1},[2,d()(u()({Resource:e}),t)]})})}function v(e,t){return Object(r.__awaiter)(this,void 0,void 0,function(){return Object(r.__generator)(this,function(n){return t<1?[2,Promise.reject()]:[2,p(e).catch(function(){return Object(s.a)(f).then(function(){return v(e,t-1)})})]})})}var h,b=n(105),g=n(368),w=3,m=500;function k(e){var t=this,n=null,i=null,a=new Promise(function(e,a){return Object(r.__awaiter)(t,void 0,void 0,function(){return Object(r.__generator)(this,function(t){return n=e,i=a,[2]})})}),o={onFulfilled:n,onRejected:i,resource:e};return(null==h&&(h=new g.a(w,O,m)),h).add(o),a}function O(e){return Object(r.__awaiter)(this,void 0,void 0,function(){return Object(r.__generator)(this,function(t){return I(e.resource).then(function(t){e.onFulfilled(t)}).catch(function(t){e.onRejected(t)}),[2]})})}var S=null;function y(){return null==S&&(S=new i.Cache),S}n.d(t,"e",function(){return x}),n.d(t,"b",function(){return E}),n.d(t,"c",function(){return C}),n.d(t,"a",function(){return I}),n.d(t,"d",function(){return N});var _=1,A=12e4,T=3,j=null;function x(e){j=e}function E(e){return Object(r.__awaiter)(this,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(n){switch(n.label){case 0:return null!=(t=N(D(),e))?[3,2]:[4,I(e)];case 1:t=n.sent(),n.label=2;case 2:return[2,null!=t?t.AccessToken:void 0]}})})}function C(e){var t=N(D(),e);if(t)return[t.AccessToken,void 0];if(Object(b.e)("auth-getAccessTokenQueueEnabled")){var n=function(e){return y().get(e)}(e),r=void 0;return n?r=n:(r=k(e),function(e,t){y().put(e,t)}(e,r)),[void 0,r.then(function(t){return function(e){y().del(e)}(e),t.AccessToken})]}return[void 0,I(e).then(function(e){return e.AccessToken})]}function I(e){return Object(r.__awaiter)(this,void 0,void 0,function(){var t,n,i;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return Object(b.e)("auth-getAccessTokenQueueEnabled")?[4,v(e,T)]:[3,2];case 1:return n=r.sent(),[3,4];case 2:return[4,p(e)];case 3:n=r.sent(),r.label=4;case 4:return null!=(t=n)&&0==t.TokenResultCode&&null!=t.AccessTokenExpiry&&(t.ExpiresIn&&t.ExpiresIn>0&&(t.AccessTokenExpiry=Object(o.a)(Date.now(),t.ExpiresIn).toISOString()),(i=new Date(t.AccessTokenExpiry).getTime()-Date.now()-A)>0&&D().put(e,t,i,function(e,t){I(e).catch(function(){})})),[2,t]}})})}function N(e,t){var n=e.get(t),r=void 0;n&&n.AccessTokenExpiry&&(Object(a.a)(new Date(n.AccessTokenExpiry),-_)>new Date(Date.now())&&(r=n));return r}function D(){return null==j&&(j=new i.Cache),j}},219:function(e,t,n){"use strict";function r(){var e=Object.create(null),t=0,n=0,r=0,i=!1;function a(t){r--,delete e[t]}this.put=function(t,n,i,o){if(void 0!==i&&("number"!=typeof i||isNaN(i)||i<=0))throw new Error("Cache timeout must be a positive number");if(void 0!==o&&"function"!=typeof o)throw new Error("Cache timeout callback must be a function");var c=e[t];c?clearTimeout(c.timeout):r++;var u={value:n,expire:i+Date.now()};return isNaN(u.expire)||(u.timeout=setTimeout(function(){a(t),o&&o(t,n)}.bind(this),i)),e[t]=u,n},this.del=function(t){var n=!0,r=e[t];return r?(clearTimeout(r.timeout),!isNaN(r.expire)&&r.expire<Date.now()&&(n=!1)):n=!1,n&&a(t),n},this.clear=function(){for(var a in e)clearTimeout(e[a].timeout);r=0,e=Object.create(null),i&&(t=0,n=0)},this.get=function(a){var o=e[a];if(void 0!==o){if(isNaN(o.expire)||o.expire>=Date.now())return i&&t++,o.value;i&&n++,r--,delete e[a]}else i&&n++;return null},this.size=function(){return r},this.memsize=function(){var t,n=0;for(t in e)n++;return n},this.debug=function(e){i=e},this.hits=function(){return t},this.misses=function(){return n},this.keys=function(){return Object.keys(e)},this.exportJson=function(){var t={};for(var n in e){var r=e[n];t[n]={value:r.value,expire:r.expire||"NaN"}}return JSON.stringify(t)},this.importJson=function(t,n){var r=JSON.parse(t),i=Date.now(),a=n&&n.skipDuplicates;for(var o in r)if(r.hasOwnProperty(o)){if(a)if(e[o])continue;var c=r[o],u=c.expire-i;if(u<=0){this.del(o);continue}u=u>0?u:void 0,this.put(o,c.value,u)}return this.size()}}e.exports=new r,e.exports.Cache=r},3188:function(e,t,n){"use strict";var r=n(2);t.a=Object(r.action)("TOGGLE_DARK_MODE_THEME",function(e){return{isDarkModeEnabled:e}})},325:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"TokenRequest:#Exchange"},e)}},373:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(199),i=n(325);t.default=function(e,t){return void 0===e||e.__type||(e=i.default(e)),r.makeServiceRequest("GetAccessTokenforResource",e,t)}},3830:function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"c",function(){return o}),n.d(t,"b",function(){return c});var r,i,a=n(4099);function o(e){switch(e){case r.Off:return a.a.None;case r.Notification:return a.a.ToastOnly;case r.All:default:return a.a.ToastAndSound}}function c(e){switch(e){case a.a.None:return r.Off;case a.a.ToastOnly:return r.Notification;case a.a.ToastAndSound:default:return r.All}}!function(e){e.All="ALL",e.Notification="NOTIFICATION",e.Off="OFF"}(r||(r={})),function(e){e.IncomingCall="swc.notification.incoming-call",e.NewMessage="swc.notification.new-message"}(i||(i={}))},4099:function(e,t,n){"use strict";var r;!function(e){e[e.None=0]="None",e[e.ToastAndSound=1]="ToastAndSound",e[e.ToastOnly=2]="ToastOnly",e[e.Migrated=3]="Migrated"}(r||(r={})),t.a=r},4100:function(e,t,n){"use strict";var r=n(794),i=n(2);t.a=Object(i.createStore)("swcOptions",{skypeMessageNotification:null,skypeCallingNotification:null,feature:r.a.SkypeNotifications})},502:function(e,t,n){"use strict";n.r(t);var r=n(219),i=n(212);function a(e){Object(i.e)(new r.Cache),Object(i.b)(e.location.origin)}var o=n(0),c=n(59),u=n(264),s=n.n(u),l=n(231),d={};function f(e){return Object(o.__awaiter)(this,void 0,void 0,function(){var t,n,r;return Object(o.__generator)(this,function(i){switch(i.label){case 0:t=e.client_id+e.scope,n=encodeURIComponent(t),r={},i.label=1;case 1:return i.trys.push([1,3,4,5]),[4,p(e,window)];case 2:return r=i.sent(),[3,5];case 3:return i.sent(),r.TokenResultCode=2,[3,5];case 4:return function(e,t){var n=t.document.getElementById(e);null!=n&&(n.removeEventListener("load",d[e]),t.document.body.removeChild(n),delete d[e])}(n,window),[7];case 5:return[2,r]}})})}function p(e,t){return Object(o.__awaiter)(this,void 0,void 0,function(){var n,r,i;return Object(o.__generator)(this,function(a){return n=encodeURIComponent(e.client_id+e.scope),r=function(e){var t={response_type:"token",prompt:"none",redirect_uri:e.redirect_uri,scope:e.scope,client_id:e.client_id};return e.authorization_uri+"?"+c.stringify(t)}(e),t.document.getElementById(n)?[2,{TokenResultCode:2}]:((i=t.document.createElement("iframe")).src=r.toString(),i.style.display="none",i.id=n,t.document.body.appendChild(i),[2,new Promise(function(e,r){d[n]=function(n){var a={};try{i.contentWindow&&i.contentWindow.location.origin==t.location.origin&&(a=function(e){var t=c.parse(e),n={};t.access_token?(n.AccessToken=t.access_token,n.AccessTokenExpiry=Object(l.a)(Date.now(),parseInt(t.expires_in)).toISOString(),n.TokenResultCode=0):"login_required"==t.error||"interaction_required"==t.error||"consent_required"==t.error?n.TokenResultCode=3:n.TokenResultCode=2;return n}(i.contentWindow.location.hash.substring(1)))}catch(e){a.TokenResultCode=2,r(a)}e(a)},i.addEventListener("load",d[n],!1)})])})})}var v=null;function h(e){return Object(o.__awaiter)(this,void 0,void 0,function(){var t,n,r,i;return Object(o.__generator)(this,function(a){switch(a.label){case 0:return t={scope:e,client_id:"",authorization_uri:"",redirect_uri:""},n=void 0,[4,s()()];case 1:return 0!=(r=a.sent()).ResultCode||null==r.ImplicitGrantAuthorizationUrl||""==r.ImplicitGrantAuthorizationUrl?[2,n]:(i=c.parse(r.ImplicitGrantAuthorizationUrl.split("?")[1]||"")).client_id&&i.redirect_uri?(t.client_id=i.client_id,t.authorization_uri=r.ImplicitGrantAuthorizationUrl.split("?")[0],t.redirect_uri=i.redirect_uri,[4,b(t)]):[3,3];case 2:n=a.sent(),a.label=3;case 3:return[2,n]}})})}function b(e){return Object(o.__awaiter)(this,void 0,void 0,function(){var t,n;return Object(o.__generator)(this,function(r){switch(r.label){case 0:return t=e.client_id+e.scope,null!=(n=Object(i.d)(g(),t))?[3,2]:[4,f(e)];case 1:n=r.sent(),function(e,t){if(t&&0==t.TokenResultCode&&t.AccessTokenExpiry){var n=new Date(t.AccessTokenExpiry).getTime()-Date.now();n>0&&g().put(e,t,n)}}(t,n),r.label=2;case 2:return[2,0==n.TokenResultCode?n.AccessToken:void 0]}})})}function g(){return null==v&&(v=new r.Cache),v}var w=n(204),m=n(377);var k=!1;function O(e){k||(!function(e){var t=Object(m.a)("/owa",e);Object(w.initializeServiceRequest)({baseUrl:t})}(e),k=!0)}function S(e,t,n,r){n?e.acquireTokenPopup(t,null,n,r):e.acquireToken(t,r)}var y=n(22),_=new y.c(function(){return Promise.all([n.e(520),n.e(108)]).then(n.bind(null,14083))}),A=new y.a(_,function(e){return e.createAdalAuthenticationContext});var T=function(e,t,n,r){return function(i,a){i||!a?r(i,null):(e.getCachedUser(),S(e,t,n,r))}},j="adalIdTokenFrame";function x(e,t,n,r){e.config.displayCall=function(i){!function(e){if(-1==e.indexOf("?"))throw new Error("Invalid Url in Adal Auth Context Display Call")}(i),window.detectUserCachedCallback=T(e,t,n,r),function(e,t){e._addAdalFrame(j).src="about:blank",e._loadFrame(t+"&prompt=none",j)}(e,i)},e.login()}function E(e,t,n,r,i){return Object(o.__awaiter)(this,void 0,void 0,function(){var a;return Object(o.__generator)(this,function(o){switch(o.label){case 0:return"https://login.microsoftonline.com/",[4,A.importAndExecute("https://login.microsoftonline.com/",e,t)];case 1:return a=o.sent(),a.getCachedUser()?S(a,n,r,i):x(a,n,r,i),[2]}})})}n.d(t,"registerTokenProvider",function(){return a}),n.d(t,"getAccessTokenforResource",function(){return i.b}),n.d(t,"getAccessTokenforResourceAsLazy",function(){return i.c}),n.d(t,"getDelegationToken",function(){return b}),n.d(t,"getDelegationTokenForOwa",function(){return h}),n.d(t,"bootstrap",function(){return O}),n.d(t,"getAccessTokenOnBehalfOfResource",function(){return E})},5952:function(e,t,n){"use strict";var r=n(22),i=n(6953),a=n(6114),o=n(771),c=n(6115),u=n(105);var s=new r.c(function(){return Promise.all([n.e(742),n.e(712)]).then(n.bind(null,13908))}),l=Object(o.b)({key:"skypeNotifications",titleStringKey:Object(c.a)()?i.b:i.a,searchTermsStringKey:a.a,isHidden:function(){return!(!Object(u.e)("fwk-partner-code-off")&&(Object(u.e)("fwk-skypeConsumer")||Object(u.e)("fwk-skypeBusinessV2")))}},s,function(e){return e.default}),d=n(4099);n(3830),n(4100);n.d(t,"d",function(){return p}),n.d(t,"c",function(){return v}),n.d(t,"a",function(){return l}),n.d(t,"b",function(){return d.a});var f=new r.c(function(){return n.e(426).then(n.bind(null,14006))}),p=new r.a(f,function(e){return e.initializeNotificationSettings}),v=new r.b(f,function(e){return e.getUserSkypeOptions})},6114:function(e){e.exports={a:"ula"}},6115:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(105);function i(){return Object(r.e)("fwk-skypeConsumer")||Object(r.e)("fwk-skypeBusinessCalling")}},6953:function(e){e.exports={b:"Ela",a:"Fla"}},6997:function(e,t,n){"use strict";var r=n(2);t.a=Object(r.action)("ON_COMMIT_THEME_CHANGE",function(e){return{themeId:e}})},771:function(e,t,n){"use strict";var r=n(22),i=n(369),a=n.n(i),o=n(326),c=n.n(o),u=n(372);function s(e,t){return void 0===t&&(t="OWA.UserOptions"),Object(u.a)(t,e.map(function(e){return a()({DictionaryKey:c()({Type:"String",Value:[e.propertyName]}),DictionaryValue:c()({Type:e.propertyType,Value:Array.isArray(e.propertyValue)?e.propertyValue:[e.propertyValue]})})}))}var l=n(1442),d=n.n(l),f=n(1108),p=n.n(f),v=n(1443),h=n.n(v),b=n(239);function g(e){return h()(p()({Header:Object(b.getJsonRequestHeader)(),Options:d()(e)}))}function w(e,t){return null===e?t:e}var m=n(2),k=n(110),O=n(112),S=Object(m.mutatorAction)("updateSessionSettings",function(e){O(Object(k.f)().SessionSettings,e)}),y=n(112),_=Object(m.mutatorAction)("updateUserOptions",function(e){y(Object(k.f)().UserOptions,e)});function A(e){var t=C(e);return!!t&&t.reduce(function(e,t){return e||t.fullOptionFormSettings.isDirty()},!1)}function T(e){var t=C(e);return t&&t.reduce(function(e,t){return e&&!!t.fullOptionFormSettings.hideSaveDiscard&&t.fullOptionFormSettings.hideSaveDiscard()},!0)}function j(e){var t=C(e);return!t||t.filter(function(e){return e.fullOptionFormSettings.isDirty()}).reduce(function(e,t){return e&&!!t.fullOptionFormSettings.disableSave&&t.fullOptionFormSettings.disableSave()},!0)}var x=n(0);function E(e,t,n,i,a){var o=new r.b(t,n),c=i&&a?new r.b(i,a):null;return Object(x.__assign)(Object(x.__assign)({},e),{tryImportFullOptionFormSettingsSync:function(){return o.tryImportForRender()},tryImportQuickOptionSettingsSync:c?function(){return c.tryImportForRender()}:void 0})}function C(e){var t=e.options.map(function(e){return function(e){return"fullOptionFormSettings"in e}(e)?e:Object(x.__assign)(Object(x.__assign)({},e),{fullOptionFormSettings:e.tryImportFullOptionFormSettingsSync()})});return t.some(function(e){return!e.fullOptionFormSettings})?null:t}var I=Object(m.action)("HIDE_FULL_OPTION",function(e,t){return{showQuickOptions:e,subcategory:t}});n.d(t,"g",function(){return D}),n.d(t,"a",function(){return R}),n.d(t,"l",function(){return s}),n.d(t,"h",function(){return g}),n.d(t,"c",function(){return w}),n.d(t,"k",function(){return S}),n.d(t,"m",function(){return _}),n.d(t,"f",function(){return A}),n.d(t,"e",function(){return T}),n.d(t,"i",function(){return j}),n.d(t,"b",function(){return E}),n.d(t,"j",function(){return C}),n.d(t,"d",function(){return I});var N=new r.c(function(){return Promise.all([n.e(5),n.e(11),n.e(39),n.e(88),n.e(350)]).then(n.bind(null,13992))}),D=new r.a(N,function(e){return e.confirmOptionNavigation}),R=Object(r.d)(N,function(e){return e.OptionsEditor})},794:function(e,t,n){"use strict";var r=n(826),i=(function(){}(),n(22)),a=n(79),o=n(1295),c=n(1018),u=n(6),s=n(2),l=[r.a.SurfaceActions];Object(s.mutator)(o.a,function(e){var t=e.defaultOptions;l.forEach(function(e){t[e]&&Object(u.extendObservable)(Object(c.a)().options[e],t[e])})});var d=n(1024),f=n(912);n.d(t,"d",function(){return v}),n.d(t,"g",function(){return h}),n.d(t,"e",function(){return b}),n.d(t,"f",function(){return g}),n.d(t,"c",function(){return d.a}),n.d(t,"b",function(){return f.a}),n.d(t,"a",function(){return r.a});var p=new i.c(function(){return n.e(351).then(n.bind(null,13917))}),v=new i.a(p,function(e){return e.createOrUpdateOptionsForFeature}),h=new i.a(p,function(e){return e.updateAddinPinStatus}),b=new i.b(p,function(e){return e.getServerOptionsForFeature}),g=new i.a(p,function(e){return e.loadOptions});Object(a.c)(function(){g.importAndExecute()})},826:function(e,t,n){"use strict";var r;n.d(t,"a",function(){return r}),function(e){e[e.TestFeature=1]="TestFeature",e[e.SmartSuggestions=2]="SmartSuggestions",e[e.DiverseEmojis=4]="DiverseEmojis",e[e.SurfaceActions=5]="SurfaceActions",e[e.SkypeNotifications=6]="SkypeNotifications",e[e.WebPushNotifications=7]="WebPushNotifications",e[e.Confetti=8]="Confetti",e[e.GdprAdsPrefs=9]="GdprAdsPrefs",e[e.CalendarSurfaceAddins=10]="CalendarSurfaceAddins",e[e.ExternalImages=11]="ExternalImages",e[e.EventCapture=12]="EventCapture",e[e.LinkedInBindingDismissed=13]="LinkedInBindingDismissed",e[e.Translation=14]="Translation",e[e.CalendarSurfaceOptions=15]="CalendarSurfaceOptions",e[e.TxpEventNotifications=16]="TxpEventNotifications",e[e.MentionEventNotifications=17]="MentionEventNotifications",e[e.ComposeAssistance=18]="ComposeAssistance",e[e.ActivityFeed=19]="ActivityFeed",e[e.AmpDeveloper=20]="AmpDeveloper"}(r||(r={}))},912:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(276),i=n(826),a=n(105);function o(){var e;return(e={})[i.a.SmartSuggestions]={smartSuggestionsEnabled:!0,browserLocationEnabled:!1},e[i.a.DiverseEmojis]={diverseEmojisSelectedSkinTone:""},e[i.a.SurfaceActions]={readSurfaceActions:["Reply","ReplyAll","Forward"].concat(Object(r.a)()?[]:["LikeUnlike"]),readSurfaceAddins:[],composeSurfaceActions:["AddAttachment","AddInlineImage","AddEmoji","ToggleDictation","ToggleRibbon"],composeSurfaceAddins:[]},e[i.a.SkypeNotifications]={skypeMessageNotification:1,skypeCallingNotification:1},e[i.a.Confetti]={confettiEnabled:!0},e[i.a.ComposeAssistance]={composeAssistanceEnabled:!0},e[i.a.GdprAdsPrefs]={feature:i.a.GdprAdsPrefs,consentString:null,allowStorageAndAccess:!1,allowPersonalization:!1,allowAdSelectionDeliveryReporting:!1,allowContentSelectionDeliveryReporting:!1,allowMeasurement:!1},e[i.a.CalendarSurfaceAddins]={calendarSurfaceAddins:[]},e[i.a.ExternalImages]={externalImagesSelectedOption:0},e[i.a.EventCapture]={autoCollectionEnabled:!1},e[i.a.LinkedInBindingDismissed]={linkedInBindingDismissedInPeoplePicker:!1},e[i.a.Translation]={translationMode:0,targetLanguage:"",excludedLanguages:[]},e[i.a.CalendarSurfaceOptions]={agendaPaneIsClosed:!1},e[i.a.AmpDeveloper]={enabled:Object(a.e)("rp-ampDefault"),allowedSender:[]},e}}},0,[5,11,39,88,350,520,108,23,119,426]]);
//# sourceMappingURL=owa.Skype.js.map
self.scriptsLoaded['owa.Skype.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.Skype.js'] = (new Date()).getTime();