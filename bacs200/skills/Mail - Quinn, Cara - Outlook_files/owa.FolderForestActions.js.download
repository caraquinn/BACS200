self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.FolderForestActions.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[241],{10398:function(e){e.exports={c:"Ivb",a:"Jvb",b:"Kvb"}},13818:function(e,t,r){"use strict";r.r(t);var o=r(0),a=r(2965),n=r(2381),i=r(2964),c=r(1679),s=r(2427),d=r(2507),l=r(2428),u=r(228),b=r(784),f=r(757),F=r(1339),v=r(861),O=r(2941),j=r(2863);function h(e){return!0===j.a.prefetchedFolderIds.get(e)}var p=r(105),y=r(30),g=r(1234),I=r(755),m=r(761),P=r(7),w=Object(y.b)("selectPersona",c.a.selectPersona)(function(e){var t;if(Object(g.a)("üèÉ‚Äç SelectPersonaToPersonaHeaderRender"),e!==Object(v.c)().id){var r=Object(p.e)("tri-favorites-roaming"),o=void 0;if(r){var a=Object(b.getStore)().outlookFavorites.get(e);o=a?Object(b.convertFavoritePersonaDataToFavoritePersonaNode)(a):void 0}else o=Object(b.getStore)().favoritesPersonaNodes.get(e);if(!o)return Object(d.a)(),Promise.resolve();var n=!1;Object(F.isFavoritingInProgress)(o.personaId)||Object(F.isFavoritingInProgress)(o.mainEmailAddress)||f.o.folderTable.has(o.searchFolderId)||(n=!0,o.searchFolderId=void 0,o.isSearchFolderPopulated=!1);var i=!o.isSearchFolderPopulated,c=o.searchFolderId&&h(o.searchFolderId),j=Object(u.q)();if(j&&j.addCustomData({isSearchFallback:i,searchFolderNotFound:n,isPrefetchedFuf:!!c}),t=Object(l.a)(o,"FavoritesPersonaNode"),r||F.lazyOnFavoritePersonaSelected.importAndExecute(o.id),o.searchFolderId&&(Object(O.b)(o.searchFolderId),Object(I.K)(Object(m.a)("inbox")))){var y=f.o.folderTable.get(o.searchFolderId).TotalCount;Object(u.o)("TnS_PauseSelectPersona",[y-f.o.folderTable.get(o.searchFolderId).pausedTotalCount,Object(P.m)(I.N.inboxPausedDateTime),I.N.inboxPausedLength?I.N.inboxPausedLength:-1],{isCore:!0}),f.o.folderTable.get(o.searchFolderId).pausedTotalCount=y}}return Object(s.a)(),t}),T=Object(y.b)("selectPrivateDistributionList",c.a.selectPrivateDistributionList)(function(e){var t;if(e!=Object(v.c)().id){var r=Object(b.getStore)().outlookFavorites.get(e);if(!r)return Object(d.a)(),Promise.resolve();var o=Object(b.convertFavoritePdlDataToFavoritePdlNode)(r),a=!1;Object(F.isFavoritingInProgress)(o.data.favoriteId)||f.o.folderTable.has(o.data.searchFolderId)||(a=!0,o.data.searchFolderId=void 0,o.data.isSearchFolderPopulated=!1);var n=!o.data.isSearchFolderPopulated,i=o.data.searchFolderId&&h(o.data.searchFolderId),c=Object(u.q)();c&&c.addCustomData({isSearchFallback:n,searchFolderNotFound:a,isPrefetchedFuf:!!i}),t=Object(l.a)(o,"FavoritesPrivateDistributionList"),o.data.searchFolderId&&Object(O.b)(o.data.searchFolderId)}return Object(s.a)(),t}),_=r(2),S=Object(_.action)("SELECT_PREVIOUS_NODE_INTERNAL",function(e){return{actionSource:e}}),N=r(1056),k=r(1342),E=(Object(_.orchestrator)(S,function(e){return Object(o.__awaiter)(void 0,void 0,void 0,function(){var t,r,c,s,d;return Object(o.__generator)(this,function(o){switch(o.label){case 0:if(t=e.actionSource,!Object(p.e)("sea-lazy2"))return[3,5];o.label=1;case 1:return o.trys.push([1,2,,4]),c=k.k.dangerouslyImportSync(),r=c(),[3,4];case 2:return o.sent(),[4,k.k.import()];case 3:return c=o.sent(),r=c(),[3,4];case 4:return[3,6];case 5:r=N.o,o.label=6;case 6:switch(s=r.previousNode,(d=s||Object(v.c)()).type){case 1:w(d.id);break;case 5:T(d.id);break;case 0:Object(n.a)(d.id,d.treeType,t);break;case 4:Object(a.a)(d.id);break;case 2:Object(i.a)(d.id,d.treeType);break;default:throw new Error("exitSearchOrchestrator: Unknown node type")}return[2]}})})}),r(10398)),U=r(4),x=r(795),q=r(872),D=r(239),C=r(2425),M=r.n(C),L=r(774),z=r.n(L),A=r(2424),R=r.n(A);var V=r(1220),H=r(43),K=r(878),J=Object(H.action)("deleteFolder")(function(e,t,r,a){return Object(o.__awaiter)(this,void 0,void 0,function(){var n,i;return Object(o.__generator)(this,function(o){switch(o.label){case 0:return n=e.folderTable.get(t),V.b(),Object(f.db)(e,n),i=Object(f.s)(n.FolderId.Id),Object(K.raiseAction)(q.e.DeleteFolderAction)(i),r?Object(f.p)(e,i):Object(f.Y)(e,n,a),[4,(c=t,s=r,M()({Header:Object(D.getJsonRequestHeader)(),Body:R()({DeleteType:s?"SoftDelete":"MoveToDeletedItems",FolderIds:[z()({Id:c})]})}).then(function(e){return e.Body.ResponseMessages.Items[0]}))];case 1:return o.sent(),[2]}var c,s})})}),B=r(3374),Q=r(1998),$=Object(H.action)("deleteFolderInFolderForest")(Object(H.select)({favoritesFolderNodesV1:function(){return b.favoritesStore.favoritesFolderNodes},favoritesFolderNodesV2:function(){return b.favoritesStore.outlookFavorites},folders:function(){return f.o}})(function(e,t,r,a,i){var c=this,s=i.favoritesFolderNodesV1,d=i.favoritesFolderNodesV2,l=i.folders,u=Object(f.s)(e),b=l.folderTable.get(e),O=a?Object(U.a)(E.c):Object(U.a)(E.a);Object(x.b)(Object(U.a)(E.b),Object(U.b)(O,b.DisplayName)).then(function(i){return Object(o.__awaiter)(c,void 0,void 0,function(){return Object(o.__generator)(this,function(c){return i===x.a.ok?(u.forEach(function(e){!function(e,t,r,a){Object(o.__awaiter)(this,void 0,void 0,function(){return Object(o.__generator)(this,function(o){switch(o.label){case 0:return Object(p.e)("tri-favorites-roaming")?r.has(e)?[4,F.lazyRemoveFavoriteFolder.import()]:[3,2]:[3,3];case 1:o.sent()(e,a),o.label=2;case 2:return[3,5];case 3:return t.has(e)?[4,F.lazyRemoveFavoriteFolder.import()]:[3,5];case 4:o.sent()(e,a),o.label=5;case 5:return[2]}})})}(e,s,d,t),e==Object(v.b)()&&Object(n.a)(Object(m.a)("inbox"),"primaryFolderTree")}),Object(f.L)(e,f.l)?[2,Q.c.importAndExecute(r,e,f.j,!0)]:[2,J(l,e,a,r)]):[2]})})}),B.c.importAndExecute(e)}));var G=r(1497),Y=Object(H.action)("toggleFavoriteFolder")(function(e,t){return Object(o.__awaiter)(this,void 0,void 0,function(){var r,a;return Object(o.__generator)(this,function(o){switch(o.label){case 0:return r=Object(G.f)(e),a=r||e.FolderId.Id,Object(b.isFolderInFavorites)(a)?(a==Object(v.b)()&&Object(n.a)(Object(m.a)("inbox"),"primaryFolderTree"),[4,F.lazyRemoveFavoriteFolder.import()]):[3,2];case 1:return o.sent()(a,t),[3,4];case 2:return[4,F.lazyAddFavoriteFolder.import()];case 3:o.sent()(a,t),o.label=4;case 4:return[2]}})})}),W=r(1219),X=Object(H.action)("selectFolderNode")(function(e,t){var r=e||Object(v.c)();switch(r.type){case 1:W.f.importAndExecute(r.id);break;case 5:W.h.importAndExecute(r.id);break;case 0:Object(W.p)(r.id,r.treeType,t);break;case 4:Object(W.n)(r.id);break;case 2:Object(W.q)(r.id,r.treeType);break;default:throw new Error("selectFolderNode: Unknown node type")}}),Z=r(3626),ee=r(3625),te=r(60),re=r(25),oe=Object(H.action)("initializeFrequentlyUsedFolders")(function(){var e=Object(te.a)().UserOptions,t=!1,r=Object(j.b)();r.isInitialized||(e.FrequentlyUsedFolders&&e.FrequentlyUsedFolders.forEach(function(e){try{var o=JSON.parse(e);r.frequentlyUsedFolders.push(o)}catch(e){re.d.warn("Unable to parse frequently used folders"),t=!0}}),r.isInitialized=!0,t&&Object(ee.a)())}),ae=r(1163),ne=r(1849),ie=r(888),ce=r(1292),se=r(2889),de=r(339),le=r.n(de),ue=r(2128),be=r(1559),fe=r(934),Fe=r(2963),ve=r(263);function Oe(e){if("UserCategory"!=e.filterType)throw new Error("getQueryTypeForFilteredFolder should only be called for 'UserCategory' viewfilter type");var t=Object(ve.h)(e.filterValue,Object(ve.l)());return t?Object(ae.b)(t):null}var je=Object(H.action)("prefetchFrequentlyUsedFolders")(function(){oe(),setTimeout(he,1e4)});function he(){var e=Object(j.b)(),t=Math.min(5,e.frequentlyUsedFolders.length),r=[];le()(function(){for(var a=0;a<t;a++){var n=e.frequentlyUsedFolders[a].FolderId,i=null;if(ge(n)){var c=ye(n);if(!c||"UserCategory"!=c.filterType)continue;i=Oe(c)}else i=Object(ae.c)(n,Object(I.w)(n),pe(n),-1,null,null,Object(be.a)(n));if(i){var s=Object(ce.c)(i),d=Object(ie.a)();if(d&&d.id!=s.id&&Object(ue.a)()&&-1==Object(ue.b)(s)){var l=Object(ne.a)(s,!0,se.a);r.push(l),Object(Z.a)(n)}}}!function(e){var t=Object(j.b)();Object(u.o)("prefetchFrequentlyUsedFolders_count",{total:e,personaTotal:t.frequentlyUsedFolders.slice(0,e).filter(function(e){return Object(b.isFolderPersonaFavoriteSearchFolder)(e.FolderId)}).length,allPrefetched:t.prefetchedFolderIds.size,personaPrefetched:Object(o.__spread)(t.prefetchedFolderIds.keys()).filter(function(e){return Object(b.isFolderPersonaFavoriteSearchFolder)(e)}).length})}(t),Promise.all(r).then(function(){!function(){var e,t,r=0,a=0,n=0,i=0,c=0,s=0,d=Object(m.a)("inbox"),l=I.N.tableViews.values();try{for(var b=Object(o.__values)(l),f=b.next();!f.done;f=b.next()){var F=f.value,v=F.tableQuery,O=v.folderId;if(0!=v.type)return;s++,Object(fe.k)(v)&&c++;for(var j=0,h=0;h<F.rowKeys.length;h++){var p=F.rowKeys[h],y=I.b.getIsPinned(p,F);if(!y)break;j++}O===d&&"All"===v.viewFilter&&(a+=j),r+=j,j>=20?n++:j>=10&&i++}}catch(t){e={error:t}}finally{try{f&&!f.done&&(t=b.return)&&t.call(b)}finally{if(e)throw e.error}}Object(u.o)("TnS_PinnedRowsCount",{total:r,inbox:a,tfc:s,pfc:c,ftwenty:n,ften:i})}()})})}function pe(e){return Object(b.isFolderPersonaFavoriteSearchFolder)(e)?"persona":Object(b.isFolderPrivateDLFavoriteSearchFolder)(e)?"privatedistributionlist":"mail"}function ye(e){var t=e.split(Fe.a);return 2==t.length?{filterType:t[0],filterValue:t[1]}:null}function ge(e){return["SystemCategory","Hashtag","UserCategory"].reduce(function(t,r){return t||e.slice(0,r.length)==r},!1)}r.d(t,"deleteFolderInFolderForest",function(){return $}),r.d(t,"selectPersona",function(){return w}),r.d(t,"selectPrivateDistributionList",function(){return T}),r.d(t,"toggleFavoriteFolder",function(){return Y}),r.d(t,"selectFolderNode",function(){return X}),r.d(t,"selectPreviousNodeInternal",function(){return S}),r.d(t,"prefetchFrequentlyUsedFolders",function(){return je})},2966:function(e,t,r){"use strict";r.d(t,"b",function(){return a});var o=r(2),a=Object(o.createStore)("mruFolderCache",{mruFolders:[],isInitialized:!1}),n=a();t.a=n},3374:function(e,t,r){"use strict";var o=r(22),a=r(3439),n=r.n(a);var i=r(2966),c=r(761),s=r(43),d=Object(s.action)("getMoveToMruList")(function(){n()().then(function(e){return e}).then(function(e){return function(e){if(null==e.FolderMruEntries||0==e.FolderMruEntries.length)i.a.mruFolders.push(Object(c.a)("inbox")),i.a.mruFolders.push(Object(c.a)("deleteditems")),i.a.mruFolders.push(Object(c.a)("archive"));else for(var t=0;t<e.FolderMruEntries.length;t++){var r=e.FolderMruEntries[t].EwsFolderIdEntry;i.a.mruFolders.push(r)}i.a.isInitialized=!0}(e)})});r.d(t,"b",function(){return u}),r.d(t,"c",function(){return b}),r.d(t,"a",function(){return d});var l=new o.c(function(){return r.e(338).then(r.bind(null,13978))}),u=new o.a(l,function(e){return e.addFolderIdToMoveToMruList}),b=new o.a(l,function(e){return e.removeFolderIdFromMoveToMruList})},3439:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r(199);t.default=function(e){return o.makeServiceRequest("GetFolderMruConfiguration",{},e)}}},0,[2,3,8,11,386,87,18,26,35,313,22,334,10,579,407,581,412,4,5,328,329,39,88,350,6,7,9,128,0,1,532,182,13,46,124,531,178,564,341,23,119,339,225,297,318,327,338,501,648]]);
//# sourceMappingURL=owa.FolderForestActions.js.map
self.scriptsLoaded['owa.FolderForestActions.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.FolderForestActions.js'] = (new Date()).getTime();