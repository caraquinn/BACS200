self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.ExpandedListSelectionActions~TabView.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[66],{1683:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var a=n(60);function r(){var e=Object(a.a)();return"ChronologicalNewestOnBottom"==(e.UserOptions?e.UserOptions.ConversationSortOrderReact:"ChronologicalNewestOnBottom")}},2138:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(0);t.default=function(e){return a.__assign({__type:"GetCalendarEventJsonRequest:#Exchange"},e)}},2221:function(e,t,n){"use strict";n.d(t,"a",function(){return d}),n.d(t,"c",function(){return u}),n.d(t,"b",function(){return l});var a=n(0),r=n(779),o=n(1325),i=n(861),s=n(60),c=n(1125);function d(e){var t,n,s=e&&e.itemIds?e.itemIds.length:0;if(0==s)return[null,!1,!1];var d=null,u=2==Object(i.c)().type||!Object(i.b)();if(1==s){if(!(d=r.a.items.get(e.itemIds[0])))return[null,!1,!1];u=u||d.ParentFolderId&&d.ParentFolderId.Id==Object(i.b)()}else{var l=null;try{for(var f=Object(a.__values)(e.itemIds),m=f.next();!m.done;m=f.next()){var b=m.value,v=r.a.items.get(b);if(!v)return[null,!1,!1];if(v.ParentFolderId&&v.ParentFolderId.Id==Object(i.b)()){d=v,u=!0;break}Object(c.a)(v.ParentFolderId.Id,"sentitems")&&(l=v)}}catch(e){t={error:e}}finally{try{m&&!m.done&&(n=f.return)&&n.call(f)}finally{if(t)throw t.error}}d||(d=l||r.a.items.get(e.itemIds[0]))}return[d,u,Object(o.a)(d.ParentFolderId.Id)]}function u(e,t,n){var a=Object(s.a)().UserOptions.HideDeletedItems;return e&&!((e.IsDraft||a)&&t&&!n)}function l(e){var t=r.a.conversationNodes.get(e),n=Object(a.__read)(d(t),3),o=n[0],i=n[1];return u(o,n[2],i)?o:null}},2334:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(0);t.default=function(e){return a.__assign({__type:"GetCalendarEventRequest:#Exchange"},e)}},2335:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(199),r=n(2138);t.default=function(e,t){return void 0===e||e.__type||(e=r.default(e)),a.makeServiceRequest("GetCalendarEvent",e,t)}},2344:function(e,t,n){"use strict";var a=n(0),r=n(1867),o=n(43),i=Object(o.action)("addInfoBarMessage")(function(e,t,n,o){void 0===n&&(n="0"),-1==e.infoBarIds.indexOf(t)?e.infoBarIds.push(t):e.infoBarIds=Object(a.__spread)(e.infoBarIds),o&&(r.b[n]||(r.b[n]={}),r.b[n][t]=o)});t.a=i},2345:function(e,t,n){"use strict";n.d(t,"b",function(){return o});var a=n(3189),r=n(2655);function o(e){return Math.min(Math.floor(e/2),24)}t.a={RPPerfLoadConversationReadingPane:{name:"RPPerfLoadConversationReadingPane"},RPPerfLoadItemReadingPane:{name:"RPPerfLoadItemReadingPane"},RPCountExpCollQuotedText:{name:"RPCountExpCollQuotedText",customData:function(e,t,n){return[n?1:0,!e.isExpanded]}},RPCountExpCollItemPart:{name:"RPCountExpCollItemPart",customData:function(e,t,n){return[t||n?e.isExpanded?"EC":"CE":e==Object(a.b)()?"SC":e.isExpanded?"ES":"CS",t]}},RPCountLoadMore:{name:"RPCountLoadMore"},RPCountExpCollItemsRollUp:{name:"RPCountExpCollItemsRollUp",customData:function(e,t){return[o(Object(r.a)(e)),t]}},RPCountExpCollAllItemParts:{name:"RPCountExpCollAllItemParts",customData:function(e,t){return[e,t]}},PrintItem:{name:"PrintItem",actionSource:function(e,t){return t}},ReplyByMeeting:{name:"ReplyByMeeting",actionSource:function(e,t,n,a){return a}},ToggleIsCalendarRollUpExpanded:{name:function(e){return e.isExpanded?"RPCollapseCalendarRollUp":"RPExpandCalendarRollUp"}},ToggleCalendarRollUpItemPartExpanded:{name:function(e){return e.isExpanded?"RPCollapseCalendarRollUpItemPart":"RPExpandCalendarRollUpItemPart"}}}},2439:function(e,t,n){"use strict";var a;n.d(t,"a",function(){return a}),function(e){e[e.Item=0]="Item",e[e.Oof=1]="Oof",e[e.FossilizedText=2]="FossilizedText",e[e.GlobalReply=3]="GlobalReply",e[e.SeeMore=4]="SeeMore"}(a||(a={}))},2655:function(e,t,n){"use strict";n.d(t,"b",function(){return r}),n.d(t,"c",function(){return o}),n.d(t,"d",function(){return i}),n.d(t,"a",function(){return s});var a=n(779);function r(e){return e&&e.conversationNodeIdsInCollapsedItemsRollUp&&e.conversationNodeIdsInCollapsedItemsRollUp.length>0}function o(e){var t=a.a.conversations.get(e.conversationId.Id);return r(e)||t&&t.canLoadMore}function i(e,t){return e&&e.conversationNodeIdsInCollapsedItemsRollUp&&t&&e.conversationNodeIdsInCollapsedItemsRollUp.includes(t.conversationNodeId)}function s(e){if(!r(e))return 0;var t=e.conversationNodeIdsInCollapsedItemsRollUp,n=e.itemPartsMap,a=t.length;return t.forEach(function(e){var t=n.get(e);t.oofRollUpViewState.oofReplyNodeIds&&(a+=t.oofRollUpViewState.oofReplyNodeIds.length),t.calendarRollUpViewState&&t.calendarRollUpViewState.calendarReponseNodeIds&&(a+=t.calendarRollUpViewState.calendarReponseNodeIds.length)}),a}},2904:function(e,t,n){"use strict";t.a=function(e,t){void 0===t&&(t=!0);var n=t?23:24;return e>=n?n:e}},3189:function(e,t,n){"use strict";n.d(t,"b",function(){return i}),n.d(t,"a",function(){return s}),n.d(t,"c",function(){return c}),n.d(t,"d",function(){return d});var a=n(2439),r=n(853),o=n(43),i=Object(o.select)({conversationReadingPaneState:function(){return r.a.conversationReadingPaneViewState}})(function(e){return e.conversationReadingPaneState&&e.conversationReadingPaneState.focusedItemPart?e.conversationReadingPaneState.focusedItemPart.itemPart:null}),s=Object(o.select)({conversationReadingPaneState:function(){return r.a.conversationReadingPaneViewState}})(function(e){return e.conversationReadingPaneState&&e.conversationReadingPaneState.focusedItemPart?e.conversationReadingPaneState.focusedItemPart.focusedItemArea:null}),c=Object(o.select)({conversationReadingPaneState:function(){return r.a.conversationReadingPaneViewState}})(function(e){return e.conversationReadingPaneState&&e.conversationReadingPaneState.initiallySelectedItemPart?e.conversationReadingPaneState.initiallySelectedItemPart.itemPart:null}),d=Object(o.select)({conversationReadingPaneState:function(){return r.a.conversationReadingPaneViewState}})(function(e,t){var n=i(t),r=s(t);return n==e&&r==a.a.Item})},3213:function(e,t,n){"use strict";n.d(t,"a",function(){return c}),n.d(t,"e",function(){return d}),n.d(t,"c",function(){return u}),n.d(t,"b",function(){return l}),n.d(t,"d",function(){return f}),n.d(t,"i",function(){return m}),n.d(t,"f",function(){return b}),n.d(t,"h",function(){return v}),n.d(t,"g",function(){return I});var a=n(105),r=n(779),o=n(853),i=n(1683),s=/ipm.schedule.meeting.resp/i,c=/^ipm\.schedule\.meeting\.resp\.pos/i,d=/^ipm\.schedule\.meeting\.resp\.tent/i,u=/^ipm\.schedule\.meeting\.resp\.neg/i,l=/^ipm\.schedule\.meeting\.canceled/i,f=/^ipm\.schedule\.meeting\.request/i;function m(){return Object(a.e)("rp-calendarRollup")&&!Object(a.e)("cal-mf-mailCalendarCard")}function b(e){return{isCalendarResponse:s.test(e),isCalendarRequest:f.test(e),calendarReponseNodeIds:[],acceptedAttendees:[],tentativeAttendees:[],declinedAttendees:[],proposedNewTimeAttendeesCount:0,isExpanded:!1,isLoading:!0}}function v(e){if(!m())return!1;var t=!1;return e&&e.itemPartsMap&&e.itemPartsMap.forEach(function(e){e.calendarRollUpViewState.calendarReponseNodeIds.length&&(t=!0)}),t}function I(){var e=o.a.conversationReadingPaneViewState;if(!e)return null;var t=r.a.conversations.get(e.conversationId.Id);if(!t||!t.conversationNodeIds.length)return null;for(var n=t.conversationNodeIds,a=Object(i.a)(),s=a?n.length-1:0,c=a?-1:1;s>=0&&s<=n.length-1;){var d=n[s],u=e.itemPartsMap.get(d);if(u&&u.calendarRollUpViewState.isCalendarRequest)return d;s+=c}return null}},3279:function(e,t,n){"use strict";var a=n(3634),r=n(2345),o=n(4298),i=n(4299),s=n(3768),c=n(3635),d=n(30),u=n(105),l=n(4300),f=n(1581),m=n(861),b=n(872),v=n(779),I=n(1235),p=n(2264),g=n(1869),O=n(3636),j=n(2207),h=n(4780),R=n(4007),S=function(e){return e&&e.Smime&&e.Smime.ErrorState||0},P=n(3443),C=n(1606),w=n(1200),x=n(25),M=n(228),E=function(e,t){x.d.info("S/MIME: processing S/MIME message. isSmimeAdapterAlreadyUsable: "+Object(j.a)());var n=new M.a("RPProcessSmimeItem",{isCore:!0});return I.q.import().then(function(t){return t(e)}).then(function(){A(e,n,t)}).catch(function(){A(e,n,t)})};function y(e,t,n,r,d,u){if(e.itemId==t.Id){var m=t&&t.Id&&Object(v.b)().items.get(t.Id);e.itemViewState=function(e,t){return{itemId:e.Id,isContextMenuShown:!1,isConversationItemPart:!1,attachmentWell:null,meetingRequestViewState:null,infoBarIds:Object(o.a)(),loadingState:{isLoading:!1,hasLoadFailed:!1},actionableMessageCardInItemViewState:{showBodyWithMessageCard:!1,showCardLoading:!0},undoDarkMode:!1,isLoadingFullBody:!1,smartPillViewState:{smartPillBlockVisible:!1},hideSmartReplyFeedbackDialog:!0,isYammerThread:Object(s.a)(t),ampViewState:Object(l.a)(t)}}(t,m),e.loadingState.isLoading=!1,e.loadingState.hasLoadFailed=!m,e.instrumentationContext=n,m&&(r.addCustomData(Object(i.b)(m,u,d)),f.e.import().then(function(e){e(m)}),Object(c.d)(m)?e.isUnsupportedItem=!0:Object(a.a)(e.itemViewState,!1,{item:m}))}}var _=function(e,t,n,a){return a?a(e):Object(b.i)(e,n?"LoadItemPreviewPane":"LoadItemReadingPane",t,Object(j.a)())},N=function(e,t,n,a,r){var o;return Object(u.e)("rp-smime")&&Object(w.a)(n)?p.a.import().then(function(){return Object(j.a)()&&Object(h.a)(n)?(o=!0,_(e,t,a,r)):n}).then(function(){return E(e,o)}):Promise.resolve()};function A(e,t,n){var a=Object(v.b)().items.get(e&&e.Id);t.addCustomData({smimeInstallationStatus:g.a.installationStatus,smimeType:Object(P.a)(a),numAttachments:U(a),wasReloaded:n}),Object(C.a)(a)?t.end():t.endWithError("ClientError",new Error(S(a).toString()))}function U(e){return e&&e.Attachments&&e.Attachments.length}t.a=Object(d.b)("loadItemReadingPane",r.a.RPPerfLoadItemReadingPane)(function(e,t,n,a,o,i){var s=function(e,t){return{itemId:e.Id,itemViewState:null,isPrint:t,loadingState:{isLoading:!0,hasLoadFailed:!1},currentSelectedFolderId:Object(m.b)(),isUnsupportedItem:!1,instrumentationContext:null,showDownlevelContent:!1}}(e,a);n(s);var c=Object(M.q)(function(e){return e.eventName==r.a.RPPerfLoadItemReadingPane.name}),d=Object(v.b)().items.get(e.Id);!Object(u.e)("ring-dogfood")||a||o||Object(M.o)("RPMailStoreItemsCount",{count:Object(v.b)().items.size});var l=Object(h.a)(d),f=Object(w.a)(d);return f&&d.Smime&&!Object(C.a)(d)&&(d.Smime.ErrorState=0),d&&(d.NormalizedBody&&!l||Object(R.a)(d))?Object(u.e)("rp-smime")&&f&&!Object(C.a)(d)?(new M.a("RPProcessSmimeItem").addCustomData({wasItemReloaded:!1}),E(e,!1).then(function(){return y(s,e,t,c,a,o)})):(y(s,e,t,c,a,o),Promise.resolve()):new Promise(function(e){return f&&l&&!Object(O.a)()?p.a.import().then(e):e()}).then(function(){return function(e,t,n,a,r,o,i){return _(t,a,o,i).then(function(e){return N(t,a,e,o,i)}).then(function(){y(e,t,n,a,r,o)}).catch(function(t){return e.loadingState.isLoading=!1,e.loadingState.hasLoadFailed=!0,Promise.reject(t)})}(s,e,t,c,a,o,i)})})},3280:function(e,t,n){"use strict";var a=n(0),r=n(6504),o=n(2345),i=n(4298),s=n(853),c=n(4299),d=n(3768),u=n(2885),l=n(3213),f=n(6158),m=n(6),b=n(228),v=n(30),I=n(105),p=n(4300),g=n(770),O=n(779);function j(e){var t=g.a.conversationItems.get(e);if(t){var n=function(e){var t,n,r,o,i={unreadItemCount:0,totalItemCount:0},s=O.a.conversations.get(e);try{for(var c=Object(a.__values)(s.conversationNodeIds),d=c.next();!d.done;d=c.next()){var u=d.value,l=O.a.conversationNodes.get(u);if(!l){i.totalItemCount=0;break}i.totalItemCount+=l.itemIds.length;try{for(var f=(r=void 0,Object(a.__values)(l.itemIds)),m=f.next();!m.done;m=f.next()){var b=m.value,v=O.a.items.get(b);if(!v){i.totalItemCount=0;break}i.unreadItemCount+=v.IsRead?0:1}}catch(e){r={error:e}}finally{try{m&&!m.done&&(o=f.return)&&o.call(f)}finally{if(r)throw r.error}}}}catch(e){t={error:e}}finally{try{d&&!d.done&&(n=c.return)&&n.call(c)}finally{if(t)throw t.error}}return i}(e);return t.globalItemIds.length!=n.totalItemCount||t.globalUnreadCount!=n.unreadItemCount}return!1}var h=n(861),R=n(872),S=n(43),P=n(759),C=n(2221);n.d(t,"a",function(){return x});var w=[];var x=Object(S.select)({conversationNodes:function(){return P.H.conversationNodes}})(function(e,t){var n;if(!e||!e.Id)return[null,null];var r=t.conversationNodes.get(e.Id),o=(n=Object(a.__read)(Object(C.a)(r),3))[0],s=n[1],c=n[2];if(!Object(C.c)(o,c,s))return[null,null];var u={isExpanded:!1,loadingState:{isLoading:!1,hasLoadFailed:!1}},m=function(e,t,n){return!e.IsRead&&t||e.IsDraft&&!n}(o,s,c),b={mailboxInfo:e.mailboxInfo,Id:o.ItemId.Id};return[{conversationNodeId:e.Id,itemId:b.Id,isConversationItemPart:!0,isExpanded:m,isLocal:s,isDeleted:c,isContextMenuShown:!1,attachmentWell:null,quotedBodyViewState:u,isFossilizedTextExpanded:m,hideSmartReplyFeedbackDialog:!0,meetingRequestViewState:null,infoBarIds:Object(i.a)(),loadingState:{isLoading:!1,hasLoadFailed:!1},actionableMessageCardInItemViewState:{showBodyWithMessageCard:!1,showCardLoading:!0},undoDarkMode:!1,isLoadingFullBody:!1,calendarRollUpViewState:Object(l.f)(o.ItemClass),oofRollUpViewState:Object(f.b)(o.ItemClass),isInRollUp:!1,smartPillViewState:{smartPillBlockVisible:!1},isYammerThread:Object(d.a)(o),ampViewState:Object(p.a)(o)},o]});t.b=Object(S.select)({readingPaneStore:function(){return s.a},conversationNodes:function(){return P.H.conversationNodes},conversations:function(){return P.h}})(Object(v.b)("loadConversationReadingPane",o.a.RPPerfLoadConversationReadingPane)(function(e,t,n,a,i,s){var d,l=Promise.resolve();s.readingPaneStore.conversationReadingPaneViewState=function(e,t,n,a,r){return{conversationId:e,conversationSubject:t,conversationCategories:n,initiallySelectedItemPart:null,itemIdToScrollTo:r,itemPartsMap:new m.ObservableMap({}),loadingState:{isLoading:!0,hasLoadFailed:!1},currentSelectedFolderId:Object(h.b)(),unsupportedItemId:null,instrumentationContext:a,attachmentWell:null,calendarInlineComposeViewState:null,focusedItemPart:null,conversationNodeIdsInCollapsedItemsRollUp:[],nodeIdBundledWithSeeMoreMessages:null,showDownlevelContent:!1,calendarCardViewState:null}}(e,n,a,t,i);var f=Object(u.a)(e.Id),v=Object(b.q)(function(e){return e.eventName==o.a.RPPerfLoadConversationReadingPane.name});if(Object(I.e)("ring-dogfood")){var p=!1;w.includes(e.Id)?p=!0:w.push(e.Id),Object(b.o)("RPCacheStatus",{hasValidConversationCache:f,hasOpened:p,OpenedCount:w.length})}return f&&(d="Valid",s.conversations.getAndTouch(e.Id),Object(r.a)(e.Id)),f&&!j(e.Id)||(d=f?"Stale":"Not",l=Object(R.h)(e,"LoadConversationReadingPane",v)),l.then(function(){v&&v.addCustomData(Object(c.a)(d))})}))},3446:function(e,t,n){"use strict";var a=n(43),r=n(2344),o=Object(a.action)("addInfoBarMessageInReadingPane")(function(e,t,n){Object(r.a)(e,t,e.itemId,n)});t.a=o},3634:function(e,t,n){"use strict";var a=n(0),r=n(4776),o=n(779),i=n(1232),s=n(43);t.a=Object(s.select)({item:function(e){return o.a.items.get(e.itemId)}})(Object(s.action)("initializeExtendedStateForItemViewState")(function(e,t,n){return void 0===t&&(t=!1),Object(a.__awaiter)(this,void 0,void 0,function(){return Object(a.__generator)(this,function(a){switch(a.label){case 0:return[4,Object(r.a)(e,n.item,t)];case 1:return a.sent(),n.item&&Object(i.v)(n.item.ItemClass)&&i.x.importAndExecute(e),[2]}})})}))},3635:function(e,t,n){"use strict";n.d(t,"d",function(){return b}),n.d(t,"c",function(){return v}),n.d(t,"a",function(){return I}),n.d(t,"b",function(){return p});var a=n(757),r=n(779),o=n(761),i="IPM.Appointment",s="IPM.Contact",c="IPM.DistList",d="IPM.Task",u="calendar",l="contacts",f="tasks",m="inbox";function b(e){return e&&(g(e.ItemClass)||O(e.ItemClass)||j(e.ItemClass)||h(e.ItemClass))}function v(e){var t=r.a.conversations.get(e),n=r.a.conversationNodes.get(t&&t.conversationNodeIds[0]);if(n){var a=n.itemIds[0];if(b(r.a.items.get(a)))return a}return null}function I(e){var t=r.a.items.get(e);return g(t.ItemClass)?Object(o.a)(u):O(t.ItemClass)||j(t.ItemClass)?Object(o.a)(l):h(t.ItemClass)?Object(o.a)(f):Object(o.a)(m)}function p(e){var t="",n=a.o.folderTable.get(e);return n&&(t=Object(a.v)(n)),t}function g(e){return 0==e.indexOf(i)}function O(e){return 0==e.indexOf(s)}function j(e){return 0==e.indexOf(c)}function h(e){return 0==e.indexOf(d)}},3636:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var a=n(1869),r=n(1912);function o(){var e=Object(a.b)();return Object(r.k)(e.installationStatus)}},3768:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var a=n(4),r=n(105),o="Beta-Yammer-Outlook-PoC-2019";function i(e){if(!Object(r.e)("rp-yammer")||!e)return!1;var t=null;return e.UniqueBody?t=e.UniqueBody.Value:e.NormalizedBody&&(t=e.NormalizedBody.Value),!Object(a.g)(t)&&t.indexOf(o)>-1}},4007:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var a=n(1071);function r(e){return e&&e.ItemId&&0===e.ItemId.Id.indexOf(a.m)}},4297:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var a=n(25),r=null,o={register:function(e){r=e},available:function(){return!!r},run:function(e){return r?r(e):(a.d.error("getAttachmentWellViewStateByItemIdHelper is not registered."),null)}}},4298:function(e,t,n){"use strict";function a(){return["unsubscribeInfoBar","safetyBar","infoImportance","infoSensitivity","infoFlagStatus","irmInfoBar","infoMessageSubmitted","agendaMailFeedback","unauthenticatedSender","infoDelegate","infoMeetingAttendeeDoNotForward","infoSMIME","infoSmimeDecodeError","infoSmimeSigned","infoItemPartLoadFailure","infoLastUserAction","infoReadReceiptRequested","translateInfoBar","infoResend","infoPolicyTag","infoMessageApprovalAndVoting","nudged","infoMessageClassification"]}n.d(t,"a",function(){return a})},4299:function(e,t,n){"use strict";n.d(t,"a",function(){return f}),n.d(t,"b",function(){return m});var a=n(1683),r=n(853),o=n(779),i=n(2904),s=n(1232),c=n(60),d=n(1200),u="Meeting",l="Message";function f(e){var t=0,n=0,c=0,d=0,u=r.a.conversationReadingPaneViewState.itemPartsMap;return u.forEach(function(e){e.isExpanded&&d++;var a=o.a.items.get(e.itemId);a&&(a.IsRead||t++,a.IsDraft&&n++,Object(s.r)(a)&&c++)}),{owa_1:v(),owa_2:Object(a.a)(),owa_3:Object(i.a)(u.size),owa_4:Object(i.a)(d),owa_5:Object(i.a)(t),owa_6:Object(i.a)(c),owa_7:Object(i.a)(n),owa_8:e}}function m(e,t,n){return{owa_1:v(),owa_2:b(e),owa_3:t,owa_4:n,owa_5:Object(d.a)(e)}}function b(e){return Object(s.r)(e)?u:l}function v(){return Object(c.a)().UserOptions.GlobalReadingPanePositionReact}},4300:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var a=n(5055);function r(e){return{preferAmp:!0,ampAvailability:Object(a.a)(e)}}},4301:function(e,t,n){"use strict";var a;n.d(t,"a",function(){return a}),function(e){e[e.None=0]="None",e[e.AmpDisabled=1]="AmpDisabled",e[e.MessageUnsafe=2]="MessageUnsafe",e[e.SenderNotAllowed=3]="SenderNotAllowed",e[e.BrowserNotSupported=4]="BrowserNotSupported",e[e.AmpNotValidated=5]="AmpNotValidated",e[e.AmpValidationFailed=6]="AmpValidationFailed",e[e.AmpValidated=7]="AmpValidated"}(a||(a={}))},4302:function(e,t,n){"use strict";var a=n(2),r=Object(a.createStore)("ampstore",{allowedSenders:[]});t.a=r()},4776:function(e,t,n){"use strict";var a=n(0),r=n(982),o=n(936),i=n(3062),s=n(1606),c=n(1200),d=n(43),u=n(853),l=n(779),f=n(4297);function m(e){var t=l.a.items.get(e);if(t){var n=t.InternetMessageId,a=u.a.conversationReadingPaneViewState.itemPartsMap.get(n);return a?a.attachmentWell:null}return null}var b=n(3446);t.a=Object(d.action)("initializeAttachmentsForItem")(function(e,t,n){return void 0===n&&(n=!1),Object(a.__awaiter)(this,void 0,void 0,function(){var d;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return!t||Object(c.a)(t)&&!function(e,t){if(!Object(i.a)(t))return!0;if(!e.isConversationItemPart&&Object(s.a)(t))return!0;return!1}(e,t)||!t.Attachments?[2]:e.attachmentWell?[3,2]:[4,o.j.import()];case 1:d=a.sent(),e.attachmentWell=d(!0,!1,""),a.label=2;case 2:return f.a.register(m),n?[4,o.r.importAndExecute(t.Attachments,t.MailboxInfo,e.attachmentWell,!0)]:[3,4];case 3:return a.sent(),[3,6];case 4:return[4,o.o.importAndExecute(t.Attachments,t.MailboxInfo,e.attachmentWell,!0,!1,null,null,null,null,!!t.RightsManagementLicenseData,Object(c.a)(t))];case 5:a.sent(),a.label=6;case 6:return Object(r.e)(t.Attachments).map(r.h).forEach(function(t){return Object(b.a)(e,t)}),[2]}})})})},4780:function(e,t,n){"use strict";var a=n(3062),r=n(1606),o=n(1200),i=n(105),s=n(3636),c=n(2207),d=function(){return!!Object(s.a)()&&!Object(c.a)()};t.a=function(e){return Object(i.e)("rp-smime")&&!Object(r.a)(e)&&!d()&&Object(o.a)(e)&&!Object(a.a)(e)}},4806:function(e,t,n){"use strict";function a(e){return e.From&&e.From.Mailbox?e.From.Mailbox.EmailAddress:null}n.d(t,"a",function(){return a})},4876:function(e,t,n){"use strict";function a(e,t,n){var a=n.get(e);return a?t.get(a.parentInternetMessageId):null}n.d(t,"a",function(){return a})},4877:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var a=n(6157);function r(e,t){var n=t?t.Value:"",r=Object(a.a)(e);return r||n}},5055:function(e,t,n){"use strict";var a=n(4);var r=n(4806),o=n(1905),i=n(35),s=n(4301),c=n(4302),d=n(794);function u(e){if(!function(e){return e&&!Object(a.g)(e.AmpHtmlBody)}(e))return s.a.None;if(!Object(o.a)())return s.a.AmpDisabled;if(!function(e){return e&&!e.BlockStatus&&(!e.MessageSafety||!e.MessageSafety.MessageSafetyLevel||e.MessageSafety.MessageSafetyLevel<=2)}(e))return s.a.MessageUnsafe;var t=Object(r.a)(e);return null==t||!function(e){var t=Object(d.c)(d.a.AmpDeveloper);return t.enabled&&t.allowedSender.some(function(t){return l(t,e)})}(t)&&!function(e){return c.a.allowedSenders&&c.a.allowedSenders.some(function(t){return l(t,e)})}(t)?s.a.SenderNotAllowed:Object(i.d)()||Object(i.f)()?s.a.BrowserNotSupported:s.a.AmpNotValidated}function l(e,t){return e.toLowerCase()==t.toLowerCase()}n.d(t,"a",function(){return u})},5426:function(e,t,n){"use strict";var a=n(2);t.a=Object(a.action)("tryInitializeCalendarCard",function(e){return{conversationId:e}})},6155:function(e,t,n){"use strict";var a=n(4876),r=n(43);t.a=Object(r.action)("tryAddCalendarNodesInRollUp")(function(e,t,n,r,o){r&&e.forEach(function(e){e.calendarRollUpViewState.calendarReponseNodeIds=[]}),n.forEach(function(n){var i=e.get(n);if(i&&i.calendarRollUpViewState.isCalendarResponse){i.isInRollUp=!1;var s=Object(a.a)(n,e,t);s&&(i.isInRollUp=!0,s.calendarRollUpViewState.calendarReponseNodeIds.push(n),i.isExpanded&&!s.calendarRollUpViewState.isExpanded&&(s.calendarRollUpViewState.isExpanded=!r||o&&o.includes(n)))}})})},6156:function(e,t,n){"use strict";var a=n(4876),r=n(43);t.a=Object(r.action)("tryAddOofNodesInRollUp")(function(e,t,n,r){r&&e.forEach(function(e){e.oofRollUpViewState.oofReplyNodeIds=[]}),n.forEach(function(n){var r=e.get(n);if(r&&r.oofRollUpViewState.isOofItem){r.isInRollUp=!1;var o=Object(a.a)(n,e,t);o&&!o.isInRollUp&&(r.isInRollUp=!0,o.oofRollUpViewState.oofReplyNodeIds.push(n))}})})},6157:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var a=n(7015),r=n(4);function o(e){var t;if(e&&e.RightsManagedMessageDecryptionStatus&&0!=e.RightsManagedMessageDecryptionStatus)switch(e.RightsManagedMessageDecryptionStatus){case-2147160052:case-2147160012:case-2147160011:t=Object(r.b)(Object(r.a)(a.d),i());break;case-2147160010:t=Object(r.a)(a.a);break;case-2147168507:t=Object(r.b)(Object(r.a)(a.l),i());break;case-2147160014:t=Object(r.a)(a.j);break;case-2147160054:case-2147160055:t=Object(r.a)(a.h);break;case-2147160064:case-2147160013:t=Object(r.a)(a.g);break;case-2147160051:t=Object(r.a)(a.c);break;case-2147160060:t=Object(r.a)(a.k);break;case-2147160009:default:t=Object(r.b)(Object(r.a)(a.i),e.RightsManagedMessageDecryptionStatus)}return t}function i(){var e=Object(r.b)('<a href="{0}" target="_blank">{1}</a>',Object(r.a)(a.f),Object(r.a)(a.e));return Object(r.b)(Object(r.a)(a.b),e)}},6158:function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"b",function(){return r});var a=/ipm.note.rules.ooftemplate.microsoft/i;function r(e){return{isOofItem:a.test(e),oofReplyNodeIds:[],isOofRollUpExpanded:!1}}},6504:function(e,t,n){"use strict";var a=n(0),r=n(6520),o=n(3634),i=n(3280),s=n(2345),c=n(2655),d=n(1683),u=n(228),l=n(43),f=n(779),m=n(1232),b=5,v=3,I=Object(l.action)("markConversationCollapsedItemsRollUp")(function(e,t,n){e.calendarCardViewState?function(e,t){for(var n=t.length,a=[],r=Object(d.a)()?0:n-1,o=Object(d.a)()?1:-1,i=r;i<=n-1&&i>=0&&!t[i].isExpanded;i+=o)p(t[i])&&a.push(t[i].conversationNodeId);a.length>1&&(e.conversationNodeIdsInCollapsedItemsRollUp=a)}(e,t):function(e,t,n){var a=t.length;if(a<b)return;var r=[],o=Object(d.a)()?1:a-2,i=Object(d.a)()?1:-1;n&&(o-=i);for(var l=o;l<=a-1&&l>=0&&!t[l].isExpanded;l+=i)r.push(t[l].conversationNodeId);if(r.length>=v){if(r.pop(),e.conversationNodeIdsInCollapsedItemsRollUp=r,!n){var f=Object(d.a)()?0:a-1;e.nodeIdBundledWithSeeMoreMessages=t[f].conversationNodeId}Object(u.o)("RPCountRenderCollItemsRollUp",[Object(s.b)(Object(c.a)(e))])}}(e,t,n)});function p(e){var t=f.a.items.get(e.itemId);return!(!t||!Object(m.r)(t))&&t.IsOutOfDate}var g=n(6543),O=n(6155),j=n(6156),h=n(5426),R=n(2439),S=n(853),P=n(4877),C=n(755);var w=n(3213),x=n(3635),M=n(105),E=n(2221),y=n(4);function _(e,t,n,r){var s=[],c=t.itemPartsMap,d=t.itemIdToScrollTo,u=null;if(e.conversationNodeIds){e.conversationNodeIds.forEach(function(t){var n=Object(a.__read)(Object(i.a)({mailboxInfo:e.conversationId.mailboxInfo,Id:t}),1)[0];n&&c.set(t,n)}),Object(M.e)("cal-mf-mailCalendarCard")&&Object(h.a)(e.conversationId.Id),Object(w.i)()&&(Object(O.a)(c,n,e.conversationNodeIds,!1),Object(g.a)()),Object(j.a)(c,n,e.conversationNodeIds,!1);var l=!1;e.conversationNodeIds.forEach(function(e){var t=c.get(e);if(t&&!t.isInRollUp){s.push(t);var n=r.get(t.itemId);(function(e){var t=Object(C.B)();if(t&&t.highlightTerms){var n=Object(P.a)(e.RightsManagementLicenseData,e.UniqueBody),a=document.createElement("div");return a.innerHTML=n,t.highlightTerms.some(function(e){return a.innerText.toLowerCase().indexOf(e)>=0})}return!1})(n)&&(t.isExpanded=!0),l=l||t.isExpanded&&!n.IsDraft}});var b="ChronologicalNewestOnBottom"==e.conversationSortOrder;if(function(e,t,n,a){var r=n.length;if(0!=r&&!t){for(var o=null,i=e?r-1:0,s=i,c=e?-1:1,d=function(e){var t=a.get(e);return Object(E.a)(t)[1]};s>=0&&s<r;){var u=n[s],l=u.oofRollUpViewState.oofReplyNodeIds.some(d);if(!u.isExpanded&&(u.isLocal||l)){o=u;break}s+=c}o||(o=n[i]),o.isExpanded=!0,o.isFossilizedTextExpanded=!0}}(b,l,s,n),u=function(e,t){for(var n=e.length,a=0;a<n;a++){var r=e[a],o=r.itemId;if(t){if(o==t)return r.isExpanded=!0,{itemPart:r,focusedItemArea:R.a.Item}}else{if(r.isExpanded)return{itemPart:r,focusedItemArea:R.a.Item};if(r.oofRollUpViewState.isOofRollUpExpanded)return{itemPart:r,focusedItemArea:R.a.Oof}}}return null}(s,d),t.calendarCardViewState&&function(e){var t=e.length;if(0!=t)for(var n=0;n<t;n++){var a=e[n],r=a?a.itemId:null,o=f.a.items.get(r);if(o&&Object(m.r)(o))if(o.IsRead||o.IsOutOfDate)a.isExpanded=!1,a.isFossilizedTextExpanded=!1;else if(Object(m.v)(o.ItemClass)){var i=o;"NewMeetingRequest"==i.MeetingRequestType&&!Object(y.g)(i.Preview)||i.ChangeHighlights&&i.ChangeHighlights.HasBodyChanged?a.isExpanded=!0:(a.isExpanded=!1,a.isFossilizedTextExpanded=!1)}else!Object(m.w)(o.ItemClass)&&!Object(m.q)(o.ItemClass)||Object(y.g)(o.Preview)?(a.isExpanded=!1,a.isFossilizedTextExpanded=!1):a.isExpanded=!0}}(s),s.forEach(function(e){e.isExpanded&&Object(o.a)(e)}),s.length){var v=b?0:e.conversationNodeIds.length-1,p=e.conversationNodeIds[v],S=c.has(p);e.canLoadMore&&(t.nodeIdBundledWithSeeMoreMessages=p),Object(w.h)(t)||I(t,s,e.canLoadMore&&!S)}}return u}t.a=Object(l.select)({loadedConversation:function(e){return f.a.conversations.get(e)},conversationNodes:function(){return f.a.conversationNodes},conversationReadingPaneState:function(){return S.a.conversationReadingPaneViewState},items:function(){return f.a.items}})(Object(l.action)("firstLoadConversationReadingPane")(function(e,t){if(t.conversationReadingPaneState.conversationId.Id==e){var n=t.conversationReadingPaneState;if(n.loadingState.isLoading=!1,n.loadingState.hasLoadFailed=t.loadedConversation.loadingState.hasLoadFailed,!n.loadingState.hasLoadFailed){var a=Object(x.c)(e);if(n.unsupportedItemId=a,!a){var o=_(t.loadedConversation,n,t.conversationNodes,t.items);n.initiallySelectedItemPart=n.focusedItemPart=o,Object(r.a)(n)}}}}))},6520:function(e,t,n){"use strict";var a=n(0),r=n(4776),o=n(779);function i(e,t){if(e.itemPartsMap.size<=1)return!1;if(function(e){if(!e)return!1;var t=o.a.conversations.get(e.conversationId.Id);return t&&t.canLoadMore}(e))return!0;for(var n=Object(a.__spread)(e.itemPartsMap.keys()),r=0;r<n.length;r++){var i=e.itemPartsMap.get(n[r]);if(i){var s=t.get(i.itemId);if(s&&s.Attachments)return!0}}return!1}var s=n(1683),c=n(936),d=n(1618),u=n(43);t.a=Object(u.action)("initializeAttachmentsForConversationWell")(Object(u.select)({mailStoreItems:function(){return o.a.items}})(function(e,t){return Object(a.__awaiter)(this,void 0,void 0,function(){var n,o,u,l,f,m,b,v,I;return Object(a.__generator)(this,function(p){switch(p.label){case 0:return i(e,t.mailStoreItems)?e.attachmentWell?[3,4]:[4,d.getAttachmentsForConversationWell(e.conversationId)]:[3,11];case 1:return n=a.__read.apply(void 0,[p.sent(),3]),o=n[0],u=n[1],l=n[2],[4,c.l.import()];case 2:return f=p.sent(),e.attachmentWell=f(u,l),[4,c.o.importAndExecute(o,e.conversationId.mailboxInfo,e.attachmentWell,!0,!1)];case 3:p.sent(),p.label=4;case 4:m=Object(a.__spread)(e.itemPartsMap.keys()),b=0,p.label=5;case 5:return b<m.length?(v=e.itemPartsMap.get(m[b]))&&(I=t.mailStoreItems.get(v.itemId))?[4,Object(r.a)(v,I,!1)]:[3,8]:[3,9];case 6:return p.sent(),[4,c.p.importAndExecute(v.attachmentWell,e.attachmentWell,Object(a.__assign)(Object(a.__assign)({},I.ItemId),{mailboxInfo:I.MailboxInfo}),I.DateTimeReceived)];case 7:p.sent(),p.label=8;case 8:return b++,[3,5];case 9:return[4,c.t.importAndExecute(e.attachmentWell,Object(s.a)())];case 10:p.sent(),p.label=11;case 11:return[2]}})})}))},6543:function(e,t,n){"use strict";var a=n(0),r=n(759),o=n(2334),i=n.n(o),s=n(855),c=n.n(s),d=n(2335),u=n.n(d),l=n(239);function f(e){return Object(a.__awaiter)(this,void 0,void 0,function(){return Object(a.__generator)(this,function(t){return[2,m(e).then(function(e){return Object(r.f)(e[0])?e[0].Items[0]:null}).catch(function(){return null})]})})}function m(e){return Object(a.__awaiter)(this,void 0,void 0,function(){return Object(a.__generator)(this,function(t){return[2,u()({Header:Object(l.getJsonRequestHeader)(),Body:i()({EventIds:[e],ItemShape:c()({BaseShape:"IdOnly"})})},null).then(function(e){return e.Body.ResponseMessages.Items})]})})}var b=n(853),v=n(1683),I=n(2221),p=n(1232),g=n(43),O=n(3213);t.a=Object(g.select)({loadedConversation:function(){return r.H.conversations.get(b.a.conversationReadingPaneViewState.conversationId.Id)},itemPartsMap:function(){return b.a.conversationReadingPaneViewState.itemPartsMap},items:function(){return r.H.items}})(Object(g.action)("generateSummaryForCalendarRollUp")(function(e){return Object(a.__awaiter)(this,void 0,void 0,function(){var t,n,r,o,i,s,c,d,u,l,m,b;return Object(a.__generator)(this,function(g){switch(g.label){case 0:if((t=e.loadedConversation.conversationNodeIds).length<=1)return[2];n=Object(v.a)()?t.length-1:0,r=Object(v.a)()?-1:1,o=!1,i=n,g.label=1;case 1:return i<=t.length-1&&i>=0?(s=t[i],e.itemPartsMap.has(s)?(c=e.itemPartsMap.get(s),d=c.calendarRollUpViewState,u=e.items.get(c.itemId),d.calendarReponseNodeIds.length>=1?(l=u,!o&&l&&l.AssociatedCalendarItemId?[4,f(l.AssociatedCalendarItemId)]:[3,3]):[3,5]):[3,6]):[3,7];case 2:return b=g.sent(),[3,4];case 3:b=null,g.label=4;case 4:m=b,function(e){e.acceptedAttendees=[],e.tentativeAttendees=[],e.declinedAttendees=[],e.proposedNewTimeAttendeesCount=0}(d),m&&function(e,t){Object(a.__spread)(t.RequiredAttendees,t.OptionalAttendees).forEach(function(t){var n=[];switch(t.ResponseType){case"Accept":n=e.acceptedAttendees;break;case"Tentative":n=e.tentativeAttendees;break;case"Decline":n=e.declinedAttendees}n.push({Mailbox:t.Mailbox}),t.ProposedStart&&t.ProposedEnd&&e.proposedNewTimeAttendeesCount++})}(d,m),0==function(e){var t=e.acceptedAttendees,n=e.tentativeAttendees,a=e.declinedAttendees;return t.length+n.length+a.length}(d)&&function(e){var t={},n=e.calendarReponseNodeIds,a=e.acceptedAttendees,r=e.tentativeAttendees,o=e.declinedAttendees;n.forEach(function(e){var n=Object(I.b)(e);if(n){var a=n.From?n.From:n.Sender,r=a&&a.Mailbox&&a.Mailbox.EmailAddress&&a.Mailbox.EmailAddress.toLowerCase();r&&(!t[r]||Date.parse(n.DateTimeSent)>Date.parse(t[r].DateTimeSent))&&(t[r]=n)}}),Object.keys(t).forEach(function(e){var n=t[e],i=n.ItemClass,s=n.From?n.From:n.Sender;i.match(O.a)?a.push(s):i.match(O.e)?r.push(s):i.match(O.c)&&o.push(s)})}(d),g.label=5;case 5:d.isLoading=!1,!o&&u&&Object(p.v)(u.ItemClass)&&(o=!0),g.label=6;case 6:return i+=r,[3,1];case 7:return[2]}})})}))},7015:function(e){e.exports={d:"nIb",a:"oIb",l:"pIb",j:"qIb",h:"rIb",g:"sIb",c:"tIb",k:"uIb",i:"vIb",f:"wIb",e:"xIb",b:"yIb"}}}]);
//# sourceMappingURL=owa.ExpandedListSelectionActions~TabView.js.map
self.scriptsLoaded['owa.ExpandedListSelectionActions~TabView.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.ExpandedListSelectionActions~TabView.js'] = (new Date()).getTime();