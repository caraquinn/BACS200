self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MarkRead.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[331],{10534:function(e){e.exports={a:"USb",b:"VSb"}},10535:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"MarkAllItemsAsReadRequest:#Exchange"},e)}},10536:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(199),i=n(10537);t.default=function(e,t){return void 0===e||e.__type||(e=i.default(e)),r.makeServiceRequest("MarkAllItemsAsRead",e,t)}},10537:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"MarkAllItemsAsReadJsonRequest:#Exchange"},e)}},1071:function(e,t,n){"use strict";n.d(t,"j",function(){return r}),n.d(t,"l",function(){return i}),n.d(t,"w",function(){return o}),n.d(t,"u",function(){return a}),n.d(t,"a",function(){return c}),n.d(t,"q",function(){return u}),n.d(t,"b",function(){return s}),n.d(t,"c",function(){return d}),n.d(t,"g",function(){return f}),n.d(t,"h",function(){return l}),n.d(t,"i",function(){return b}),n.d(t,"f",function(){return m}),n.d(t,"e",function(){return v}),n.d(t,"m",function(){return O}),n.d(t,"d",function(){return p}),n.d(t,"k",function(){return j}),n.d(t,"t",function(){return I}),n.d(t,"o",function(){return h}),n.d(t,"v",function(){return g}),n.d(t,"p",function(){return w}),n.d(t,"r",function(){return A}),n.d(t,"s",function(){return _}),n.d(t,"n",function(){return y});var r="multipart/signed",i="application/pkcs7-mime",o="application/x-pkcs7-mime",a=".p7m",c="CLSID:56023A83-B4FC-413B-9285-6BB1DAD977A2",u="CLASSID",s="4",d="0800",f=57,l=16,b=11,m="IPM.Note.SMIME.MultipartSigned",v="IPM.Note.SMIME",O="smime-",p="image",j="OwaToSmime",I="SmimeToOwa",h="en-US",g=["Culture","CodePage","AttachmentSizeLimit","UseKeyIdentifier","AllowUserChoiceOfSigningCertificate","IncludeCertificateChainWithoutRootCertificate","IncludeCertificateChainAndRootCertificate","EncryptTemporaryBuffers","SignedEmailCertificateInclusion","IncludeSmimeCapabilitiesInMessage","CopyRecipientHeaders","OnlyUseSmartCard","EncryptionAlgorithms","SigningAlgorithms","AlwaysEncrypt","AlwaysSign","TripleWrapSignedEncryptedMail","BccEncryptedEmailForking"],w="https://ow2.res.office365.com/owasmime/20.19.814.2/owasmime.msi",A="OwaSmimeEdgeExtension.appxbundle",_="https://ow2.res.office365.com/owasmime/20.19.814.2/OwaSmimeEdgeExtension.appxbundle",y="https://ow2.res.office365.com/owasmime/20.19.814.2/SmimeOutlookWebChrome.msi"},1109:function(e,t,n){"use strict";var r=n(6),i=n(2),o={folderTable:new r.ObservableMap,rootFolder:null},a=Object(i.createStore)("publicFolderFavoriteStore",o)();t.a=a},1200:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(1608);function i(e){return e&&Object(r.b)(e.ItemClass)}},1209:function(e,t,n){"use strict";var r=n(2),i=n(175),o=n(757),a=n(6),c=Object(r.createStore)("mailboxInfoStore",new a.ObservableMap),u=n(60);function s(e){if(!e)return Object(i.e)();if(!c().has(e)){var t=function(e){var t,n,r,a=Object(o.A)(),c=a&&a.get(e);c&&c.treeType===o.l?(t=c.principalSMTPAddress,n=c.principalSMTPAddress,r=Object(i.c)()+c.principalSMTPAddress):(t=Object(i.d)(),n=Object(u.a)().SessionSettings.UserEmailAddress,r=Object(i.b)());return{type:i.a.UserMailbox,deprecatedMailboxId:t,primarySmtpAddress:n,routingKey:r,returnModernConversationItems:!1,requestOptions:Object(o.u)(e)}}(e);d(e,t)}return c().get(e)}var d=Object(r.mutatorAction)("addMailboxInfoToStore",function(e,t){c().set(e,t)}),f=n(1121),l=n(854),b=n(2001);function m(e){return e?v(e.tableQuery):Object(i.e)()}function v(e){var t=Object(l.b)(e),n=e&&e.folderId;return null!=t?Object(f.m)(t):O(n)}function O(e){return Object(o.P)(e)?Object(b.a)(e):s(e)}n.d(t,"a",function(){return m}),n.d(t,"c",function(){return v}),n.d(t,"b",function(){return O})},1220:function(e,t,n){"use strict";var r=n(175),i=n(755),o=n(759),a=n(761),c=n(757);function u(e,t){return!Object(i.s)()&&t&&t.type===r.a.UserMailbox&&!Object(o.z)(e)&&e!=Object(a.a)("recoverableitemsdeletions")&&!Object(c.L)(e,c.l)}var s=n(22),d=n(1551);n.d(t,"e",function(){return l}),n.d(t,"a",function(){return d.a}),n.d(t,"b",function(){return d.b}),n.d(t,"c",function(){return u}),n.d(t,"d",function(){return d.c});var f=new s.c(function(){return n.e(458).then(n.bind(null,13646))}),l=new s.a(f,function(e){return e.undo})},1232:function(e,t,n){"use strict";var r=n(22),i=n(1714),o=n(1760),a=n(1579),c=n(1680),u=n(1609);function s(e){return"RecurringMaster"===e.CalendarItemType}function d(e){var t=e;return"Single"===t.CalendarItemType&&!t.RecurrenceId}function f(e){var t=e;return"Single"===t.CalendarItemType&&!!t.RecurrenceId}n.d(t,"x",function(){return b}),n.d(t,"y",function(){return m}),n.d(t,"i",function(){return v}),n.d(t,"d",function(){return O}),n.d(t,"c",function(){return p}),n.d(t,"g",function(){return j}),n.d(t,"f",function(){return I}),n.d(t,"l",function(){return h}),n.d(t,"m",function(){return g}),n.d(t,"e",function(){return w}),n.d(t,"k",function(){return A}),n.d(t,"b",function(){return _}),n.d(t,"j",function(){return y}),n.d(t,"n",function(){return M}),n.d(t,"o",function(){return S}),n.d(t,"a",function(){return R}),n.d(t,"h",function(){return P}),n.d(t,"p",function(){return i.a}),n.d(t,"r",function(){return o.a}),n.d(t,"v",function(){return a.a}),n.d(t,"w",function(){return c.a}),n.d(t,"q",function(){return u.a}),n.d(t,"t",function(){return s}),n.d(t,"u",function(){return d}),n.d(t,"s",function(){return f});var l=new r.c(function(){return Promise.all([n.e(2),n.e(8),n.e(11),n.e(22),n.e(334)]).then(n.bind(null,13751))}),b=new r.a(l,function(e){return e.initializeMeetingRequestViewStateAction}),m=new r.a(l,function(e){return e.removeCancelledMeetingFromCalendar}),v=Object(r.d)(l,function(e){return e.MeetingMessageInfo}),O=(Object(r.d)(l,function(e){return e.MeetingRequestActions}),Object(r.d)(l,function(e){return e.MeetingCancellationAction})),p=Object(r.d)(l,function(e){return e.MeetingActionButton}),j=Object(r.d)(l,function(e){return e.MeetingDetailsTime}),I=Object(r.d)(l,function(e){return e.MeetingDetailsLocation}),h=Object(r.d)(l,function(e){return e.MeetingRequestInfo}),g=Object(r.d)(l,function(e){return e.MeetingRequestResponseEditor}),w=Object(r.d)(l,function(e){return e.MeetingDetails}),A=Object(r.d)(l,function(e){return e.MeetingRequestConflicts}),_=Object(r.d)(l,function(e){return e.EditEventLink}),y=Object(r.d)(l,function(e){return e.MeetingMessageSummary}),M=Object(r.d)(l,function(e){return e.PreviewSummary}),S=Object(r.d)(l,function(e){return e.SenderSummary}),R=Object(r.d)(l,function(e){return e.CollapsedMeetingMessage}),P=Object(r.d)(l,function(e){return e.MeetingIcon})},1328:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(277);function i(e){var t=new Headers;return Object(r.g)(e,t),{headers:t}}},1486:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"ItemChange:#Exchange"},e)}},1533:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"SortResults:#Exchange"},e)}},1551:function(e,t,n){"use strict";var r,i=n(2),o=Object(i.createStore)("undo",{hasUndoableAction:!1,undoableActionFolderId:null})(),a=n(929),c=n(43),u=n(30);n.d(t,"a",function(){return s}),n.d(t,"b",function(){return d}),n.d(t,"c",function(){return f}),n.d(t,"d",function(){return l});var s=Object(c.action)("addActionToUndoStack")(Object(c.select)({store:function(){return o}})(function(e,t,n){null!==e&&(r=e,n.store.hasUndoableAction=!0,n.store.undoableActionFolderId=t)})),d=Object(c.action)("clearLastUndoableAction")(Object(c.select)({store:function(){return o}})(function(e){r=null,e.store.hasUndoableAction=!1,e.store.undoableActionFolderId=null})),f=Object(c.select)({store:function(){return o}})(function(e){return e.store.hasUndoableAction}),l=Object(u.b)("undo",{name:"TnS_Undo",customData:function(e){return[e]}})(function(e){o.undoableActionFolderId?a.a.clearMapForFolder(o.undoableActionFolderId):a.a.removeAll();null!==r&&(r(),d())})},1579:function(e,t,n){"use strict";function r(e){return e.match(/^ipm\.schedule\.meeting\.request/i)}n.d(t,"a",function(){return r})},1597:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"SetItemField:#Exchange"},e)}},1608:function(e,t,n){"use strict";n.d(t,"d",function(){return i}),n.d(t,"c",function(){return o}),n.d(t,"b",function(){return a}),n.d(t,"a",function(){return c});var r=n(1071);function i(e){return e&&0===e.indexOf(r.f)}function o(e){return e&&0===e.indexOf(r.e)&&!i(e)}function a(e){return e&&0===e.indexOf(r.e)}function c(e){return e.match(/^ipm\.(appointment|schedule\.meeting(?!\.notification))/i)}},1609:function(e,t,n){"use strict";function r(e){return e.match(/^ipm\.schedule\.meeting\.canceled/i)}n.d(t,"a",function(){return r})},1618:function(e,t,n){"use strict";n.r(t);var r=n(0),i=n(1640);var o=n(228),a=n(829),c=n(936),u=n(770),s=n(759),d=n(43),f=n(6);var l=Object(d.action)("createAndStoreAttachmentViewState")(function(e,t,n,i,o){return Object(r.__awaiter)(this,void 0,void 0,function(){var s,d,l,b=this;return Object(r.__generator)(this,function(m){switch(m.label){case 0:return s=function(e,t){return e+"_"+t}(e,n.AttachmentId.Id),d=u.a.attachmentViewStates.get(s),l=f.observable.object(Object(r.__assign)(Object(r.__assign)({},n.AttachmentId),{mailboxInfo:o})),[4,c.d.import().then(function(e){return Object(r.__awaiter)(b,void 0,void 0,function(){return Object(r.__generator)(this,function(r){switch(r.label){case 0:return d=d||e(l,n,!0,!0,!1,!1,t),[4,a.i.import()];case 1:return n=r.sent()(l).model,u.a.attachmentViewStates.set(s,d),[4,a.o.import()];case 2:return r.sent()(n)?i.imageViewStateIds.push(s):i.documentViewStateIds.push(s),[2]}})})})];case 1:return m.sent(),[2]}})})});var b=Object(d.select)({listView:function(){return u.a}})(Object(d.action)("processAttachmentsForConversation")(function(e,t,n){var r=n.listView.conversationItems.get(e.ConversationId.Id);if(r)if(e.AttachmentPreviews){var a=function(e){for(var t=[],n=0,r=e.length;n<r;n++){var i=e[n],o=i.Attachment,a=-1;if(o.IsInline)for(var c=0;c<t.length;c++){var u=t[c];if(u.Attachment.IsInline&&u.Attachment.Name==o.Name&&u.ParentItemId.Id!=i.ParentItemId.Id){a=c;break}}-1==a&&t.push(i)}return t}(e.AttachmentPreviews.Previews);v(e.ConversationId.Id,a,t);var c=e.AttachmentPreviews.Previews.length-a.length;c>0&&Object(o.p)("IP_II_DP",[c])}else r.shouldShowAttachmentPreviews=!1,Object(i.a)(e.ConversationId.Id),Object(o.p)("IP_FP")})),m=Object(d.action)("processAttachmentPreviewsForItems")(function(e,t,n){var o=e.filter(function(e){return e.AttachmentPreviews}),a=[];o.forEach(function(e){a.push.apply(a,Object(r.__spread)(e.AttachmentPreviews.Previews))});var c={};a.forEach(function(e){var n=e.ParentItemId.Id;t.indexOf(n)>-1&&(c[n]||(c[n]=[]),c[n].push(e))}),t.forEach(function(e){var t=s.H.items.get(e);t?c[e]?v(e,c[e],n):(t.shouldShowAttachmentPreviews=!1,Object(i.a)(e)):delete c[e]})}),v=Object(d.action)("processAttachmentsForRow")(function(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,function(){var i,o=this;return Object(r.__generator)(this,function(a){switch(a.label){case 0:return i={documentViewStateIds:[],imageViewStateIds:[]},[4,Promise.all(t.map(function(t){return Object(r.__awaiter)(o,void 0,void 0,function(){return Object(r.__generator)(this,function(o){switch(o.label){case 0:return[4,l(e,Object(r.__assign)(Object(r.__assign)({},t.ParentItemId),{mailboxInfo:n}),t.Attachment,i,n)];case 1:return o.sent(),[2]}})})}))];case 1:return a.sent(),u.a.rowAttachmentPreviewWellViews.set(e,i),[2]}})})}),O=n(2644),p=n.n(O),j=n(2034),I=n.n(j);function h(e,t,n){var i=I()(Object(r.__assign)(Object(r.__assign)({},n),{ConversationIds:e}));return p()(i,t).then(function(e){return e})}var g=n(755),w=n(276);n.d(t,"add",function(){return _}),n.d(t,"getPreviews",function(){return y}),n.d(t,"getAttachmentsForConversationWell",function(){return S});var A=new Map,_=Object(d.select)({rowIdsToGetPreviewsMap:function(){return A}})(Object(d.action)("AttachmentPreviewsOperations.add")(function(e,t,n,r){var i=r.rowIdsToGetPreviewsMap[e&&e.deprecatedMailboxId];i||(i={conversationsIdsArray:[],itemIdsArray:[]},r.rowIdsToGetPreviewsMap[e&&e.deprecatedMailboxId]=i),-1==i.conversationsIdsArray.indexOf(t)&&i.conversationsIdsArray.push(t),-1==i.itemIdsArray.indexOf(n)&&i.itemIdsArray.push(n)})),y=Object(d.select)({rowIdsToGetPreviewsMap:function(){return A}})(Object(d.action)("AttachmentPreviewsOperations.getPreviews")(function(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,function(){var i,o,a,c,u;return Object(r.__generator)(this,function(r){switch(r.label){case 0:if(!(i=n.rowIdsToGetPreviewsMap[e&&e.deprecatedMailboxId]))return[2];o=i.conversationsIdsArray,a=i.itemIdsArray,c=Object(w.a)(),delete n.rowIdsToGetPreviewsMap[e&&e.deprecatedMailboxId],r.label=1;case 1:return r.trys.push([1,3,,4]),[4,h(o,e&&e.requestOptions,{IncludeInlineAttachments:c})];case 2:return void 0!==(u=r.sent()).Conversations?1==t?m(u.Conversations,a,e):function(e,t){e.forEach(function(e){b(e,t)})}(u.Conversations,e):M(t,a,o),[3,4];case 3:return r.sent(),M(t,a,o),[3,4];case 4:return[2]}})})}));function M(e,t,n){1==e?t.forEach(function(e){var t=s.H.items.get(e);t&&(g.N.rowAttachmentPreviewWellViews.get(e)||(t.shouldShowAttachmentPreviews=!1))}):n.forEach(function(e){var t=e.Id,n=g.N.conversationItems.get(t);n&&(g.N.rowAttachmentPreviewWellViews.get(t)||(n.shouldShowAttachmentPreviews=!1))})}var S=Object(d.action)("AttachmentPreviewsOperations.getAttachmentsForConversationWell")(function(e){return Object(r.__awaiter)(this,void 0,void 0,function(){var t,n,i,o,a;return Object(r.__generator)(this,function(c){switch(c.label){case 0:t=[e],n=[],i={},o={},c.label=1;case 1:return c.trys.push([1,3,,4]),[4,h(t,e.mailboxInfo&&e.mailboxInfo.requestOptions,{FullPreviewsPerConversation:300,PreviewsPerConversation:300,MinimumAttachmentSize:0,IncludeInlineAttachments:!1})];case 2:return void 0!==(a=c.sent()).Conversations&&a.Conversations.forEach(function(t){t.ConversationId.Id==e.Id&&t.AttachmentPreviews&&t.AttachmentPreviews.Previews&&t.AttachmentPreviews.Previews.forEach(function(t){n.push(t.Attachment),i[t.Attachment.AttachmentId.Id]=Object(r.__assign)(Object(r.__assign)({},t.ParentItemId),{mailboxInfo:e.mailboxInfo}),o[t.Attachment.AttachmentId.Id]=t.ItemReceivedTime})}),[3,4];case 3:return c.sent(),[3,4];case 4:return[2,[n,i,o]]}})})})},1640:function(e,t,n){"use strict";var r=n(43),i=n(770);t.a=Object(r.action)("removeAttachmentPreviewsForRow")(function(e){var t=i.a.rowAttachmentPreviewWellViews,n=t.get(e);if(n){var r=i.a.attachmentViewStates;n.imageViewStateIds.forEach(function(e){r.delete(e)}),n.documentViewStateIds.forEach(function(e){r.delete(e)}),t.delete(e)}})},1643:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"Message:#Exchange"},e)}},1680:function(e,t,n){"use strict";function r(e){return e.match(/^ipm\.schedule\.meeting\.resp/i)}n.d(t,"a",function(){return r})},1692:function(e){e.exports={a:"Saa"}},1714:function(e,t,n){"use strict";var r=n(2);t.a=Object(r.action)("deleteMeetingMessage",function(e,t){return{item:e,issueDeleteItemCall:t}})},1760:function(e,t,n){"use strict";function r(e){return e.ItemClass.match(/^ipm\.(appointment|schedule\.meeting(?!\.notification))/i)}n.d(t,"a",function(){return r})},1788:function(e,t,n){"use strict";var r=n(2);t.a=Object(r.action)("GET_FOLDER_DATA",function(e){return{folderId:e}})},1941:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(199),i=n(2261);t.default=function(e,t){return void 0===e||e.__type||(e=i.default(e)),r.makeServiceRequest("UpdateItem",e,t)}},1979:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"UpdateItemRequest:#Exchange"},e)}},2001:function(e,t,n){"use strict";var r=n(755),i=n(757);function o(){var e=Object(r.B)();return e&&0==e.tableQuery.type&&Object(i.P)(e.tableQuery.folderId)}function a(){var e=Object(r.B)();return e&&0==e.tableQuery.type&&Object(i.P)(e.tableQuery.folderId)?e.tableQuery.folderId:null}var c=n(2),u=n(1328),s=n(1109),d=n(60),f=n(6),l=Object(c.createStore)("publicFolderUtilsStore",new f.ObservableMap);function b(e){if(!l().has(e)){var t=s.a.folderTable.get(e),n=null!=t.ReplicaList?t.ReplicaList[0]:Object(d.a)().SessionSettings.DefaultPublicFolderMailbox,r={type:null,deprecatedMailboxId:e,primarySmtpAddress:t.principalSMTPAddress,routingKey:n,returnModernConversationItems:null,requestOptions:Object(u.a)(n)};m(e,r)}return l().get(e)}var m=Object(c.mutatorAction)("addPublicFolderMailboxInfoToStore",function(e,t){l().set(e,t)});n.d(t,"b",function(){return a}),n.d(t,"c",function(){return o}),n.d(t,"a",function(){return b})},2032:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(757);function i(e){return Object(r.L)(e,r.l)}},2034:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"GetAttachmentPreviewsRequest:#Exchange"},e)}},2203:function(e){e.exports={a:"mea"}},2221:function(e,t,n){"use strict";n.d(t,"a",function(){return s}),n.d(t,"c",function(){return d}),n.d(t,"b",function(){return f});var r=n(0),i=n(779),o=n(1325),a=n(861),c=n(60),u=n(1125);function s(e){var t,n,c=e&&e.itemIds?e.itemIds.length:0;if(0==c)return[null,!1,!1];var s=null,d=2==Object(a.c)().type||!Object(a.b)();if(1==c){if(!(s=i.a.items.get(e.itemIds[0])))return[null,!1,!1];d=d||s.ParentFolderId&&s.ParentFolderId.Id==Object(a.b)()}else{var f=null;try{for(var l=Object(r.__values)(e.itemIds),b=l.next();!b.done;b=l.next()){var m=b.value,v=i.a.items.get(m);if(!v)return[null,!1,!1];if(v.ParentFolderId&&v.ParentFolderId.Id==Object(a.b)()){s=v,d=!0;break}Object(u.a)(v.ParentFolderId.Id,"sentitems")&&(f=v)}}catch(e){t={error:e}}finally{try{b&&!b.done&&(n=l.return)&&n.call(l)}finally{if(t)throw t.error}}s||(s=f||i.a.items.get(e.itemIds[0]))}return[s,d,Object(o.a)(s.ParentFolderId.Id)]}function d(e,t,n){var r=Object(c.a)().UserOptions.HideDeletedItems;return e&&!((e.IsDraft||r)&&t&&!n)}function f(e){var t=i.a.conversationNodes.get(e),n=Object(r.__read)(s(t),3),o=n[0],a=n[1];return d(o,n[2],a)?o:null}},2261:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"UpdateItemJsonRequest:#Exchange"},e)}},2379:function(e,t,n){"use strict";var r=n(4482),i=n(0),o=n(3341),a=n(3342);function c(e,t,n,r,c){return e.then(function(e){if(Object(o.a)(t,n,c),e.ResponseMessages){var u=function(e,t){var n,r;try{for(var o=Object(i.__values)(e),c=o.next();!c.done;c=o.next()){var u=c.value;if(u&&"Success"!=u.ResponseClass){Object(a.a)(t);var s=new Error("ResponseCode="+u.ResponseCode+", Stacktrace="+u.StackTrace);return s.fetchErrorType="ServerFailure",s}}}catch(e){n={error:e}}finally{try{c&&!c.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return null}(e.ResponseMessages.Items,r);return u?Promise.reject(u):Promise.resolve()}return Promise.reject(new Error("processUpdateItemActionResponseMessage empty response"))}).catch(function(e){return Object(o.a)(t,n,c),Object(a.a)(r),Promise.reject(e)})}var u=n(3677);n.d(t,"d",function(){return r.a}),n.d(t,"e",function(){return c}),n.d(t,"a",function(){return u.a}),n.d(t,"b",function(){return o.a}),n.d(t,"c",function(){return a.a})},2429:function(e,t){e.exports=function(e,t){var n=e.length;if(n!==t.length)return!1;for(var r=0;r<n;r++)if(e[r]!==t[r])return!1;return!0}},2605:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r=n(1643),i=n.n(r),o=n(768),a=n.n(o),c=n(1597),u=n.n(c);function s(e,t){var n;return u()({Path:a()({FieldURI:e}),Item:i()((n={},n[e]=t,n))})}},2644:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(199),i=n(2034);t.default=function(e,t){return void 0===e||e.__type||(e=i.default(e)),r.makeServiceRequest("GetAttachmentPreviews",e,t)}},2750:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(199),i=n(3763);t.default=function(e,t){return void 0===e||e.__type||(e=i.default(e)),r.makeServiceRequest("ApplyConversationAction",e,t)}},2751:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"ApplyConversationActionRequest:#Exchange"},e)}},2752:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"ConversationAction:#Exchange"},e)}},3310:function(e){e.exports={a:"TSb"}},3341:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(929);function i(e,t,n){n&&r.a.removeRowsFromTombstone(e,t)}},3342:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(1896);function i(e){e&&Object(r.a)(e)}},3677:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(0),i=n(759);function o(e){var t,n;if(!e)return Promise.reject(a("500","Server returned a null response!"));var o=Array.isArray(e)?e:[e];try{for(var c=Object(r.__values)(o),u=c.next();!u.done;u=c.next()){var s=u.value;if(s&&!Object(i.f)(s))return Promise.reject(a(s.ResponseCode,s.StackTrace))}}catch(e){t={error:e}}finally{try{u&&!u.done&&(n=c.return)&&n.call(c)}finally{if(t)throw t.error}}return Promise.resolve()}function a(e,t){var n=new Error("ResponseCode="+e+", Stacktrace="+t);return n.fetchErrorType="ServerFailure",n}},3678:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var r=n(774),i=n.n(r),o=n(818),a=n.n(o);function c(e){return e?a()({BaseFolderId:i()({Id:e})}):null}},3763:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"ApplyConversationActionJsonRequest:#Exchange"},e)}},3861:function(e,t,n){"use strict";function r(e){return e?new Date(e).toISOString():null}n.d(t,"a",function(){return r})},4482:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(3341),i=n(3342),o=n(3677);function a(e,t,n,a,c){return e.then(function(e){return Object(r.a)(t,n,c),Object(o.a)(e)}).catch(function(e){return Object(r.a)(t,n,c),Object(i.a)(a),Promise.reject(e)})}},4908:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(0),i=n(2221);function o(e){var t,n,o=[];try{for(var a=Object(r.__values)(e),c=a.next();!c.done;c=a.next()){var u=c.value,s=Object(i.b)(u);s&&o.push(s.ItemId.Id)}}catch(e){t={error:e}}finally{try{c&&!c.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}return o}},5438:function(e,t,n){"use strict";n.d(t,"a",function(){return o}),n.d(t,"b",function(){return a}),n.d(t,"c",function(){return c});var r=n(22),i=new r.c(function(){return Promise.all([n.e(6),n.e(7),n.e(9),n.e(271)]).then(n.bind(null,9108))}),o=new r.b(i,function(e){return e.addMarkAsReadDiagnostics}),a=new r.b(i,function(e){return e.addUnreadCountNotificationDiagnostics}),c=new r.b(i,function(e){return e.addUnreadCountSubscriptionDiagnostics})},6196:function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"b",function(){return i});var r=1e4,i=25},6472:function(e,t,n){"use strict";n.r(t);var r=n(0),i=n(755),o={markConversationAsRead:{name:function(e,t,n,r,i,o,a){var c="TnS_MarkConversation";return c+=n?"Read":"Unread",r||(c+="Background"),c},options:function(e,t,n,r,i,o,a){return r?{isCore:!0}:{}},customData:function(e,t,n,r,o,a,c){return[o,e.length,Object(i.l)(t),Object(i.H)(t)]},cosmosOnlyData:function(e,t,n,o,a,c,u){var s,d,f=[],l=Object(i.A)(e,t);try{for(var b=Object(r.__values)(l),m=b.next();!m.done;m=b.next()){var v=m.value;f.push(i.b.getItemIds(v,t))}}catch(e){s={error:e}}finally{try{m&&!m.done&&(d=b.return)&&d.call(b)}finally{if(s)throw s.error}}return JSON.stringify({itemIds:f,conversationIds:e})}},markItemReadUnread:{name:function(e,t,n,r,i,o){var a="TnS_MarkItem";return a+=n?"Read":"Unread",r||(a+="Background"),a},options:function(e,t,n,r,i,o){return r?{isCore:!0}:{}},customData:function(e,t,n,r,o,a){var c=e?e.tableQuery.type:null,u=e?Object(i.l)(e):null,s=e?Object(i.H)(e):null;return[c,t.length,u,s]},cosmosOnlyData:function(e,t,n,r,i,o){return JSON.stringify({itemIds:t})},actionSource:function(e,t,n,r,i){return i}}},a=n(779);var c=n(43),u=n(2),s=Object(u.createStore)("markread",{markAsReadTimerTask:null,suppressedItemIdsMap:{}})(),d=Object(c.action)("AddMarkReadSuppressedItemIds")(Object(c.select)({store:function(){return s}})(function(e,t){e.forEach(function(e){return t.store.suppressedItemIdsMap[e]=!0})})),f=Object(c.action)("RemoveMarkReadSuppressedItemIds")(Object(c.select)({store:function(){return s}})(function(e,t){e.forEach(function(e){return delete t.store.suppressedItemIdsMap[e]})})),l=Object(c.action)("ClearMarkReadSuppressedMap")(Object(c.select)({store:function(){return s}})(function(e){e.store.suppressedItemIdsMap={}}));function b(e){for(var t=0;t<e.length;t++)if(!s.suppressedItemIdsMap[e[t]])return!1;return!0}var m=n(2605),v=n(60),O=n(1486),p=n.n(O),j=n(775),I=n.n(j),h=n(1941),g=n.n(h),w=n(1979),A=n.n(w),_=n(239);function y(e,t,n){var r=function(e,t){var n="AlwaysSend"!=Object(v.a)().UserOptions.ReadReceipt,r=Object(m.a)("IsRead",t),i=[];return e.forEach(function(e){return i.push(p()({Updates:[r],ItemId:I()({Id:e})}))}),A()({ItemChanges:i,ConflictResolution:"AlwaysOverwrite",MessageDisposition:"SaveOnly",SuppressReadReceipts:n})}(e,t);return g()({Header:Object(_.getJsonRequestHeader)(),Body:r},n).then(function(e){return e.Body.ResponseMessages.Items[0]})}var M=n(5438),S=n(842),R=n(1902),P=n(834),k=n(25),C=n(30),T=n(2379),x=Object(C.b)("markItemsAsReadBasedOnItemIds",o.markItemReadUnread)(function(e,t,n,o,c,u){return Object(r.__awaiter)(this,void 0,void 0,function(){var s,l,b,m;return Object(r.__generator)(this,function(r){return 0==(s=function(e,t){var n=[];return e.forEach(function(e){var r=a.a.items.get(e);Object(i.L)(r)&&r.IsRead!=t&&n.push(e)}),n}(t,n)).length?[2,Promise.resolve()]:(n?f(s):o?d(s):k.d.warn("Invalid scenario to implicitly mark item as unread."),l=e?e.id:null,Object(R.a)(s,n,o,l),M.a.import().then(function(t){t(e?e.tableQuery:null,!1,n,c,s)}),n?o?Object(S.o)("MarkAsRead",u):Object(S.o)("MarkAsReadImplicit",u):Object(S.o)("MarkAsUnread",u),b=Object(P.b)(e).requestOptions,m=e?Object(i.A)(s,e):[],[2,E(e,m,s,n,b)])})})});function E(e,t,n,r,i){return y(n,r,i).then(function(e){return Object(T.a)(e)}).catch(function(n){var r=e?e.serverFolderId:null;return Object(T.b)(t,r,!0),Promise.reject(n)})}var F=Object(c.action)("autoMarkItemAsRead")(function(e,t){Object(i.f)(t)&&(b([e])||(x(t,[e],!0,!1,null,[]),l()))}),U=Object(c.action)("onItemPartDeselected")(function(e,t){t&&"OnSelectionChange"==Object(v.a)().UserOptions.PreviewMarkAsRead&&F(e,t)}),D=n(3861),q=n(3678),V=n(2751),B=n.n(V),N=n(2752),Q=n.n(N),L=n(2750),H=n.n(L),G=n(891);function W(e,t,n){var r=Object(q.a)(n),i=e.map(function(e){return function(e,t,n){return Q()({Action:"SetReadState",ConversationId:I()({Id:e.conversationId}),IsRead:t,ConversationLastSyncTime:Object(D.a)(e.conversationLastSyncTimeStamp),SuppressReadReceipts:!0,ContextFolderId:n})}(e,t,r)});return B()({ConversationActions:i,ReturnMovedItemIds:!1})}var J=n(1901),K=n(1374);var z=Object(C.b)("markConversationsAsReadBasedOnConversationIds",o.markConversationAsRead)(function(e,t,n,o,a,c,u){var s=function(e,t,n){var r=[];return e.forEach(function(e){var o=Object(i.E)(e,t);o&&o.unreadCount>0===n&&r.push(e)}),r}(u,t.id,n);if(0==s.length)return Promise.resolve();if(1==e.length&&1==t.selectedRowKeys.size){var f=i.b.getRowIdString(s[0],t),b=Object(i.E)(Object(r.__spread)(t.selectedRowKeys.keys())[0],t.id);if(f==b.id){var m=b.itemIds;n?l():o?d(m):k.d.warn("Invalid scenario to implicitly mark conversation as unread.")}}Object(J.a)(e,t.id,n,o),M.a.import().then(function(r){r(t.tableQuery,!1,n,a,e)}),n?o?Object(S.o)("MarkAsRead",c):Object(S.o)("MarkAsReadImplicit",c):Object(S.o)("MarkAsUnread",c);var v=Object(P.b)(t).requestOptions;return Object(i.e)(t)?function(e,t,n,o){var a=[];return t.forEach(function(t){a.push.apply(a,Object(r.__spread)(i.b.getItemIds(t,e)))}),E(e,t,a,n,o)}(t,s,n,v):function(e,t,n,r,o){var a=Object(K.a)(e),c=function(e,t,n,r){var i=W(e,t,n);return H()({Header:Object(G.getJsonRequestHeader)(),Body:i},r).then(function(e){return e.Body.ResponseMessages.Items[0]})}(t.map(function(t){return Object(i.h)(t,e.id)}),n,a,o),u=Object(i.P)(e,n,r);return Object(T.d)(c,t,a,e,u)}(t,s,n,o,v)});var $=n(828),X=Object(c.action)("autoMarkConversationAsRead")(Object(c.select)({items:function(){return a.a.items}})(function(e,t,n){var r=Object(i.A)([e],t),o=Object($.a)(r[0],t.id);if(o&&Object(i.f)(t)){var a=o.itemIds;b(a)||(0==Object.keys(s.suppressedItemIdsMap).length?z([e],t,!0,!1,null,[],r):a.forEach(function(e){!b([e])&&n.items.get(e)&&x(t,[e],!0,!1,null,[])}),l())}}));function Y(e,t){var n=i.b.getRowIdString(e,t);switch(t.tableQuery.listViewType){case 0:X(n,t);break;case 1:F(n,t)}}var Z=n(849),ee=Object(c.action)("onReadingPaneClosed")(function(e,t){Object(Z.p)()||k.d.error("onReadingPaneClosed should only be called in single line view."),"OnSelectionChange"==Object(v.a)().UserOptions.PreviewMarkAsRead&&Y(e,t)}),te=Object(c.action)("onSingleSelectionChanged")(function(e,t,n){var r=Object(v.a)().UserOptions;Object(Z.p)()||"OnSelectionChange"==r.PreviewMarkAsRead&&n&&Y(e,t)}),ne=Object(u.action)("MARK_ITEMS_READ_BASED_ON_NODE_IDS",function(e,t,n,r,i){return{nodeIds:e,tableViewId:t,isReadValueToSet:n,isExplicit:r,actionSource:i}}),re=Object(c.action)("markItemAsReadFromReadingPane")(function(e,t,n,r,o){var c=[],u=null;if(t){if(1==t.tableQuery.listViewType)c=Object(i.A)([e],t);else{var s=a.a.items.get(e).ConversationId.Id;c=Object(i.A)([s],t)}u=Object(i.k)(t)}x(t,[e],n,!0,o,r).then(function(){t&&Object(T.b)(c,u)}).catch(function(e){t&&(Object(T.b)(c,u),Object(T.c)(t))})}),ie=n(1577),oe=Object(c.action)("markConversationsAsReadFromTable")(function(e,t,n,r){var o=Object(i.y)(e,t.id),a=Object(ie.a)(e,t);return z(o,t,n,!0,r,a,e)}),ae=Object(c.action)("markItemsReadFromTable")(function(e,t,n,r,o){var a=Object(i.y)(e,t.id),c=Object(ie.a)(e,t),u=x(t,a,n,r,o,c),s=Object(i.k)(t),d=Object(i.P)(t,n,r);u.then(function(t){Object(T.b)(e,s,d)}).catch(function(n){Object(T.b)(e,s,d),Object(T.c)(t)})}),ce=n(2029),ue=Object(c.action)("toggleRowReadState")(function(e,t,n){var r=i.N.tableViews.get(t),o=i.b.getUnreadCount(e,r)>0;switch(r.tableQuery.listViewType){case 0:oe([e],r,o,n);break;case 1:ae([e],r,o,!0,n)}Object(ce.b)()}),se=Object(c.action)("onNavigateAwayViaUpDown")(function(e,t){"OnSelectionChange"==Object(v.a)().UserOptions.PreviewMarkAsRead&&Y(e,t)}),de=n(10534),fe=n(3310),le=n(2203),be=n(1692),me=n(4),ve=n(872),Oe=n(795),pe=n(10535),je=n.n(pe),Ie=n(10536),he=n.n(Ie);var ge=n(6196),we=n(878),Ae=n(757),_e=n(1220),ye=n(2032),Me=n(228),Se=n(7),Re=Object(c.action)("markAsReadInTable")(function(e,t,n,o,a,c){var u=this;if(a.length&&n)throw new Error("If in virtual select all mode, rowKeysToActOn should be empty.");if(t.length&&!n)throw new Error("If not in virtual select all mode, exclusionList should be empty.");var s=c.tableQuery.folderId,d=Ae.o.folderTable.get(s),f=n&&d&&d.UnreadCount>=ge.b||Object(i.q)(c)&&a.length>=ge.b,l=Object(i.o)(Object(i.l)(c),Object(i.p)(c.id),c.tableQuery.type,d&&Object(Ae.v)(d)),b=o?Object(me.a)(fe.a):Object(me.a)(le.a),m=o?Object(me.b)(Object(me.a)(de.a),l):Object(me.b)(Object(me.a)(de.b),l);Object(Oe.b)(b,m,!f,{delayCallbackAfterAnimation:!0,okText:Object(me.a)(be.a)}).then(function(d){return Object(r.__awaiter)(u,void 0,void 0,function(){var u,f,l;return Object(r.__generator)(this,function(r){if(d===Oe.a.ok)if(_e.b(),n)u=Object(v.a)().UserOptions.ReadReceipt,f="DoNotAutomaticallySend"==u||"NeverSend"==u||Object(ye.a)(s),l=Object(i.K)(s)?Object(Se.m)(i.N.inboxPausedDateTime):null,function(e,t,n){var r="TnS_MarkAllAs";r+=t?"Read":"Unread",Object(Me.o)(r,[e,Object(i.l)(n)])}(e,o,c),M.a.import().then(function(t){t(c.tableQuery,!0,o,e)}),Object(we.raiseAction)(ve.e.MarkAllAsReadStoreUpdate)(c,o,t),function(e,t,n,r,i,o){var a=null!=n?n.map(function(e){return I()({Id:e})}):void 0;he()({Header:Object(_.getJsonRequestHeader)(),Body:je()({ReadFlag:t,SuppressReadReceipts:r,FromFilter:null,FolderIds:[e],ItemIdsToExclude:a,ClientLastSyncTime:o&&o.toISOString()})},i).then(function(e){return e.Body.ResponseMessages.Items[0]})}(Object(i.j)(c),o,t,f,Object(P.b)(c).requestOptions,l);else switch(c.tableQuery.listViewType){case 0:oe(a,c,o,e);break;case 1:ae(a,c,o,!0,e)}return[2]})})})});var Pe=n(888),ke=Object(c.action)("setAutoMarkAsReadTimer")(Object(c.select)({markAsReadDelaytime:function(){return Object(v.a)().UserOptions.MarkAsReadDelaytime},store:function(){return s},userOptions:function(){return Object(v.a)().UserOptions}})(function(e,t,n){var r=Object(Pe.a)();if(r&&Object(i.f)(r)){var o=n.markAsReadDelaytime,a=n.store;"Delayed"==n.userOptions.PreviewMarkAsRead&&(a.markAsReadTimerTask=setTimeout(function(){Te(e,r,t)},1e3*o))}})),Ce=Object(c.action)("clearAutoMarkAsReadTimer")(Object(c.select)({store:function(){return s}})(function(e){e.store.markAsReadTimerTask&&(clearTimeout(e.store.markAsReadTimerTask),e.store.markAsReadTimerTask=null)})),Te=Object(c.action)("setMarkAsReadTimer:timeout")(function(e,t,n){if(Ce(),n)F(e,t);else switch(t.tableQuery.listViewType){case 0:X(e,t);break;case 1:F(e,t)}}),xe=n(4908),Ee=(Object(u.orchestrator)(ne,function(e){var t=Object(xe.a)(e.nodeIds),n=i.N.tableViews.get(e.tableViewId);x(n,t,e.isReadValueToSet,e.isExplicit,e.actionSource,null)}),n(790)),Fe=n(2221),Ue=n(2260);Object(u.orchestrator)(Ee.q,function(e){var t=Object(Fe.b)(e.nodeIdToSelect);t&&(Ue.a.importAndExecute(),Ue.i.importAndExecute(t.ItemId.Id,!0))}),n.d(t,"onItemPartDeselected",function(){return U}),n.d(t,"onReadingPaneClosed",function(){return ee}),n.d(t,"onSingleSelectionChanged",function(){return te}),n.d(t,"markItemsAsReadBasedOnNodeIds",function(){return ne}),n.d(t,"markItemAsReadFromReadingPane",function(){return re}),n.d(t,"toggleRowReadState",function(){return ue}),n.d(t,"onNavigateAwayViaUpDown",function(){return se}),n.d(t,"markAsReadInTable",function(){return Re}),n.d(t,"clearAutoMarkAsReadTimer",function(){return Ce}),n.d(t,"setAutoMarkAsReadTimer",function(){return ke})},834:function(e,t,n){"use strict";var r=n(1209),i=n(755);function o(){return Object(r.a)(Object(i.B)())}n.d(t,"b",function(){return r.a}),n.d(t,"c",function(){return r.c}),n.d(t,"a",function(){return o})},929:function(e,t,n){"use strict";var r={};n.r(r),n.d(r,"add",function(){return s}),n.d(r,"remove",function(){return d}),n.d(r,"removeAll",function(){return f}),n.d(r,"getCount",function(){return l}),n.d(r,"getTombstonedReasons",function(){return b}),n.d(r,"clearMapForFolder",function(){return m}),n.d(r,"removeRowsFromTombstone",function(){return v});var i=n(0),o=n(2),a=Object(o.createStore)("tombstone",{folderTombstoneMap:{}}),c=(a(),n(228)),u=n(43),s=Object(u.action)("tombstoneOperations.add")(function(e,t,n){var r=a().folderTombstoneMap;t in r||(r[t]={});var i=r[t];e.forEach(function(e){var t=i[e];t?3!=n?t.indexOf(3)>-1||-1==t.indexOf(n)&&t.push(n):i[e]=[3]:i[e]=[n]})}),d=Object(u.action)("tombstoneOperations.remove")(function(e,t,n){var r=a().folderTombstoneMap;if(t in r){var i=r[t],o=i[e],c=o?o.indexOf(n):-1;if(-1==c)throw new Error("tombstone.remove given reason does not exist when trying to remove entry from it");o.splice(c,1),0==o.length&&delete i[e],0==Object.keys(i).length&&delete r[t]}}),f=Object(u.action)("tombstoneOperations.removeAll")(function(){a().folderTombstoneMap={},Object(c.p)("TnS_RemoveAllFromTombstone")}),l=function(e,t){var n=a().folderTombstoneMap;if(!(e in n))return 0;var r=0,i=n[e];return Object.values(i).forEach(function(e){e==t&&r++}),r},b=function(e,t){var n=a().folderTombstoneMap;if(t in n){var r=n[t][e];if(r)return r}return[]},m=Object(u.action)("tombstoneOperations.clearMapForFolder")(function(e){var t=a().folderTombstoneMap;t[e]&&(Object(c.p)("TnS_ClearFolderMapInTombstone",[Object.keys(t[e]).length]),delete t[e])}),v=Object(u.action)("tombstoneOperations.removeRowsFromTombstone")(function(e,t){var n,r,o=a().folderTombstoneMap;if(t in o){var c=o[t];try{for(var u=Object(i.__values)(e),s=u.next();!s.done;s=u.next()){var d=s.value;d in c&&delete c[d]}}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}0==Object.keys(c).length&&delete o[t]}});t.a=r}},0,[2,8,11,22,334,5,39,88,350,6,7,9,10,128,0,1,532,182,13,46,124,531,178,23,119,318,501]]);
//# sourceMappingURL=owa.MarkRead.js.map
self.scriptsLoaded['owa.MarkRead.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MarkRead.js'] = (new Date()).getTime();