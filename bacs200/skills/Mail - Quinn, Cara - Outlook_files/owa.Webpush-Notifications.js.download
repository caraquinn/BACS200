self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.Webpush-Notifications.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[470],{1018:function(e,t,n){"use strict";var r,i=n(826),a=n(1277),o=n(2);t.a=Object(o.createStore)("owsOptionsStore",{options:(r={},r[i.a.SmartSuggestions]={feature:i.a.SmartSuggestions,smartSuggestionsEnabled:!1,browserLocationEnabled:!1},r[i.a.DiverseEmojis]={feature:i.a.DiverseEmojis,diverseEmojisSelectedSkinTone:""},r[i.a.SurfaceActions]={feature:i.a.SurfaceActions,readSurfaceActions:[],readSurfaceAddins:[],composeSurfaceActions:[],composeSurfaceAddins:[]},r[i.a.SkypeNotifications]={feature:i.a.SkypeNotifications,skypeMessageNotification:1,skypeCallingNotification:1},r[i.a.WebPushNotifications]={feature:i.a.WebPushNotifications,enabled:!1,applicationServerKey:null},r[i.a.Confetti]={feature:i.a.Confetti,confettiEnabled:!1},r[i.a.GdprAdsPrefs]={feature:i.a.GdprAdsPrefs,consentString:null,allowStorageAndAccess:!1,allowPersonalization:!1,allowAdSelectionDeliveryReporting:!1,allowContentSelectionDeliveryReporting:!1,allowMeasurement:!1},r[i.a.CalendarSurfaceAddins]={feature:i.a.CalendarSurfaceAddins,calendarSurfaceAddins:[]},r[i.a.ExternalImages]={feature:i.a.ExternalImages,externalImagesSelectedOption:null},r[i.a.EventCapture]={autoCollectionEnabled:!1},r[i.a.LinkedInBindingDismissed]={linkedInBindingDismissedInPeoplePicker:!1},r[i.a.Translation]={feature:i.a.Translation,translationMode:0,targetLanguage:"",excludedLanguages:[]},r[i.a.CalendarSurfaceOptions]={feature:i.a.CalendarSurfaceOptions,agendaPaneIsClosed:!0},r[i.a.MentionEventNotifications]={feature:i.a.MentionEventNotifications,enabled:!1},r[i.a.TxpEventNotifications]={feature:i.a.TxpEventNotifications,enabled:!1},r[i.a.ComposeAssistance]={feature:i.a.ComposeAssistance,composeAssistanceEnabled:!1},r[i.a.AmpDeveloper]={feature:i.a.AmpDeveloper,enabled:!0,allowedSender:[]},r[i.a.ActivityFeed]={feature:i.a.ActivityFeed,OWASurfaceOptions:{SupportedTypes:[],DisabledInFeedPanel:[]}},r),loadState:a.a.OptionsNotLoaded})},10194:function(e){e.exports={b:"K2b",a:"L2b"}},10195:function(e){e.exports={a:"J2b"}},10196:function(e,t,n){var r=n(10197),i=n(58);"string"==typeof r&&(r=[[e.i,r]]);for(var a=0;a<r.length;a++)i.loadStyles(r[a][1],!1);r.locals&&(e.exports=r.locals)},10197:function(e,t,n){(t=e.exports=n(57)(!1)).push([e.i,'._3Nh1RghPRfwEx0Sqrbjbxw{width:100%;height:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center}._3Nh1RghPRfwEx0Sqrbjbxw ._1pdzWK5O1uKIvRUsQn8WFs{font-size:28px;color:"[theme:themeTertiary, default:#71AFE5]";display:block}._3Nh1RghPRfwEx0Sqrbjbxw ._2bISyLhs73QMqCU2OKSPmA{font-size:28px;font-weight:600;color:"[theme:white, default:#ffffff]"}html[dir] ._3Nh1RghPRfwEx0Sqrbjbxw ._2bISyLhs73QMqCU2OKSPmA{margin:12px}',""]),t.locals={guidance:"_3Nh1RghPRfwEx0Sqrbjbxw",chevron:"_1pdzWK5O1uKIvRUsQn8WFs",message:"_2bISyLhs73QMqCU2OKSPmA"}},10198:function(e){e.exports={d:"S2b",c:"T2b",b:"U2b",a:"V2b"}},10199:function(e){e.exports={d:"l3b",c:"m3b",b:"n3b",a:"o3b"}},10200:function(e){e.exports={a:"$2b",c:"a3b",d:"b3b",e:"c3b",f:"d3b",b:"e3b"}},10201:function(e,t,n){var r=n(10202),i=n(58);"string"==typeof r&&(r=[[e.i,r]]);for(var a=0;a<r.length;a++)i.loadStyles(r[a][1],!1);r.locals&&(e.exports=r.locals)},10202:function(e,t,n){(t=e.exports=n(57)(!1)).push([e.i,'._3GeI89kYFNNTZR9qxOSBuA{list-style-type:none;counter-reset:step-number}html[dir] ._3GeI89kYFNNTZR9qxOSBuA{padding:0}._3qD0MIysJo7zNpGyrbh4nu{-webkit-box-pack:start;-ms-flex-pack:start;justify-content:flex-start;font-size:14px}._3qD0MIysJo7zNpGyrbh4nu,._3qD0MIysJo7zNpGyrbh4nu:before{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}._3qD0MIysJo7zNpGyrbh4nu:before{-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;width:32px;height:32px;font-size:17px;color:"[theme:neutralPrimary, default:#333333]";counter-increment:step-number;content:counter(step-number)}html[dir] ._3qD0MIysJo7zNpGyrbh4nu:before{border-radius:50%;background-color:"[theme:neutralLight, default:#eaeaea]"}html[dir=ltr] ._3qD0MIysJo7zNpGyrbh4nu:before{margin-right:12px}html[dir=rtl] ._3qD0MIysJo7zNpGyrbh4nu:before{margin-left:12px}html[dir] ._3qD0MIysJo7zNpGyrbh4nu+._3qD0MIysJo7zNpGyrbh4nu{margin-top:20px}._2b7MIFUhWdiraFO55eVlnp{max-width:unset}',""]),t.locals={steps:"_3GeI89kYFNNTZR9qxOSBuA",step:"_3qD0MIysJo7zNpGyrbh4nu",dialogContainer:"_2b7MIFUhWdiraFO55eVlnp"}},10203:function(e){e.exports={a:"P2b",c:"Q2b",b:"R2b"}},10204:function(e){e.exports={b:"M2b",c:"N2b",a:"O2b"}},1024:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(1018);function i(e){return Object(r.a)().options[e]}},1054:function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"b",function(){return o});var r=n(2),i=n(6),a=Object(r.createStore)("lightningState",{unseenItems:new i.ObservableMap,lightedCount:0,lastShownId:null}),o=a()},1055:function(e,t,n){"use strict";var r=n(22),i=n(1054),a=new r.c(function(){return n.e(300).then(n.bind(null,13832))}),o=new r.a(a,function(e){return e.beginLightningImp}),s=new r.a(a,function(e){return e.endLightningImp});function c(e){var t=e.prototype.render;e.prototype.render=function(){if(i.b.unseenItems){var e=i.b.unseenItems.get(this.props.lid);if(e&&e.visible)return t.call(this,arguments)}return null};var n=e.prototype.componentDidMount;e.prototype.componentDidMount=function(){n&&n.call(this,arguments),o.importAndExecute(this.props.lid,this.props.when,this.props.series)};var r=e.prototype.componentWillUnmount;return e.prototype.componentWillUnmount=function(){r&&r.call(this,arguments),s.importAndExecute(this.props.lid)},e}function u(e,t){s.importAndExecute(e,t)}var l,d=new(n(1169).a);!function(e){e.UserVoiceSatisfactionFirstRun="0",e.UserVoiceSatisfactionSecondRun="1",e.ConsumerRefreshFRE="2",e.AnimatedConsumerRefreshFRE="3",e.AnimatedConsumerRefreshFRE2="4",e.SettingPanelFirstRunCallout="5",e.SettingIconFirstRunCallout="6",e.AddStorageAccountCallout="7",e.PremiumDomainConnectModal="8",e.WhatsNewFlexPane="10",e.FocusOtherOff="12",e.TargetedAdsGdprPrompt="13",e.WebPushPromotion="14",e.MailGraduatedNewFeatureCarousel="15",e.EdgePromotion="20",e.ActionableMessageTeachingUiTeachingBubblePolicy="21",e.GetStartedFlexPane="22",e.CalendarSurvey="23",e.EnterpriseOptInFRE="24",e.MiniUserSurveyV1="25",e.TodoCalendarFRE="26",e.TodoMailFRE="27",e.GroupFilesHubFRE="28",e.AddCloudCacheAccountCallout="29",e.NewConsumerRecruitmentCampaign="30",e.InboxPlusFRE="31",e.BusinessCutoverCarousel="32",e.SuiteNps="33"}(l||(l={})),n.d(t,"d",function(){return c}),n.d(t,"e",function(){return u}),n.d(t,"c",function(){return d}),n.d(t,"b",function(){return"SettingPanelFirstRunCalloutDismissed"}),n.d(t,"a",function(){return l})},1277:function(e,t,n){"use strict";var r;n.d(t,"a",function(){return r}),function(e){e[e.OptionsNotLoaded=0]="OptionsNotLoaded",e[e.OptionsLoading=1]="OptionsLoading",e[e.OptionsLoaded=2]="OptionsLoaded"}(r||(r={}))},1295:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(2),i=n(912),a=Object(r.action)("APPLY_DEFAULT_OPTIONS_ON_LOAD_FAIL",function(e){return void 0===e&&(e=Object(i.a)()),{defaultOptions:e}})},174:function(e,t,n){"use strict";n.d(t,"d",function(){return a}),n.d(t,"c",function(){return o}),n.d(t,"e",function(){return s}),n.d(t,"b",function(){return c}),n.d(t,"a",function(){return u});var r=n(22),i=(n(280),new r.c(function(){return n.e(362).then(n.bind(null,697))})),a=(new r.a(i,function(e){return e.makeOwsPrimeRequest}).importAndExecute,new r.a(i,function(e){return e.makePostRequest}).importAndExecute),o=new r.a(i,function(e){return e.makePatchRequest}).importAndExecute,s=new r.a(i,function(e){return e.makePutRequest}).importAndExecute,c=new r.a(i,function(e){return e.makeGetRequest}).importAndExecute,u=new r.a(i,function(e){return e.makeDeleteRequest}).importAndExecute},280:function(e,t,n){"use strict";n.d(t,"b",function(){return r}),n.d(t,"a",function(){return i});var r="owsserver",i="owsapi"},3720:function(e,t,n){"use strict";n.r(t);var r=n(1420),i=n(2),a=Object(i.action)("setWebPushPermission",function(e){return{permission:e}}),o=(Object(i.mutator)(a,function(e){var t=e.permission;r.c.webPushPermission=t}),Object(i.action)("showEnableWebPushCallout")),s=Object(i.action)("completeEnableWebPushCallout",function(e){return{result:e}}),c=Object(i.action)("showManualNotificationPermissionsPrompt"),u=Object(i.action)("completeManualNotificationPermissionsPrompt",function(e){return{permission:e}}),l=Object(i.action)("showNotificationPermissionsOverlay"),d=Object(i.action)("completeNotificationPermissionsOverlay"),b=Object(i.action)("showWebPushSecondChanceCallout"),f=Object(i.action)("completeWebPushSecondChanceCallout",function(e){return{tryAgain:e}}),p=Object(i.action)("showWebPushSuccessCallout"),m=Object(i.action)("dismissWebPushSuccessCallout"),h=(Object(i.mutator)(o,function(){return h(1)}),Object(i.mutator)(s,function(){return O(1)}),Object(i.mutator)(l,function(){return h(2)}),Object(i.mutator)(d,function(){return O(2)}),Object(i.mutator)(c,function(){return h(3)}),Object(i.mutator)(u,function(){return O(3)}),Object(i.mutator)(b,function(){return h(5)}),Object(i.mutator)(f,function(){return O(5)}),Object(i.mutator)(p,function(){return h(4)}),Object(i.mutator)(m,function(){return O(4)}),function(e){r.c.currentView=e}),O=function(e){r.c.currentView===e&&(r.c.currentView=0)},g=Object(i.action)("UPDATE_WEBPUSH_OPTIONS",function(e,t){return{enabled:e,enabledTimeInUTCMs:t}}),v=n(794),j=(Object(i.mutator)(g,function(e){var t=e.enabled,n=e.enabledTimeInUTCMs,r=Object(v.c)(v.a.WebPushNotifications);r.enabled=t,r.enabledTimeInUTCMs=n}),n(0)),w=n(60),S=n(1598),_=Object(i.action)("completeWebPushLightningCallout",function(e){return{enabled:e}}),y=n(1323),P=(Object(i.orchestrator)(_,function(e){var t=e.enabled;t?Object(y.b)("lightning"):Object(y.c)(),P(t,!0)}),Object(i.orchestrator)(f,function(e){var t=e.tryAgain;return P(t,!1)}),function(e,t){return Object(j.__awaiter)(void 0,void 0,void 0,function(){var n,r,i;return Object(j.__generator)(this,function(a){switch(a.label){case 0:return e?[4,S.h.import()]:[3,7];case 1:return n=a.sent(),[4,S.e.import()];case 2:return[4,a.sent()()];case 3:return(r=a.sent()).enabled?[3,5]:(g(!0,Date.now().toString()),[4,v.d.importAndExecute(v.a.WebPushNotifications,r)]);case 4:a.sent(),a.label=5;case 5:return[4,n(window,r,Object(w.a)().SessionSettings.MailboxGuid,t)];case 6:i=a.sent(),Object(y.f)(i),a.label=7;case 7:return[2]}})})}),E=n(3),A=n(174),x="ows/beta/webpushsubscriptions/delete";function C(e,t){var n={endpoint:e,clientId:t};return Object(A.d)(x,n).then(function(e){if(!0===e.unregistered)return Promise.resolve(!0);throw new Error("Failed to unregister endpoint.")})}var k=n(25),N=n(804);var I=n(5),D="sw_webpush.js",W="/webpush/";function F(e){return Object(j.__awaiter)(this,void 0,void 0,function(){var t,n,r;return Object(j.__generator)(this,function(i){var a,o,s;return a=e.location,o=null,(s=a.pathname.split("/")).length>=2&&""!=s[1]&&(o=s[1].toLowerCase()),t=function(e,t){var n=e;return null!=e&&(n=Object(N.k)("/"+e,t.pathname)),n}(o,e.location),n=null!=t?t+"/"+D:"/"+D,r={scope:W},["branch","ring","version"].some(function(e){return!!Object(I.d)(e)&&(n+="?"+e+"="+Object(I.a)(e),!0)}),[2,e.navigator.serviceWorker.register(n,r).then(function(e){var t=null;return null!=e.installing?t=e.installing:null!=e.waiting?t=e.waiting:null!=e.active&&(t=e.active),"activated"==t.state?e:new Promise(function(n,r){t.onstatechange=function(){if("activated"==t.state)return t.onstatechange=null,n(e)}})}).then(function(e){return e.update().then(function(){return e})}).catch(function(e){throw k.d.warn("[WebPush] Service worker registraiton failed, error: "+e.message),e})]})})}function T(e){return Object(j.__awaiter)(this,void 0,void 0,function(){var t,n,r,i;return Object(j.__generator)(this,function(a){switch(a.label){case 0:return[4,e.navigator.serviceWorker.getRegistrations()];case 1:for(t=a.sent(),n=null,r=e.location.origin+W,i=0;i<t.length;++i)if(t[i].scope.toLowerCase()==r){n=t[i];break}return[2,n]}})})}function M(e){return Object(j.__awaiter)(this,void 0,void 0,function(){var t,n,r;return Object(j.__generator)(this,function(i){switch(i.label){case 0:return t=null,[4,T(e)];case 1:return null==(n=i.sent())?[3,6]:[4,n.pushManager.getSubscription()];case 2:return null==(r=i.sent())?[3,4]:(t=r.endpoint,[4,r.unsubscribe()]);case 3:i.sent()||k.d.warn("[WebPush] Failed to unsubscribe."),i.label=4;case 4:return[4,n.unregister()];case 5:i.sent(),i.label=6;case 6:return[2,t]}})})}function R(e){return Object(j.__awaiter)(this,void 0,void 0,function(){var t,n,r;return Object(j.__generator)(this,function(i){switch(i.label){case 0:return[4,M(e)];case 1:return t=i.sent(),n=!0,t?(r=Object(E.e)(),[4,C(t,r)]):[3,3];case 2:n=i.sent(),i.label=3;case 3:return[2,n]}})})}var L="ows/beta/webpushsubscriptions";function q(){return Object(j.__awaiter)(this,void 0,void 0,function(){return Object(j.__generator)(this,function(e){return[2,Object(A.b)(L).then(function(e){if(e.subscriptions)return e.subscriptions;throw new Error("Failed to load web push subscriptions")})]})})}var G="ows/beta/webpushsubscriptions";function U(e){return Object(j.__awaiter)(this,void 0,void 0,function(){return Object(j.__generator)(this,function(t){return[2,Object(A.d)(G,e).then(function(e){if(!0===e.registered)return Promise.resolve(!0);throw new Error("Failed to register endpoint.")})]})})}function B(e,t,n){return Object(j.__awaiter)(this,void 0,void 0,function(){var r,i,a;return Object(j.__generator)(this,function(o){switch(o.label){case 0:return r=function(e,t){for(var n=(4-e.length%4)%4,r="",i=0;i<n;i++)r+="=";var a=(e+r).replace(/\-/g,"+").replace(/_/g,"/"),o=t.atob(a),s=new Uint8Array(o.length);for(i=0;i<o.length;++i)s[i]=o.charCodeAt(i);return s}(t.applicationServerKey,n),[4,e.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:r})];case 1:return i=o.sent(),(a=i.toJSON()).clientId=Object(E.e)(),[4,U(a)];case 2:return[2,o.sent()]}})})}function z(e,t){return Object(j.__awaiter)(this,void 0,void 0,function(){var n,r,i,a,o,s,c;return Object(j.__generator)(this,function(u){switch(u.label){case 0:return[4,F(t)];case 1:return[4,(n=u.sent()).pushManager.getSubscription()];case 2:return r=u.sent(),i=!1,null!=r?[3,4]:[4,B(n,e,t)];case 3:return i=u.sent(),[3,11];case 4:return[4,q()];case 5:for(a=u.sent(),o=!1,s=0;s<a.length;++s)if(a[s].endpoint==r.endpoint){o=!0;break}return o?((c=r.toJSON()).clientId=Object(E.e)(),[4,U(c)]):[3,7];case 6:return u.sent(),i=!0,[3,11];case 7:return k.d.warn("[WebPush] Orphaned subsciption found, unsubscribing."),[4,r.unsubscribe()];case 8:return u.sent()?[4,B(n,e,t)]:[3,10];case 9:return i=u.sent(),[3,11];case 10:k.d.warn("[WebPush] Failed to unsubscribe."),u.label=11;case 11:return[2,i]}})})}var J=n(1817),K=-1;function V(e){return e.Notification.permission}function H(e){return Object(j.__awaiter)(this,void 0,void 0,function(){return Object(j.__generator)(this,function(t){return[2,e.Notification.requestPermission()]})})}function Q(e){return Object(j.__awaiter)(this,void 0,void 0,function(){var t,n;return Object(j.__generator)(this,function(r){switch(r.label){case 0:return t=V(e),n=t,"default"!=t?[3,2]:(l(),[4,H(e)]);case 1:return n=r.sent(),d(),[3,5];case 2:return"denied"!=t?[3,5]:(c(),function(e){var t=V(e);a(t),K=e.setInterval(function(){var n=V(e);n!==t&&(a(n),t=n)},1e3)}(e),[4,new Promise(function(t,n){Object(i.orchestrator)(u,function(n){var r=n.permission;!function(e){-1!==K&&(e.clearInterval(K),K=-1)}(e),t(r)})})]);case 3:return"default"!==(n=r.sent())?[3,5]:[4,H(e)];case 4:n=r.sent(),r.label=5;case 5:return[2,n]}})})}function Y(){return Object(j.__awaiter)(this,void 0,void 0,function(){return Object(j.__generator)(this,function(e){return[2,new Promise(function(e){Object(i.orchestrator)(s,function(t){var n=t.result;e(n)}),o()})]})})}var Z=n(10194),$=n(4),X="ows/api/webpushsetupacknowledge/processItem";function ee(e){return Object(j.__awaiter)(this,void 0,void 0,function(){var t;return Object(j.__generator)(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,Object(A.d)(X,e)];case 1:return n.sent(),[3,3];case 2:return t=n.sent(),k.d.error("Error while web push setup ack, error: "+t),[3,3];case 3:return[2,Promise.resolve(!0)]}})})}function te(e){return Object(j.__awaiter)(this,void 0,void 0,function(){var t,n,r;return Object(j.__generator)(this,function(i){switch(i.label){case 0:return[4,F(e)];case 1:return null==(t=i.sent())?[3,4]:[4,t.pushManager.getSubscription()];case 2:return null==(n=i.sent())?[3,4]:((r=n.toJSON()).clientId=Object(E.e)(),r.title=Object($.a)(Z.b),r.body=Object($.a)(Z.a),[4,ee(r)]);case 3:i.sent(),i.label=4;case 4:return[2]}})})}var ne=n(1848);function re(e,t,n,r){return void 0===r&&(r=!1),Object(j.__awaiter)(this,void 0,void 0,function(){var i,a;return Object(j.__generator)(this,function(o){switch(o.label){case 0:return i=Object(J.a)(n,t),[4,ie(e,t,i,r)];case 1:return(a=o.sent())?[4,te(e)]:[3,3];case 2:o.sent(),p(),o.label=3;case 3:return[2,a]}})})}function ie(e,t,n,r){return Object(j.__awaiter)(this,void 0,void 0,function(){var i,a;return Object(j.__generator)(this,function(o){switch(o.label){case 0:return i=!1,Object(ne.g)(e,!0,n),[4,Q(e)];case 1:return"granted"!=(a=o.sent())?[3,3]:[4,z(t,e)];case 2:return i=o.sent(),[3,5];case 3:return"denied"==a&&Object(ne.g)(e,!1,n),[4,R(e)];case 4:o.sent(),o.label=5;case 5:return Object(y.d)(a),"default"!=a&&Object(ne.e)(e),!i&&r&&b(),[2,i]}})})}function ae(){return Object(j.__awaiter)(this,void 0,void 0,function(){var e;return Object(j.__generator)(this,function(t){switch(t.label){case 0:return[4,v.e.import()];case 1:return[4,t.sent()(v.a.WebPushNotifications)];case 2:if(null==(e=t.sent()))throw new Error("Failed to load web push options.");return[2,e]}})})}function oe(e){return Object(j.__awaiter)(this,void 0,void 0,function(){var t,n,i;return Object(j.__generator)(this,function(a){switch(a.label){case 0:return null==e.navigator.serviceWorker||null==e.PushManager?[2]:[4,ae()];case 1:if(null==(t=a.sent()))return k.d.warn("[WebPush] WebPushNotificationsOptions not loaded."),[2];n=Object(w.a)().SessionSettings.MailboxGuid,i=Object(J.a)(n,t),Object(ne.d)(e,i),Object(ne.c)(e);try{t.enabled?function(e,t,n){Object(j.__awaiter)(this,void 0,void 0,function(){var i,a,o,s,c;return Object(j.__generator)(this,function(u){switch(u.label){case 0:return i=Object(J.a)(n,t),(a=Object(r.a)().enabled)?[4,ie(e,t,i,!1)]:[3,2];case 1:return u.sent(),[3,7];case 2:return Object(ne.f)(e)?(Object(ne.b)(e),[4,Y()]):[3,7];case 3:return o=u.sent(),Object(y.e)(o),0!==o?[3,5]:(Object(y.b)("roaming"),[4,re(e,t,n,!0)]);case 4:return s=u.sent(),Object(y.f)(s),[3,6];case 5:1===o&&(Object(y.a)("roaming",!1),Object(ne.g)(e,!1,i)),u.label=6;case 6:a=0===o,u.label=7;case 7:return a?[3,9]:[4,R(e)];case 8:c=u.sent(),Object(y.f)(c),u.label=9;case 9:return[2]}})})}(e,t,n):R(e)}catch(e){k.d.error("[WebPush] Failed to initialize web push notifications, error: "+e)}return[2]}})})}function se(e,t,n,r){return Object(j.__awaiter)(this,void 0,void 0,function(){var i;return Object(j.__generator)(this,function(a){return i=Object(J.a)(n,t),r?Object(ne.a)(e,i):Object(ne.g)(e,!1,i),[2,R(e)]})})}var ce=n(1900),ue=3;function le(e,t){var n=!1;return Object(ce.a)(e)&&null==t.enabledTimeInUTCMs&&(n=Object(r.a)().uniqueDaysSessionCount>=ue),n}var de=n(10195),be=n(19),fe=n(351),pe=n(750),me=n(684),he=n(1),Oe=n(10196),ge=Object(be.a)(function(e){return he.createElement(pe.a,null,he.createElement(me.a,{isDarkThemed:!0,onClick:d},he.createElement("div",{className:Oe.guidance},he.createElement(fe.a,{iconName:"ChevronUp",className:Oe.chevron}),he.createElement("div",{className:Oe.message},Object($.a)(de.a)))),",")}),ve=n(10198),je=n(271),we=n(86),Se=n(4232),_e=Object(be.a)(function(e){var t={buttonType:je.a.primary,children:Object($.a)(ve.d),onClick:function(){return s(0)}},n={buttonType:je.a.normal,children:Object($.a)(ve.c),onClick:function(){return s(1)}};return he.createElement(Se.a,{calloutProps:{beakWidth:15,directionalHint:we.a.bottomAutoEdge,preventDismissOnLostFocus:!0,preventDismissOnScroll:!0},targetElement:e.target(),hasCloseIcon:!0,onDismiss:function(){return s(2)},hasSmallHeadline:!0,isWide:!0,headline:Object($.a)(ve.b),primaryButtonProps:t,secondaryButtonProps:n},Object($.a)(ve.a))}),ye=n(10199),Pe=n(173),Ee=n(1055),Ae=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.dismiss=function(e){Object(Ee.e)(t.props.lid,e?"Primary":"Secondary"),_(e)},t}return Object(j.__extends)(t,e),t.prototype.render=function(){var e=this,t={buttonType:je.a.primary,children:Object($.a)(ye.d),onClick:function(){return e.dismiss(!0)}},n={buttonType:je.a.primary,children:Object($.a)(ye.c),onClick:function(){return e.dismiss(!1)}};return he.createElement(Se.a,{calloutProps:{beakWidth:15,directionalHint:we.a.bottomAutoEdge,preventDismissOnLostFocus:!0,preventDismissOnScroll:!0},targetElement:this.props.target(),hasCloseIcon:!0,onDismiss:function(){return e.dismiss(!1)},hasSmallHeadline:!0,isWide:!0,headline:Object($.a)(ye.b),primaryButtonProps:t,secondaryButtonProps:n},Object($.a)(ye.a))},t=Object(j.__decorate)([Pe.observer,Ee.d],t)}(he.Component),xe=function(e){return Object(j.__awaiter)(void 0,void 0,void 0,function(){var t,n;return Object(j.__generator)(this,function(r){switch(r.label){case 0:return t=le,n=[window],[4,ae()];case 1:return t.apply(void 0,n.concat([r.sent()]))&&e(),[2]}})})},Ce=Object(be.a)(function(e){return he.createElement(Ae,{lid:Ee.a.WebPushPromotion,when:xe,target:e.target})}),ke=n(10200),Ne=n(390),Ie=n(691),De=n(379),We=n(10201),Fe=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.steps=function(e){return he.createElement("ol",{className:We.steps},e.map(t.step))},t}return Object(j.__extends)(t,e),t.prototype.step=function(e,t){return he.createElement("li",{className:We.step,key:t},e)},t.prototype.render=function(){return he.createElement(pe.a,null,he.createElement(Ie.a,{dialogContentProps:{showCloseButton:!0,title:Object($.a)(ke.a)},modalProps:{isBlocking:!0,isDarkOverlay:!0,containerClassName:We.dialogContainer},hidden:!1,onDismiss:this.dismiss},this.steps([Object($.a)(ke.c),Object($.a)(ke.d),Object($.a)(ke.e),Object($.a)(ke.f)]),he.createElement(De.a,null,he.createElement(Ne.a,{onClick:this.dismiss,text:Object($.a)(ke.b),disabled:!r.c||"denied"===r.c.webPushPermission}))))},t.prototype.dismiss=function(){u(window.Notification.permission)},t=Object(j.__decorate)([Pe.observer],t)}(he.Component),Te=n(10203),Me=Object(be.a)(function(e){var t={buttonType:je.a.primary,children:Object($.a)(Te.a),onClick:function(){return f(!0)}};return he.createElement(Se.a,{calloutProps:{beakWidth:15,directionalHint:we.a.bottomAutoEdge,preventDismissOnLostFocus:!0,preventDismissOnScroll:!0},targetElement:e.target(),hasCloseIcon:!0,onDismiss:function(){return f(!1)},hasSmallHeadline:!0,isWide:!0,headline:Object($.a)(Te.c),primaryButtonProps:t},Object($.a)(Te.b))}),Re=n(10204),Le=Object(be.a)(function(e){var t={buttonType:je.a.primary,children:Object($.a)(Re.b),onClick:m};return he.createElement(Se.a,{calloutProps:{beakWidth:15,directionalHint:we.a.bottomAutoEdge,preventDismissOnLostFocus:!0,preventDismissOnScroll:!0},targetElement:e.target(),hasCloseIcon:!0,onDismiss:m,hasSmallHeadline:!0,isWide:!0,headline:Object($.a)(Re.c),primaryButtonProps:t},Object($.a)(Re.a))}),qe=Object(be.a)(function(e){var t=null;switch(r.c.currentView){case 1:t=he.createElement(_e,{target:e.calloutTarget});break;case 3:t=he.createElement(Fe,null);break;case 2:t=he.createElement(ge,null);break;case 5:t=he.createElement(Me,{target:e.calloutTarget});break;case 4:t=he.createElement(Le,{target:e.calloutTarget})}return he.createElement("div",null,t,he.createElement(Ce,{target:e.calloutTarget}))});n.d(t,"bootStrapWebPushService",function(){return oe}),n.d(t,"userInitiatedWebPushSetupWorkflow",function(){return re}),n.d(t,"userInitiatedWebPushDisableWorkflow",function(){return se}),n.d(t,"shouldShowWebPushLightning",function(){return le}),n.d(t,"unsubscribe",function(){return M}),n.d(t,"loadWebPushOptions",function(){return ae}),n.d(t,"WebPushDiscovery",function(){return qe})},794:function(e,t,n){"use strict";var r=n(826),i=(function(){}(),n(22)),a=n(79),o=n(1295),s=n(1018),c=n(6),u=n(2),l=[r.a.SurfaceActions];Object(u.mutator)(o.a,function(e){var t=e.defaultOptions;l.forEach(function(e){t[e]&&Object(c.extendObservable)(Object(s.a)().options[e],t[e])})});var d=n(1024),b=n(912);n.d(t,"d",function(){return p}),n.d(t,"g",function(){return m}),n.d(t,"e",function(){return h}),n.d(t,"f",function(){return O}),n.d(t,"c",function(){return d.a}),n.d(t,"b",function(){return b.a}),n.d(t,"a",function(){return r.a});var f=new i.c(function(){return n.e(351).then(n.bind(null,13917))}),p=new i.a(f,function(e){return e.createOrUpdateOptionsForFeature}),m=new i.a(f,function(e){return e.updateAddinPinStatus}),h=new i.b(f,function(e){return e.getServerOptionsForFeature}),O=new i.a(f,function(e){return e.loadOptions});Object(a.c)(function(){O.importAndExecute()})},826:function(e,t,n){"use strict";var r;n.d(t,"a",function(){return r}),function(e){e[e.TestFeature=1]="TestFeature",e[e.SmartSuggestions=2]="SmartSuggestions",e[e.DiverseEmojis=4]="DiverseEmojis",e[e.SurfaceActions=5]="SurfaceActions",e[e.SkypeNotifications=6]="SkypeNotifications",e[e.WebPushNotifications=7]="WebPushNotifications",e[e.Confetti=8]="Confetti",e[e.GdprAdsPrefs=9]="GdprAdsPrefs",e[e.CalendarSurfaceAddins=10]="CalendarSurfaceAddins",e[e.ExternalImages=11]="ExternalImages",e[e.EventCapture=12]="EventCapture",e[e.LinkedInBindingDismissed=13]="LinkedInBindingDismissed",e[e.Translation=14]="Translation",e[e.CalendarSurfaceOptions=15]="CalendarSurfaceOptions",e[e.TxpEventNotifications=16]="TxpEventNotifications",e[e.MentionEventNotifications=17]="MentionEventNotifications",e[e.ComposeAssistance=18]="ComposeAssistance",e[e.ActivityFeed=19]="ActivityFeed",e[e.AmpDeveloper=20]="AmpDeveloper"}(r||(r={}))},912:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(276),i=n(826),a=n(105);function o(){var e;return(e={})[i.a.SmartSuggestions]={smartSuggestionsEnabled:!0,browserLocationEnabled:!1},e[i.a.DiverseEmojis]={diverseEmojisSelectedSkinTone:""},e[i.a.SurfaceActions]={readSurfaceActions:["Reply","ReplyAll","Forward"].concat(Object(r.a)()?[]:["LikeUnlike"]),readSurfaceAddins:[],composeSurfaceActions:["AddAttachment","AddInlineImage","AddEmoji","ToggleDictation","ToggleRibbon"],composeSurfaceAddins:[]},e[i.a.SkypeNotifications]={skypeMessageNotification:1,skypeCallingNotification:1},e[i.a.Confetti]={confettiEnabled:!0},e[i.a.ComposeAssistance]={composeAssistanceEnabled:!0},e[i.a.GdprAdsPrefs]={feature:i.a.GdprAdsPrefs,consentString:null,allowStorageAndAccess:!1,allowPersonalization:!1,allowAdSelectionDeliveryReporting:!1,allowContentSelectionDeliveryReporting:!1,allowMeasurement:!1},e[i.a.CalendarSurfaceAddins]={calendarSurfaceAddins:[]},e[i.a.ExternalImages]={externalImagesSelectedOption:0},e[i.a.EventCapture]={autoCollectionEnabled:!1},e[i.a.LinkedInBindingDismissed]={linkedInBindingDismissedInPeoplePicker:!1},e[i.a.Translation]={translationMode:0,targetLanguage:"",excludedLanguages:[]},e[i.a.CalendarSurfaceOptions]={agendaPaneIsClosed:!1},e[i.a.AmpDeveloper]={enabled:Object(a.e)("rp-ampDefault"),allowedSender:[]},e}}},0,[23,119]]);
//# sourceMappingURL=owa.Webpush-Notifications.js.map
self.scriptsLoaded['owa.Webpush-Notifications.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.Webpush-Notifications.js'] = (new Date()).getTime();