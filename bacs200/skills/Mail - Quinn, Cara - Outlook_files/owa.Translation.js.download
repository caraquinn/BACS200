self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.Translation.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[452],{9088:function(e,t,n){"use strict";n.r(t);var a="-",r=4;function u(e){if(0===(e=e.toLowerCase()).lastIndexOf("zh-",0))switch(e){case"zh-cht":case"zh-hant":case"zh-hk":case"zh-tw":return"zh-cht";default:return"zh-chs"}var t=e.indexOf(a,1);if(-1===t)return e;var n=e.indexOf(a,t+a.length);return-1===n&&(n=e.length),n-t==a.length+r&&(t=n),e.substring(0,t)}var o=n(2),s=n(760),i=Object(o.createStore)("TranslationStore",{sessionId:Object(s.a)(),localeOfSupportedLanguageMap:null,supportedLanguageMap:null,isUserLocaleSupported:!1,userLanguageName:null,userLanguageTag:null})();function c(e){return!!i.supportedLanguageMap&&i.supportedLanguageMap.has(e)}function g(e,t){void 0===t&&(t=null);var n=u(e);if(!c(n))return!1;if(null!=t){var a=u(t);return!!c(a)&&n!==a}return!0}var l=n(0),d=n(105),p=n(3911),f=n(3116),O=Object(o.mutatorAction)("setTargetLanguage",function(e,t){e.targetLanguage=t}),L=Object(o.mutatorAction)("setTranslationMode",function(e,t){e.translationMode=t});var h="https://ogma.osi.office.net",v="/TradukoApi/api/v1.0/translateContentArray",b="/TradukoApi/api/v1.0/supportedLanguages",T="/TradukoApi/api/v1.0/detectLanguage",j="ows/api/v1/translation/translateText",m="ows/api/v1/translation/getSupportedLanguages";function w(e){return m+"?clientLocale="+e}var M=n(3);function S(e,t){e.setRequestHeader("Content-type","application/json"),e.setRequestHeader("Accept","application/json, text/plain, */*"),e.setRequestHeader("x-translator-sid",i.sessionId),e.setRequestHeader("x-translator-cross-sid",i.sessionId),e.setRequestHeader("x-translator-cid",t),e.setRequestHeader("x-translator-user-id",Object(M.e)()),e.setRequestHeader("x-translator-client-version",Object(M.f)()),e.setRequestHeader("x-translator-client-app","Outlook"),e.setRequestHeader("x-translator-client-type","Browser")}function _(e){return{"x-translator-sid":i.sessionId,"x-translator-cross-sid":i.sessionId,"x-translator-cid":e,"x-translator-user-id":Object(M.e)(),"x-translator-client-version":Object(M.f)()}}var x=n(174),A=3e4;function G(e,t){return Object(l.__awaiter)(this,void 0,void 0,function(){return Object(l.__generator)(this,function(n){return[2,new Promise(function(n,a){Object(d.e)("rp-inlineTranslation-UseOWS")?function(e,t,n,a){Object(l.__awaiter)(this,void 0,void 0,function(){var r,o,s,i,c,g,d;return Object(l.__generator)(this,function(l){switch(l.label){case 0:r=_(t),o=u(e),s=!1,i=setTimeout(function(){s=!0,a("Request timed out")},A),l.label=1;case 1:return l.trys.push([1,3,,4]),[4,Object(x.b)(w(o),t,!1,r,!0)];case 2:return c=l.sent(),s||(clearTimeout(i),(g=y(c))?n(g):a("OWS OGMA returned invalid response: "+c)),[3,4];case 3:return d=l.sent(),a("getSupportedLanguagesOWS failed:"+d.message),[3,4];case 4:return[2]}})})}(e,t,n,a):function(e,t,n,a){var r=new XMLHttpRequest;r.timeout=A,r.onload=function(){if(200===r.status){var e=y(JSON.parse(this.responseText));e?n(e):a("OGMA returned invalid response: "+this.response)}else a("OGMA failed to retrieve supported languages: "+this.response)},r.onerror=function(){a("OGMA call failed: "+this.response)},r.ontimeout=function(){a("OGMA call timed out")};var o=u(e);r.open("GET",function(e){return""+h+b+"?clientLocale="+e}(o)),S(r,t),r.send()}(e,t,n,a)})]})})}function y(e){try{var t=new Map;return e.forEach(function(e){t.set(e.LanguageTag,e)}),t}catch(e){return null}}var E=n(60),I=Object(o.mutatorAction)("setSupportedLanguageMap",function(e,t){var n=u(e),a=t.get(n);a?(i.localeOfSupportedLanguageMap=e,i.userLanguageName=a.LanguageName,i.userLanguageTag=n,i.supportedLanguageMap=t,i.isUserLocaleSupported=g(e)):i.isUserLocaleSupported=!1}),R=n(228),q=15e3,N=0,H=q;function D(){return Object(l.__awaiter)(this,void 0,void 0,function(){var e,t,n,a,r,u,o;return Object(l.__generator)(this,function(g){switch(g.label){case 0:if(e=Object(E.a)().SessionSettings.UserCulture,t=Date.now(),l=Object(f.a)(),Object(d.e)("rp-inlineTranslationAutomatic")||l.translationMode!==p.a.Automatic||L(l,p.a.Suggest),Object(d.e)("rp-inlineTranslation-targetLanguage")||null===l.targetLanguage||O(l,null),e===i.localeOfSupportedLanguageMap||!(0===N||t>N+H))return[3,5];n=null,a=Object(s.a)(),r=new R.a("InlineTranslationGetSupportedLanguages"),g.label=1;case 1:return g.trys.push([1,3,,4]),[4,G(e,a)];case 2:return n=g.sent(),N=0,H=q,r.end(),[3,4];case 3:throw u=g.sent(),o=new Error("[InlineTranslation] getSupportedLanguages failed. Error:"+u+" | cid:"+a),N=t,H*=2,r.endWithError("ServerError",o),u;case 4:return I(e,n),function(){var e=Object(f.a)();null===e.targetLanguage||c(e.targetLanguage)||(e.targetLanguage=null)}(),[2,!0];case 5:return[2,!1]}var l})})}function U(){return Object(l.__awaiter)(this,void 0,void 0,function(){return Object(l.__generator)(this,function(e){switch(e.label){case 0:return[4,D()];case 1:return e.sent(),[2,i.supportedLanguageMap]}})})}function z(){return i.localeOfSupportedLanguageMap}function C(e,t){return Object(l.__awaiter)(this,void 0,void 0,function(){return Object(l.__generator)(this,function(n){return[2,new Promise(function(n,a){var r=new XMLHttpRequest;r.onload=function(){if(200===r.status){var e=JSON.parse(this.responseText);e?n(e):a("OGMA returned invalid response: "+this.response)}else a("OGMA failed to detect email language: "+this.response)},r.onerror=function(){a("OGMA call failed: "+this.response)},r.open("POST",""+h+T),S(r,t),r.send(JSON.stringify(e))})]})})}var W=1e4;function k(e){return Object(l.__awaiter)(this,void 0,void 0,function(){var t,n,a,r,u,o;return Object(l.__generator)(this,function(i){switch(i.label){case 0:t=Object(s.a)(),n=null,a=new R.a("InlineTranslationGetDetectedLanguage"),i.label=1;case 1:return i.trys.push([1,3,,4]),(r=e.join(" ")).length>W&&(r=r.substring(0,W)),[4,C(r,t)];case 2:return n=i.sent(),a.end(),[3,4];case 3:return u=i.sent(),o=new Error("[InlineTranslation] getOgmaDetectedLanguage failed. Error:"+u+" | cid:"+t),a.endWithError("ServerError",o),[3,4];case 4:return[2,n]}})})}function J(e){return i.supportedLanguageMap.has(e)?i.supportedLanguageMap.get(e).LanguageName:null}function P(){return i.userLanguageName}function X(){return i.userLanguageTag}function $(){var e=Object(f.a)();return e.targetLanguage?J(e.targetLanguage):P()}function B(){var e=Object(f.a)();return e.targetLanguage?e.targetLanguage:i.userLanguageTag}function F(){return i.isUserLocaleSupported}var K=3e4;function Q(e,t){return Object(l.__awaiter)(this,void 0,void 0,function(){return Object(l.__generator)(this,function(n){return[2,new Promise(function(n,a){Object(d.e)("rp-inlineTranslation-UseOWS")?function(e,t,n,a){Object(l.__awaiter)(this,void 0,void 0,function(){var r,u,o,s,i;return Object(l.__generator)(this,function(c){switch(c.label){case 0:r=_(t),u=!1,o=setTimeout(function(){u=!0,a("Request timed out")},K),c.label=1;case 1:return c.trys.push([1,3,,4]),[4,Object(x.d)((g=B(),j+"?toLang="+g),e,t,!1,r,!0)];case 2:return s=c.sent(),u||(clearTimeout(o),null!=s?n(V(s)):a("OGMA returned invalid response: "+s)),[3,4];case 3:return i=c.sent(),a("translateTextOWS failed:"+i.message),[3,4];case 4:return[2]}var g})})}(e,t,n,a):function(e,t,n,a){var r=new XMLHttpRequest;r.timeout=K,r.onload=function(){if(200===r.status){var e=JSON.parse(this.responseText);null!=e?n(V(e)):a("OGMA returned invalid response: "+this.response)}else a("OGMA failed to translate messaage: "+this.response)},r.onerror=function(){a("OGMA call failed: "+this.response)},r.ontimeout=function(){a("OGMA call timed out")},r.open("POST",(u=B(),""+h+v+"?fromLang=&toLang="+u)),S(r,t),r.send(function(e){var t=[];return e.forEach(function(e){var n={Data:e,DataType:"html"};t.push(n)}),JSON.stringify(t)}(e));var u}(e,t,n,a)})]})})}function V(e){var t=[];return e.forEach(function(e){t.push(e.TranslatedText)}),t}var Y=n(794);function Z(e,t){return Object(l.__awaiter)(this,void 0,void 0,function(){return Object(l.__generator)(this,function(n){switch(n.label){case 0:return e.translationMode!==t.translationMode&&Object(R.o)("InlineTranslationChangeTranslationMode",[],{cosmosOnlyData:t.translationMode.toString()}),e.targetLanguage!==t.targetLanguage&&Object(R.o)("InlineTranslationChangeTargetLanguage",[],{cosmosOnlyData:t.targetLanguage?t.targetLanguage:"none"}),t.excludedLanguages.forEach(function(t){e.excludedLanguages.includes(t)||Object(R.o)("InlineTranslationOptOutOfLanguage",[],{cosmosOnlyData:t})}),e.excludedLanguages.forEach(function(e){t.excludedLanguages.includes(e)||Object(R.o)("InlineTranslationRemoveOptOutOfLanguage",[],{cosmosOnlyData:e})}),[4,Y.d.importAndExecute(Y.a.Translation,t)];case 1:return n.sent(),[2]}})})}n.d(t,"checkCanTranslate",function(){return g}),n.d(t,"initSupportedLanguages",function(){return D}),n.d(t,"initAndGetSupportedLanguageMap",function(){return U}),n.d(t,"getLocaleOfSupportedLanguageMap",function(){return z}),n.d(t,"getOgmaSupportedLanguageTag",function(){return u}),n.d(t,"getDetectedLanguage",function(){return k}),n.d(t,"getLanguageNameFromTag",function(){return J}),n.d(t,"getUserLanguageName",function(){return P}),n.d(t,"getUserLanguageTag",function(){return X}),n.d(t,"getTargetLanguageName",function(){return $}),n.d(t,"getTargetLanguageTag",function(){return B}),n.d(t,"getIsUserLocaleSupported",function(){return F}),n.d(t,"translateText",function(){return Q}),n.d(t,"updateTranslationOptions",function(){return Z})}},0,[23,119]]);
//# sourceMappingURL=owa.Translation.js.map
self.scriptsLoaded['owa.Translation.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.Translation.js'] = (new Date()).getTime();