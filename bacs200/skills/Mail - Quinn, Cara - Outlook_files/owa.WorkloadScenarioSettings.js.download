self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.WorkloadScenarioSettings.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[472],{1265:function(t,e,n){"use strict";n.d(e,"a",function(){return c});var r=n(2),a={selectedCalendars:new(n(6).ObservableMap)},c=Object(r.createStore)("selectedCalendarsStore",a)},1523:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(0);e.default=function(t){return r.__assign({__type:"GetUserUnifiedGroupsJsonRequest:#Exchange"},t)}},1555:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(199),a=n(1523);e.default=function(t,e){return void 0===t||t.__type||(t=a.default(t)),r.makeServiceRequest("GetUserUnifiedGroups",t,e)}},1556:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(0);e.default=function(t){return r.__assign({__type:"GetUserUnifiedGroupsRequest:#Exchange"},t)}},1622:function(t,e,n){"use strict";n.d(e,"a",function(){return c});var r=n(22),a=new r.c(function(){return n.e(461).then(n.bind(null,3129))}),c=new r.a(a,function(t){return t.updateUserConfigurationService})},174:function(t,e,n){"use strict";n.d(e,"d",function(){return c}),n.d(e,"c",function(){return u}),n.d(e,"e",function(){return i}),n.d(e,"b",function(){return o}),n.d(e,"a",function(){return s});var r=n(22),a=(n(280),new r.c(function(){return n.e(362).then(n.bind(null,697))})),c=(new r.a(a,function(t){return t.makeOwsPrimeRequest}).importAndExecute,new r.a(a,function(t){return t.makePostRequest}).importAndExecute),u=new r.a(a,function(t){return t.makePatchRequest}).importAndExecute,i=new r.a(a,function(t){return t.makePutRequest}).importAndExecute,o=new r.a(a,function(t){return t.makeGetRequest}).importAndExecute,s=new r.a(a,function(t){return t.makeDeleteRequest}).importAndExecute},1891:function(t,e,n){"use strict";var r=n(2),a=Object(r.action)("UPDATE_SELECTED_CALENDARS_IN_STORE",function(t,e){return{calendarIds:t,primarySmtpAddress:e}}),c=Object(r.action)("ADD_SELECTED_CALENDAR_IN_STORE",function(t,e){return{calendarId:t,primarySmtpAddress:e}}),u=n(1265),i=n(997);Object(r.mutator)(a,function(t){var e=t.calendarIds,n=t.primarySmtpAddress;Object(u.a)().selectedCalendars.set(n,Object(i.b)(e))});var o=n(0),s=n(2135);function d(t){var e=Object(s.a)().get(t);return e||[]}Object(r.mutator)(c,function(t){var e=t.calendarId,n=t.primarySmtpAddress;Object(u.a)().selectedCalendars.set(n,Object(i.b)(Object(o.__spread)(d(n),[e])))});var f=Object(r.action)("UPDATE_SELECTED_CALENDARS",function(t,e){return{calendarIds:t,primarySmtpAddress:e}}),l=Object(r.action)("ADD_SELECTED_CALENDAR",function(t,e){return{calendarId:t,primarySmtpAddress:e}}),b=(Object(r.action)("INITIALIZE_SELECTED_CALENDARS",function(t,e){return{calendarIds:t,primarySmtpAddress:e}}),Object(r.action)("SELECTED_CALENDARS_UPDATED",function(t,e){return{calendarIds:t,primarySmtpAddress:e}})),v=n(175),p=n(25),O=n(1622),j="OWA.ViewStateConfiguration";function m(t,e){var n=Object(v.e)(e);t&&O.a.importAndExecute(j,{Type:"String",Value:["SelectedCalendarsDesktop"]},{Type:"StringArray",Value:Object(i.b)(t)},n).catch(function(t){p.d.warn("Could not save new selected calendars list to user configuration")})}Object(r.orchestrator)(f,function(t){var e=t.calendarIds,n=t.primarySmtpAddress;a(e,n),b(e,n),m(e,n)}),Object(r.orchestrator)(l,function(t){var e=t.calendarId,n=t.primarySmtpAddress;c(e,n);var r=d(n);b(r,n),m(r,n)});var _=n(110);Object(r.mutator)(_.t,function(t){var e=t.userConfiguration,n=t.primarySmtpAddress;Object(u.a)().selectedCalendars.set(n||Object(v.e)().primarySmtpAddress,Object(i.b)(e.ViewStateConfiguration.SelectedCalendarsDesktop))}),n.d(e,"d",function(){return f}),n.d(e,"a",function(){return l}),n.d(e,"c",function(){return b}),n.d(e,"b",function(){return d})},2135:function(t,e,n){"use strict";n.d(e,"a",function(){return c});var r=n(1265),a=n(997);function c(){return Object(a.c)(Object(r.a)().selectedCalendars)}},243:function(t,e,n){"use strict";var r=n(278).a.Symbol;e.a=r},261:function(t,e,n){"use strict";e.a=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}},2736:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(0);e.default=function(t){return r.__assign({__type:"GetCalendarFolderConfigurationRequest:#Exchange"},t)}},278:function(t,e,n){"use strict";var r=n(374),a="object"==typeof self&&self&&self.Object===Object&&self,c=r.a||a||Function("return this")();e.a=c},280:function(t,e,n){"use strict";n.d(e,"b",function(){return r}),n.d(e,"a",function(){return a});var r="owsserver",a="owsapi"},2881:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(199);e.default=function(t,e){return r.makeServiceRequest("GetCalendarFolders",t,e)}},289:function(t,e,n){"use strict";var r=n(278);e.a=function(){return r.a.Date.now()}},3052:function(t,e,n){"use strict";var r;function a(t){var e=t.getCalendarFolders;return r=e,t}function c(){var t=r;return r=void 0,t}n.d(e,"b",function(){return a}),n.d(e,"a",function(){return c})},327:function(t,e,n){"use strict";var r=n(261),a=n(371),c=NaN,u=/^\s+|\s+$/g,i=/^[-+]0x[0-9a-f]+$/i,o=/^0b[01]+$/i,s=/^0o[0-7]+$/i,d=parseInt;e.a=function(t){if("number"==typeof t)return t;if(Object(a.a)(t))return c;if(Object(r.a)(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=Object(r.a)(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(u,"");var n=o.test(t);return n||s.test(t)?d(t.slice(2),n?2:8):i.test(t)?c:+t}},3302:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(199),a=n(2736);e.default=function(t,e){return void 0===t.request||t.request.__type||(t.request=a.default(t.request)),r.makeServiceRequest("GetCalendarFolderConfiguration",t,e)}},365:function(t,e,n){"use strict";e.a=function(t){return null!=t&&"object"==typeof t}},366:function(t,e,n){"use strict";var r=n(243),a=Object.prototype,c=a.hasOwnProperty,u=a.toString,i=r.a?r.a.toStringTag:void 0;var o=function(t){var e=c.call(t,i),n=t[i];try{t[i]=void 0;var r=!0}catch(t){}var a=u.call(t);return r&&(e?t[i]=n:delete t[i]),a},s=Object.prototype.toString;var d=function(t){return s.call(t)},f="[object Null]",l="[object Undefined]",b=r.a?r.a.toStringTag:void 0;e.a=function(t){return null==t?void 0===t?l:f:b&&b in Object(t)?o(t):d(t)}},371:function(t,e,n){"use strict";var r=n(366),a=n(365),c="[object Symbol]";e.a=function(t){return"symbol"==typeof t||Object(a.a)(t)&&Object(r.a)(t)==c}},374:function(t,e,n){"use strict";(function(t){var n="object"==typeof t&&t&&t.Object===Object&&t;e.a=n}).call(this,n(31))},391:function(t,e,n){"use strict";var r=n(261),a=n(289),c=n(327),u="Expected a function",i=Math.max,o=Math.min;e.a=function(t,e,n){var s,d,f,l,b,v,p=0,O=!1,j=!1,m=!0;if("function"!=typeof t)throw new TypeError(u);function _(e){var n=s,r=d;return s=d=void 0,p=e,l=t.apply(r,n)}function E(t){var n=t-v;return void 0===v||n>=e||n<0||j&&t-p>=f}function S(){var t=Object(a.a)();if(E(t))return y(t);b=setTimeout(S,function(t){var n=e-(t-v);return j?o(n,f-(t-p)):n}(t))}function y(t){return b=void 0,m&&s?_(t):(s=d=void 0,l)}function A(){var t=Object(a.a)(),n=E(t);if(s=arguments,d=this,v=t,n){if(void 0===b)return function(t){return p=t,b=setTimeout(S,e),O?_(t):l}(v);if(j)return b=setTimeout(S,e),_(v)}return void 0===b&&(b=setTimeout(S,e)),l}return e=Object(c.a)(e)||0,Object(r.a)(n)&&(O=!!n.leading,f=(j="maxWait"in n)?i(Object(c.a)(n.maxWait)||0,e):f,m="trailing"in n?!!n.trailing:m),A.cancel=function(){void 0!==b&&clearTimeout(b),p=0,s=v=d=b=void 0},A.flush=function(){return void 0===b?l:y(Object(a.a)())},A}},4731:function(t,e,n){"use strict";var r=n(2),a=Object(r.action)("UPDATE_SELECTED_TIME_PANEL_CALENDARIDS",function(t,e){return{calendarIds:t,primarySmtpAddress:e}}),c=Object(r.action)("ON_SELECTED_TIME_PANEL_CALENDARIDS_UPDATED",function(t,e){return{calendarIds:t,primarySmtpAddress:e}}),u=n(0),i=n(6),o=Object(r.createStore)("timePanelSelectedCalendarIdsStore",{calendarIdsMap:new i.ObservableMap});function s(){var t,e,n=o().calendarIdsMap,r=0;try{for(var a=Object(u.__values)(n.values()),c=a.next();!c.done;c=a.next()){var i=c.value;i&&(r+=i.length)}}catch(e){t={error:e}}finally{try{c&&!c.done&&(e=a.return)&&e.call(a)}finally{if(t)throw t.error}}return r>0}var d=n(1891),f=(Object(r.orchestrator)(d.c,function(t){var e=t.calendarIds,n=t.primarySmtpAddress;s()||c(e,n)}),n(1105)),l=n(1997),b=n(997),v=n(25),p=Object(f.b)({maximumAttempts:3,timeBetweenRetryInMS:Object(f.a)(1e3)}),O=null,j=(Object(r.orchestrator)(a,function(t){return Object(u.__awaiter)(void 0,void 0,void 0,function(){var e,n,r,a;return Object(u.__generator)(this,function(u){switch(u.label){case 0:e=t.calendarIds,n=t.primarySmtpAddress,r=Object(b.b)(e),u.label=1;case 1:return u.trys.push([1,3,,4]),O&&O.cancel(),[4,(O=p(function(){return Object(l.c)(r,n)})).retriableFunc()];case 2:return u.sent(),c(r,n),[3,4];case 3:return a=u.sent(),v.d.warn("updateSelectedCalendarIdsOrchestrator: updateTimePanelCalendarIdsService with retry failed: "+a),[3,4];case 4:return O=null,[2]}})})}),Object(r.mutator)(l.e,function(t){var e=t.settings,n=t.accountSmtpAddress;e.timePanelCalendarIds&&e.timePanelCalendarIds.length>0&&o().calendarIdsMap.set(n,Object(b.b)(e.timePanelCalendarIds))}),Object(r.mutator)(a,function(t){var e=t.calendarIds,n=t.primarySmtpAddress;o().calendarIdsMap.set(n,Object(b.b)(e))}),n(4768));function m(){return Object(u.__awaiter)(this,void 0,void 0,function(){var t;return Object(u.__generator)(this,function(e){switch(e.label){case 0:return s()?(t=Object(b.c)(o().calendarIdsMap),[2,Promise.resolve(t)]):[3,1];case 1:return[4,Object(j.a)()];case 2:return[2,e.sent()]}})})}function _(){return Object(u.__awaiter)(this,void 0,void 0,function(){var t;return Object(u.__generator)(this,function(e){switch(e.label){case 0:return t=b.d,[4,m()];case 1:return[2,t.apply(void 0,[e.sent()])]}})})}n.d(e,"c",function(){return c}),n.d(e,"b",function(){return m}),n.d(e,"a",function(){return _})},4768:function(t,e,n){"use strict";var r=n(0),a=n(175),c=n(260),u=n(2135),i=n(2373);function o(){return Object(r.__awaiter)(this,void 0,void 0,function(){var t,e,n,o;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return t=0,(e=Object(u.a)()).forEach(function(e,n){e&&(t+=e.length)}),0!=t?[3,2]:(n=Object(a.e)().primarySmtpAddress,[4,Object(i.c)(i.a.Outlook)]);case 1:r.sent(),(o=Object(c.u)(n))&&e.set(n,[o.id.id]),r.label=2;case 2:return[2,e]}})})}n.d(e,"a",function(){return o})},6152:function(t,e,n){"use strict";n.r(e);var r=n(1997);n.d(e,"loadWorkloadScenarioSettings",function(){return r.a});n(4731),n(2372),n(3939)},997:function(t,e,n){"use strict";function r(t,e){return!t.some(function(t){return t&&e&&t.calculatedFolderId===e.calculatedFolderId})}function a(t,e){return t.indexOf(e)<0}function c(t,e){if(void 0===e&&(e=a),!t)return[];var n=[];return t&&t.forEach(function(t){e(n,t)&&n.push(t)}),n}var u=n(6);function i(t,e){if(void 0===e&&(e=a),!t)return t;var n=new u.ObservableMap;return t.forEach(function(t,r){n.set(r,c(t,e))}),n}function o(t,e){if(void 0===e&&(e=a),!t)return[];var n=[];return t.forEach(function(t){t&&t.forEach(function(t){e(n,t)&&n.push(t)})}),n}n.d(e,"a",function(){return r}),n.d(e,"b",function(){return c}),n.d(e,"c",function(){return i}),n.d(e,"d",function(){return o})}},0,[23,119,501]]);
//# sourceMappingURL=owa.WorkloadScenarioSettings.js.map
self.scriptsLoaded['owa.WorkloadScenarioSettings.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.WorkloadScenarioSettings.js'] = (new Date()).getTime();