self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.ExpandedListSelectionActions.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[217],{13936:function(e,t,n){"use strict";n.r(t);var a=n(4),o=n(6),i=n(755),r=n(779),s=n(2221),d=n(25);function c(e,t){var n=function(e){var t={},n=r.a.conversationNodes.get(e);for(;n;){if(t[n.internetMessageId]){d.d.error("Invalid loop found in ParentInternetMessageId pointers");break}if(Object(s.b)(n.internetMessageId)&&(t[n.internetMessageId]=!0),Object(a.g)(n.parentInternetMessageId))break;n=r.a.conversationNodes.get(n.parentInternetMessageId)}return t}(e);if(1===Object.keys(n).length)return function(e,t){var n=new o.ObservableMap({});return t.forEach(function(t){var a=r.a.conversationNodes.get(t),o=t===e?i.a.CheckMark:i.a.None;n.set(a.internetMessageId,o)}),n}(e,t);for(var c=new o.ObservableMap({}),u=!1,v=!1,l=0,b=0;b<t.length;b++){var p=r.a.conversationNodes.get(t[b]);n[p.internetMessageId]?(u?l+1===Object.keys(n).length?(c.set(p.internetMessageId,i.a.BusEnd),v=!0):c.set(p.internetMessageId,i.a.BusStop):(c.set(p.internetMessageId,i.a.BusStart),u=!0),l++):!u||v?c.set(p.internetMessageId,i.a.None):c.set(p.internetMessageId,i.a.NoStop)}return c}var u=n(790),v=n(770),l=n(6159),b=n(759),p=n(2);function w(){v.a.expandedConversationViewState.expandedRowKey=null,v.a.expandedConversationViewState.selectedNodeIds=[],v.a.expandedConversationViewState.shouldBeExpanded=!1,v.a.expandedConversationViewState.busStopStateMap=new o.ObservableMap({})}Object(p.mutator)(u.t,function(e){var t=e.nodeId,n=e.allNodeIds,a=v.a.expandedConversationViewState.selectedNodeIds;a.indexOf(t)>-1?(a.splice(a.indexOf(t),1),1===a.length&&(v.a.expandedConversationViewState.busStopStateMap=c(a[0],n))):a.push(t)}),Object(p.mutator)(u.h,function(e){v.a.expandedConversationViewState.busStopStateMap=new o.ObservableMap({})}),Object(p.mutator)(u.q,function(e){var t=e.rowKey,n=e.nodeIdToSelect,a=e.allNodeIds;v.a.expandedConversationViewState.expandedRowKey=t,v.a.expandedConversationViewState.selectedNodeIds=[n],v.a.expandedConversationViewState.busStopStateMap=c(n,a)}),Object(p.mutator)(u.u,function(e){var t=v.a.expandedConversationViewState;e.mailListItemSelectionSource==b.e.MailListItemCheckbox&&t.expandedRowKey!=e.rowKey&&w()}),Object(p.mutator)(u.p,function(e){var t=v.a.expandedConversationViewState;e.shouldSelect||t.expandedRowKey!=e.rowKey||w()}),Object(p.mutator)(u.i,function(e){w()}),Object(p.mutator)(u.k,function(e){w()}),Object(p.mutator)(u.r,function(e){var t=v.a.expandedConversationViewState;e.mailListItemSelectionSource==b.e.MailListItemTwisty&&t.expandedRowKey!=e.rowKey&&(t.expandedRowKey=e.rowKey,t.shouldBeExpanded=!0)}),Object(p.mutator)(u.o,function(e){v.a.expandedConversationViewState.shouldBeExpanded=e.shouldBeExpanded}),Object(p.mutator)(l.a,function(e){if(1===v.a.expandedConversationViewState.selectedNodeIds.length){var t=v.a.expandedConversationViewState.selectedNodeIds[0],n=b.H.conversations.get(e.conversationId).conversationNodeIds;v.a.expandedConversationViewState.busStopStateMap=c(t,n)}});var I=n(0),f=n(6662),O=n(1657),S=n(1249);Object(p.orchestrator)(u.b,function(e){m(e.itemId,e.tableView,e.nodeId,e.allNodeIds,b.e.MailListItemExpansion)});function m(e,t,n,a,o){Object(O.f)(t,!0,o),S.k.importAndExecute(e),u.q(i.N.expandedConversationViewState.expandedRowKey,n,a,t.id)}function x(e,t){var n,a,o=i.b.getConversationId(e,t),r=b.H.conversations.get(o);try{for(var d=Object(I.__values)(r.conversationNodeIds),c=d.next();!c.done;c=d.next()){var u=c.value,v=Object(s.b)(u);if(v){m(v.ItemId.Id,t,u,r.conversationNodeIds,b.e.RowRemoval);break}}}catch(e){n={error:e}}finally{try{c&&!c.done&&(a=d.return)&&a.call(d)}finally{if(n)throw n.error}}}function j(){u.i()}Object(p.orchestrator)(u.e,function(e){if(e.mailListItemSelectionSource==b.e.MailListItemTwisty){if(1==e.listViewType)throw new Error("Toggle expansion action cannot be called from message view");var t,n;Object(f.a)(e.rowKey)?j():(t=e.rowKey,n=e.tableView,u.o(!1),x(t,n))}}),Object(p.orchestrator)(u.c,function(e){Object(f.a)(e.rowKey)&&j()}),Object(p.orchestrator)(u.m,function(e){for(var t=i.b.getConversationId(e.rowKey,e.tableView),n=b.H.conversations.get(t),a=null,o=null,r=n.conversationNodeIds.indexOf(i.N.expandedConversationViewState.selectedNodeIds[0])+1;r<n.conversationNodeIds.length;r++){var d=n.conversationNodeIds[r],c=Object(s.b)(d);if(c){o=c.ItemId.Id,a=d;break}}a?m(o,e.tableView,a,n.conversationNodeIds,b.e.RowRemoval):x(e.rowKey,e.tableView)});var N=n(5425),g=n(5457),V=(Object(p.orchestrator)(g.a,function(e){Object(N.a)(),1===Object(i.D)().expandedConversationViewState.selectedNodeIds.length&&u.h()}),n(7017)),C=n(954);Object(p.orchestrator)(V.a,function(e){if(i.N.expandedConversationViewState.expandedRowKey){var t=b.H.conversations.get(e.conversationId);u.q(i.N.expandedConversationViewState.expandedRowKey,e.conversationNodeId,t.conversationNodeIds,Object(C.a)())}})},5425:function(e,t,n){"use strict";var a=n(0),o=n(3280),i=n(3279),r=n(1558),s=n(941),d=n(909),c=n(1577),u=n(43),v=n(755);t.a=Object(u.select)({composeViewState:function(){return d.a.viewStates.get(d.a.primaryComposeId)},conversationItems:function(){return v.N.conversationItems}})(Object(u.action)("reloadReadingPane")(function(e){var t=Object(v.B)(),n=t?Object(a.__spread)(t.selectedRowKeys.keys()):[];if(1==n.length){var d=v.b.getRowClientItemId(n[0],t),u=Object(c.a)(n,t)[0];switch(t.tableQuery.listViewType){case 0:var l=e.conversationItems.get(d.Id);e.composeViewState&&e.composeViewState.isInlineCompose?s.z.importAndExecute(e.composeViewState).then(function(){Object(o.b)(d,u,l.subject)}):Object(o.b)(d,u,l.subject);break;case 1:e.composeViewState&&e.composeViewState.isInlineCompose?s.z.importAndExecute(e.composeViewState).then(function(){Object(i.a)(d,u,r.a)}):Object(i.a)(d,u,r.a)}}}))},5457:function(e,t,n){"use strict";var a=n(2),o=Object(a.action)("ON_CONVERSATION_OPTION_SAVED");t.a=o},6159:function(e,t,n){"use strict";var a=n(2);t.a=Object(a.action)("UPDATE_LOADED_CONVERSATION_READING_PANE",function(e,t){return{conversationId:e,nodeIdCollectionChanged:t}})},7017:function(e,t,n){"use strict";var a=n(2);t.a=Object(a.action)("ON_ITEM_PART_SELECTED",function(e,t){return{conversationNodeId:e,conversationId:t}})}},0,[2,3,8,11,386,22,334,4,5,310,39,88,350,6,7,9,10,128,0,1,532,182,13,46,124,527,145,531,178,23,119,318,337,433]]);
//# sourceMappingURL=owa.ExpandedListSelectionActions.js.map
self.scriptsLoaded['owa.ExpandedListSelectionActions.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.ExpandedListSelectionActions.js'] = (new Date()).getTime();