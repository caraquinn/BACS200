self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.UpNextV2.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[460,72],{1053:function(e,t,n){"use strict";var r=n(2);t.a=Object(r.action)("TOGGLE_CHARM",function(e){return{charm:e}})},10540:function(e,t,n){(t=e.exports=n(57)(!1)).push([e.i,'@-webkit-keyframes _3GYWRGGf7P_GI0nsmyJJEq{0%{-webkit-transform:translateY(0);transform:translateY(0)}33.33%,66.66%{-webkit-transform:translateY(-34px);transform:translateY(-34px)}to{-webkit-transform:translateY(-68px);transform:translateY(-68px)}}@-webkit-keyframes _2qguJkZ4YN-a4-jZornQTp{0%{-webkit-transform:translateY(0);transform:translateY(0)}33.33%,66.66%{-webkit-transform:translateY(-34px);transform:translateY(-34px)}to{-webkit-transform:translateY(-68px);transform:translateY(-68px)}}@keyframes _3GYWRGGf7P_GI0nsmyJJEq{0%{-webkit-transform:translateY(0);transform:translateY(0)}33.33%,66.66%{-webkit-transform:translateY(-34px);transform:translateY(-34px)}to{-webkit-transform:translateY(-68px);transform:translateY(-68px)}}@keyframes _2qguJkZ4YN-a4-jZornQTp{0%{-webkit-transform:translateY(0);transform:translateY(0)}33.33%,66.66%{-webkit-transform:translateY(-34px);transform:translateY(-34px)}to{-webkit-transform:translateY(-68px);transform:translateY(-68px)}}@-webkit-keyframes _1uBAfIo7O7RpspBEYft67J{to{-webkit-transform:translateY(0);transform:translateY(0)}}@-webkit-keyframes gqklPe3BnRAQGJ-1Nd_Xp{to{-webkit-transform:translateY(0);transform:translateY(0)}}@keyframes _1uBAfIo7O7RpspBEYft67J{to{-webkit-transform:translateY(0);transform:translateY(0)}}@keyframes gqklPe3BnRAQGJ-1Nd_Xp{to{-webkit-transform:translateY(0);transform:translateY(0)}}.bquTIlYhtqsZHlrJCQ0ci{font-size:12px;font-weight:400;color:"[theme:themeDark, default:#0D62AA]";cursor:pointer;height:34px;overflow:hidden}html[dir] .bquTIlYhtqsZHlrJCQ0ci{padding:0 8px}._1KWaEy1JwXTPcXePft1XyO,._1Lt2W5uQ7oe52kMFzniHCz,.HpJj1IBE9g7fhlrQQuBva,._3Bs5dMtWmfrHZqZk57Bq9W{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-flow:column nowrap;flex-flow:column nowrap;-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto;overflow:hidden;-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start;-ms-flex-item-align:start;align-self:flex-start;height:34px}.HpJj1IBE9g7fhlrQQuBva{height:68px}html[dir] .HpJj1IBE9g7fhlrQQuBva{-webkit-transform:translateY(0);transform:translateY(0);-webkit-transition:-webkit-transform .3s cubic-bezier(.8,0,.2,1);transition:-webkit-transform .3s cubic-bezier(.8,0,.2,1);transition:transform .3s cubic-bezier(.8,0,.2,1);transition:transform .3s cubic-bezier(.8,0,.2,1),-webkit-transform .3s cubic-bezier(.8,0,.2,1)}._1Lt2W5uQ7oe52kMFzniHCz{height:102px;-webkit-animation-fill-mode:forwards;animation-fill-mode:forwards;-webkit-animation-play-state:running;animation-play-state:running;-webkit-animation-timing-function:cubic-bezier(.8,0,.2,1);animation-timing-function:cubic-bezier(.8,0,.2,1)}html[dir=ltr] ._1Lt2W5uQ7oe52kMFzniHCz{-webkit-animation-name:gqklPe3BnRAQGJ-1Nd_Xp;animation-name:gqklPe3BnRAQGJ-1Nd_Xp}html[dir=rtl] ._1Lt2W5uQ7oe52kMFzniHCz{-webkit-animation-name:_1uBAfIo7O7RpspBEYft67J;animation-name:_1uBAfIo7O7RpspBEYft67J}html[dir] .bquTIlYhtqsZHlrJCQ0ci:hover .HpJj1IBE9g7fhlrQQuBva{-webkit-transform:translateY(-34px);transform:translateY(-34px);-webkit-transition-delay:.1s;transition-delay:.1s}.bquTIlYhtqsZHlrJCQ0ci:hover ._1Lt2W5uQ7oe52kMFzniHCz{-webkit-animation-duration:3.6s;animation-duration:3.6s}html[dir=ltr] .bquTIlYhtqsZHlrJCQ0ci:hover ._1Lt2W5uQ7oe52kMFzniHCz{-webkit-animation-name:_2qguJkZ4YN-a4-jZornQTp;animation-name:_2qguJkZ4YN-a4-jZornQTp}html[dir=rtl] .bquTIlYhtqsZHlrJCQ0ci:hover ._1Lt2W5uQ7oe52kMFzniHCz{-webkit-animation-name:_3GYWRGGf7P_GI0nsmyJJEq;animation-name:_3GYWRGGf7P_GI0nsmyJJEq}._1hagGpG7AzPUNXP0Svq92n{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-flow:row nowrap;flex-flow:row nowrap;overflow:hidden;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-flex:1;-ms-flex:1 0 auto;flex:1 0 auto;-ms-flex-item-align:end;align-self:flex-end;height:34px}.Zxu7pq6NX4jIi550qVOsj{font-size:14px;font-weight:400;-webkit-box-flex:1;-ms-flex:1 0 auto;flex:1 0 auto;line-height:34px}html[dir=ltr] .Zxu7pq6NX4jIi550qVOsj{padding-right:6px}html[dir=rtl] .Zxu7pq6NX4jIi550qVOsj{padding-left:6px}._3PRzKbmV4xQJvn21aAkCeP{font-size:16px;-webkit-box-flex:1;-ms-flex:1 0 auto;flex:1 0 auto}html[dir=ltr] ._3PRzKbmV4xQJvn21aAkCeP{padding-right:8px}html[dir=rtl] ._3PRzKbmV4xQJvn21aAkCeP{padding-left:8px}._3wJAY7Lg8iqglCkKc_1xfx,._2KWQkcW6CcNYP-7HUovRXb,._5h5kaMsfWHnnSvF2gbHpv,._3xLd9sljnn8QP_g_E9drtK{overflow:hidden;word-break:break-all}html[dir] ._3wJAY7Lg8iqglCkKc_1xfx,html[dir] ._2KWQkcW6CcNYP-7HUovRXb,html[dir] ._5h5kaMsfWHnnSvF2gbHpv,html[dir] ._3xLd9sljnn8QP_g_E9drtK{text-align:start}.HI72OmTBCYbpLJFgasLYQ{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-flow:column nowrap;flex-flow:column nowrap;-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto;overflow:hidden;-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start;-ms-flex-item-align:start;align-self:flex-start}._5h5kaMsfWHnnSvF2gbHpv{font-weight:600;height:16px}._5h5kaMsfWHnnSvF2gbHpv,._1cph5Ohu1BNS65JDq4b3tl{-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto;max-width:162px}._1cph5Ohu1BNS65JDq4b3tl{display:-webkit-box;display:-ms-flexbox;display:flex}._3xLd9sljnn8QP_g_E9drtK{-webkit-box-flex:1;-ms-flex:1 0 auto;flex:1 0 auto;max-width:162px}html[dir=ltr] ._3xLd9sljnn8QP_g_E9drtK{margin-right:4px}html[dir=rtl] ._3xLd9sljnn8QP_g_E9drtK{margin-left:4px}._2KWQkcW6CcNYP-7HUovRXb{-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto}html[dir] ._3Bs5dMtWmfrHZqZk57Bq9W{background-color:"[theme:neutralLighter, default:#f4f4f4]"}html[dir=ltr] ._3Bs5dMtWmfrHZqZk57Bq9W,html[dir=rtl] ._3Bs5dMtWmfrHZqZk57Bq9W{padding-left:6px;padding-right:6px;margin-left:-6px;margin-right:-6px}._3Bs5dMtWmfrHZqZk57Bq9W:after{top:0;bottom:0;position:absolute;content:""}html[dir] ._3Bs5dMtWmfrHZqZk57Bq9W:after{border:1px dashed "[theme:neutralSecondary, default:#666666]";border-radius:4px}html[dir=ltr] ._3Bs5dMtWmfrHZqZk57Bq9W:after,html[dir=rtl] ._3Bs5dMtWmfrHZqZk57Bq9W:after{left:0;right:0}html[dir] ._3Bs5dMtWmfrHZqZk57Bq9W._24nhwfXJq1KyrGBySrzZfN{background-color:"[theme:themeLighterAlt, default:#EFF6FC]"}html[dir] ._3Bs5dMtWmfrHZqZk57Bq9W._24nhwfXJq1KyrGBySrzZfN:after{border-color:"[theme:themePrimary, default:#0078D4]"}',""]),t.locals={upNextEventButtonContainer:"bquTIlYhtqsZHlrJCQ0ci",allEventsContainer:"_1KWaEy1JwXTPcXePft1XyO",allEventsContainerThreeOrMoreEvents:"_1Lt2W5uQ7oe52kMFzniHCz",allEventsContainerTwoEvents:"HpJj1IBE9g7fhlrQQuBva",dropContainer:"_3Bs5dMtWmfrHZqZk57Bq9W",reverseMotion:"gqklPe3BnRAQGJ-1Nd_Xp","reverseMotion-rtl":"_1uBAfIo7O7RpspBEYft67J",motionForThreeOrMore:"_2qguJkZ4YN-a4-jZornQTp","motionForThreeOrMore-rtl":"_3GYWRGGf7P_GI0nsmyJJEq",upNextEventContainer:"_1hagGpG7AzPUNXP0Svq92n",conflictingEventsCount:"Zxu7pq6NX4jIi550qVOsj",eventIconColumn:"_3PRzKbmV4xQJvn21aAkCeP",eventEntities:"_3wJAY7Lg8iqglCkKc_1xfx",eventLocation:"_2KWQkcW6CcNYP-7HUovRXb",eventName:"_5h5kaMsfWHnnSvF2gbHpv",eventTime:"_3xLd9sljnn8QP_g_E9drtK",eventDetailsColumn:"HI72OmTBCYbpLJFgasLYQ",eventTimeLocationRow:"_1cph5Ohu1BNS65JDq4b3tl",dropHoverTreatment:"_24nhwfXJq1KyrGBySrzZfN"}},10541:function(e){e.exports={a:"m0b"}},1105:function(e,t,n){"use strict";function r(e){void 0===e&&(e={}),function(e){e.timeBetweenRetryInMS=e.timeBetweenRetryInMS||function(){return 6e4}}(e);var t=e.maximumAttempts,n=e.timeBetweenRetryInMS;return function(e){var r=0,a=!1,i=function(c,o){a?o(new Error("The function retry was cancelled")):(r++,e().then(function(e){return c(e)}).catch(function(e){t&&r>=t?o(e):setTimeout(function(){return i(c,o)},n(r))}))};return{retriableFunc:function(){return new Promise(function(e,t){return i(e,t)})},cancel:function(){return a=!0}}}}function a(e){return function(t){return Math.pow(2,t)*e}}n.d(t,"b",function(){return r}),n.d(t,"a",function(){return a})},1112:function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"b",function(){return i}),n.d(t,"c",function(){return c});var r=n(2),a=Object(r.createStore)("UserVoiceNpsStore",{npsSurveyBody:"",npsSurveyRatings:"",isRatingSelected:!1,isSent:!1}),i=Object(r.createStore)("UserVoiceSuggestionStore",{message:"",isMessageEnabled:!1,isSent:!1,customFields:[]})(),c=Object(r.createStore)("userVoiceTrendingIdeasStore",{suggestions:[],pagination:{page:0,per_page:0,total_pages:0,total_records:0}})},1167:function(e,t,n){"use strict";var r=n(7);t.a=function(e){return e.IsAllDayEvent||Object(r.u)(e.End,e.Start)>0}},1242:function(e,t,n){"use strict";var r=n(41),a=n(1569),i=n(1167),c=n(7),o=n(260);function u(e){var t=Object(o.u)();return e.ParentFolderId&&e.ParentFolderId.Id===t.calculatedFolderId}function d(e){if(!e.ParentFolderId)return!1;var t=Object(o.j)(Object(o.u)()).ParentGroupId,n=Object(o.m)(e.ParentFolderId.Id);return n&&n.ParentGroupId===t}function s(e,t){var n=Object(i.a)(e);if(n!=Object(i.a)(t))return n?-1:1;var r=f(t)-f(e);if(0!=r)return r;if(0!=(r=Object(c.w)(e.Start,t.Start)))return r;if("Booking"!=e.__type||"Booking"!=t.__type){var o=u(e);if(o!=u(t))return o?-1:1;var s=d(e);if(s!=d(t))return s?-1:1}return 0!=(r=Object(a.a)(e,t))?r:0!=(r=Object(c.w)(t.End,e.End))?r:0!=(r=l(e.Subject,t.Subject))?r:0!=(r=l(e.CalendarItemType,t.CalendarItemType))?r:0!=(r=l(e.ParentFolderId.Id,t.ParentFolderId.Id))?r:l(e.ItemId.Id,t.ItemId.Id)}function l(e,t){return(e||"").localeCompare(t||"")}function f(e){var t=Object(c.w)(e.End,e.Start);return Math.max(Math.ceil(t/r.c),1)}n.d(t,"a",function(){return s})},1265:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(2),a={selectedCalendars:new(n(6).ObservableMap)},i=Object(r.createStore)("selectedCalendarsStore",a)},1275:function(e,t,n){"use strict";var r=n(2),a=n(6),i=Object(r.action)("updateLoadedDateRange",function(e,t){return{dateRange:e,scenarioId:t}}),c=Object(r.action)("updateLoadedFolderIds",function(e,t,n){return{primarySmtpAddress:e,folderIds:t,scenarioId:n}}),o=Object(r.action)("updateLoadState",function(e,t){return{scenarioId:t,loadState:e}}),u=Object(r.action)("initializeScenario",function(e){return{scenarioId:e}}),d=Object(r.action)("updateIsInitializingCalendarEventsLoader",function(e,t){return{scenarioId:t,isInitializingCalendarEventsLoader:e}}),s=n(0),l=n(1550),f=n(832);function b(e){var t=Object(f.p)(e);return Object(s.__assign)(Object(s.__assign)({},t),{getOrderedEvents:function(t,n){return function(e,t,n){var r=Object(f.p)(n).getCalendarEventsForDateRange,a=[];return e.forEach(function(e){a.push.apply(a,Object(s.__spread)(r(e,t)))}),a.sort(l.a)}(t,n,e)}})}var O=n(1960),m=["ConflictsView","TimePanelAgendaCalendarCacheId","TimePanelAgenda_UpNextCalendarCacheId"];var v={scenarios:new a.ObservableMap},p=Object(r.createStore)("EventsLoadedStore",v),j=n(997);function h(e){return S(e).eventsCacheLockId}function g(e){return p().scenarios.has(e)?S(e).loadState:"DoesNotExist"}function I(e){return S(e).loadedDateRange}function w(e,t){var n=S(t).loadedFolderIds;return n?n.get(e):[]}function _(e){var t=S(e).loadedFolderIds;return Object(j.d)(t)}function S(e){var t=p().scenarios.get(e);if(!t)throw new Error("getScenarioData should not be called until the calendar events loader scenario is initialized");return t}function E(e,t){var n=t||I(e),r=_(e),a=h(e),i=r?b(a).getOrderedEvents(r,n):[];return function(e){return!m.some(function(t){return t==e})&&Object(O.a)()}(e)||(i=i.filter(function(e){return"Decline"!==e.ResponseType})),i}Object(r.mutator)(i,function(e){var t=e.scenarioId,n=e.dateRange;S(t).loadedDateRange=n}),Object(r.mutator)(c,function(e){var t=e.primarySmtpAddress,n=e.scenarioId,r=e.folderIds;S(n).loadedFolderIds.set(t,r)}),Object(r.mutator)(o,function(e){var t=e.scenarioId,n=e.loadState;S(t).loadState=n}),Object(r.mutator)(d,function(e){var t=e.scenarioId,n=e.isInitializingCalendarEventsLoader;S(t).isInitializingCalendarEventsLoader=n}),Object(r.mutator)(u,function(e){var t=e.scenarioId;p().scenarios.get(t)||p().scenarios.set(t,{eventsCacheLockId:Object(f.d)().getLockId(),loadedDateRange:null,loadedFolderIds:new a.ObservableMap,loadState:"Loading",isInitializingCalendarEventsLoader:!0})});var C=Object(r.action)("initializeCalendarEventsLoader",function(e,t,n){return{getFolderIdsData:e,dateRange:t,scenarioId:n}}),y=Object(r.action)("calendarEventsLoaderInitialized",function(e){return{scenarioId:e}}),x=Object(r.action)("updateFolderIds",function(e,t,n){return{primarySmtpAddress:e,getFolderIdsData:t,scenarioId:n}}),T=Object(r.action)("onFolderIdsUpdated",function(e){return{scenarioId:e}}),D=Object(r.action)("onDateRangeUpdated",function(e,t){return{dateRange:e,scenarioId:t}}),k=Object(r.action)("loadFullEvent",function(e,t,n){return{scenarioId:e,id:t,parentFolderId:n}}),M=Object(r.action)("updateDateRange",function(e,t){return{dateRange:e,scenarioId:t}}),A=Object(r.action)("expandDateRange",function(e,t){return{numberOfDays:e,scenarioId:t}}),N=n(2373),P=n(25),V=function(e,t,n){return e&&0!==e.length?function(e,t,n){var r=this,a=h(n),i=Object(f.q)(a),c=e.map(function(e){return i.fetchCalendarEventsForDateRange(e,t)}),o=c.every(function(e){return null!==e.events}),u=new Promise(function(t){return Object(s.__awaiter)(r,void 0,void 0,function(){var n;return Object(s.__generator)(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,Promise.all(c.map(function(e){return e.fetchPromise}))];case 1:return r.sent(),e.forEach(function(e){return Object(f.x)(e)}),[3,3];case 2:return n=r.sent(),P.d.warn("loadEvents: Exception occured: "+n.message),[3,3];case 3:return t(),[2]}})})});return{canFetchAllEventsFromLocal:o,fetchPromise:u}}(e,t,n):{canFetchAllEventsFromLocal:!1,fetchPromise:new Promise(function(e){return Object(s.__awaiter)(void 0,void 0,void 0,function(){return Object(s.__generator)(this,function(t){return[2,e()]})})})}};function L(e,t){return t.length!==e.length||(e.sort(),t.sort(),!t.every(function(t,n){return t===e[n]}))}var F,R=n(7);function B(e,t){return null===t||!Object(R.Cb)(e.start,t.start)||!Object(R.Cb)(e.end,t.end)}!function(e){e[e.CalendarIds=0]="CalendarIds",e[e.DefaultCalendar=1]="DefaultCalendar"}(F||(F={}));var q=n(218),H=n(260),W=n(2501);function Y(e){var t=e.loaderType;switch(t){case F.CalendarIds:var n=e.calendarIds;return n?function(e){return e?e.filter(function(e){return!Object(H.c)(e)}).map(H.v):[]}(n):[];case F.DefaultCalendar:return[Object(H.p)(Object(H.u)())];default:return Object(q.a)(t)}}var U=function(e){return Object(s.__awaiter)(void 0,void 0,void 0,function(){return Object(s.__generator)(this,function(t){switch(t.label){case 0:return e?[4,Promise.all(e.filter(H.c).map(W.b).map(function(e){return e.catch(z)}))]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})};function z(e){return P.d.warn("Failed to update folderId:\n"+e),Promise.resolve()}function G(e){return Object(s.__awaiter)(this,void 0,void 0,function(){var t;return Object(s.__generator)(this,function(n){switch(n.label){case 0:switch(t=e.loaderType,t){case F.CalendarIds:return[3,1];case F.DefaultCalendar:return[3,3]}return[3,4];case 1:return[4,U(e.calendarIds)];case 2:return n.sent(),[3,5];case 3:return[3,5];case 4:Object(q.a)(t),n.label=5;case 5:return[2]}})})}function J(e,t){return Object(s.__awaiter)(this,void 0,void 0,function(){var n,r,a,u,d,l,f,b,O;return Object(s.__generator)(this,function(s){switch(s.label){case 0:return n=t.data,r=t.dateRange,a=t.userId,u=I(e),d=w(a,e),L(l=Y(n),d||[])||B(r,u)?[4,G(n)]:[3,3];case 1:return s.sent(),l=Y(n),f=V(l,r,e),b=f.canFetchAllEventsFromLocal,O=f.fetchPromise,o(b?"Loading":"Fetching",e),[4,O];case 2:s.sent(),i(r,e),c(a,l,e),s.label=3;case 3:return o("Loaded",e),[2]}})})}var Q=n(175);Object(r.orchestrator)(C,function(e){return Object(s.__awaiter)(void 0,void 0,void 0,function(){var t,n,r,a,i,c,o,l,f,b,O;return Object(s.__generator)(this,function(m){switch(m.label){case 0:if(t=e.scenarioId,n=e.getFolderIdsData,r=e.dateRange,"DoesNotExist"===g(t))u(t);else if(function(e){return S(e).isInitializingCalendarEventsLoader}(t))return[2];m.label=1;case 1:m.trys.push([1,9,10,11]),a=Object(s.__values)(n.entries()),i=a.next(),m.label=2;case 2:return i.done?[3,8]:(c=Object(s.__read)(i.value,2),o=c[0],l=c[1],[4,Object(N.c)(N.a.Outlook,o)]);case 3:return m.sent(),Object(Q.h)(o)?[4,Object(N.c)(N.a.OutlookGroup)]:[3,5];case 4:m.sent(),m.label=5;case 5:return[4,J(t,{data:l,userId:o,dateRange:r})];case 6:m.sent(),m.label=7;case 7:return i=a.next(),[3,2];case 8:return[3,11];case 9:return f=m.sent(),b={error:f},[3,11];case 10:try{i&&!i.done&&(O=a.return)&&O.call(a)}finally{if(b)throw b.error}return[7];case 11:return y(t),d(!1,t),[2]}})})}),Object(r.orchestrator)(x,function(e){return Object(s.__awaiter)(void 0,void 0,void 0,function(){var t,n,r,a,i,u,d,l,f;return Object(s.__generator)(this,function(s){switch(s.label){case 0:return t=e.primarySmtpAddress,n=e.getFolderIdsData,r=e.scenarioId,a=w(t,r),i=I(r),[4,G(n)];case 1:return s.sent(),L(u=Y(n),a||[])?(d=V(u,i,r),l=d.canFetchAllEventsFromLocal,f=d.fetchPromise,o(l?"Loading":"Fetching",r),[4,f]):[2];case 2:return s.sent(),c(t,u,r),T(r),o("Loaded",r),[2]}})})}),Object(r.orchestrator)(M,function(e){return Object(s.__awaiter)(void 0,void 0,void 0,function(){var t,n,r,a,c,u;return Object(s.__generator)(this,function(d){switch(d.label){case 0:return t=e.dateRange,n=e.scenarioId,r=I(n),B(t,r)?(a=V(_(n),t,n),c=a.canFetchAllEventsFromLocal,u=a.fetchPromise,o(c?"Loading":"Fetching",n),i(null,n),[4,u]):[3,2];case 1:d.sent(),i(t,n),o("Loaded",n),d.label=2;case 2:return D(t,n),[2]}})})}),Object(r.orchestrator)(A,function(e){return Object(s.__awaiter)(void 0,void 0,void 0,function(){var t,n,r,a,c,u,d;return Object(s.__generator)(this,function(s){switch(s.label){case 0:return t=e.scenarioId,n=e.numberOfDays,r=I(t),a={start:r.start,end:Object(R.e)(r.end,n)},c=V(_(t),a,t),u=c.canFetchAllEventsFromLocal,d=c.fetchPromise,o(u?"Loading":"Fetching",t),[4,d];case 1:return s.sent(),i(a,t),o("Loaded",t),[2]}})})}),Object(r.orchestrator)(k,function(e){return Object(s.__awaiter)(void 0,void 0,void 0,function(){var t,n,r,a;return Object(s.__generator)(this,function(i){return t=e.scenarioId,n=e.parentFolderId,r=e.id,a=h(t),(0,Object(f.q)(a).fetchFullCalendarEvent)(r,n?n.Id:null),[2]})})});n.d(t,"g",function(){return C}),n.d(t,"b",function(){return y}),n.d(t,"l",function(){return x}),n.d(t,"j",function(){return T}),n.d(t,"i",function(){return D}),n.d(t,"h",function(){return k}),n.d(t,"k",function(){return M}),n.d(t,"c",function(){return A}),n.d(t,"e",function(){return g}),n.d(t,"f",function(){return I}),n.d(t,"d",function(){return E}),n.d(t,"a",function(){return F})},1299:function(e,t,n){"use strict";n.d(t,"f",function(){return u}),n.d(t,"g",function(){return d}),n.d(t,"h",function(){return s}),n.d(t,"b",function(){return l});var r=n(22),a=n(938);n.d(t,"a",function(){return a.l}),n.d(t,"c",function(){return a.m}),n.d(t,"e",function(){return a.n});var i=n(1112);n.d(t,"i",function(){return i.b});var c=n(1322);n.d(t,"d",function(){return c.a});var o=new r.c(function(){return Promise.all([n.e(3),n.e(4),n.e(5),n.e(6),n.e(465)]).then(n.bind(null,2850))}),u=new r.a(o,function(e){return e.launchInAppFeedback}),d=new r.b(o,function(e){return e.postSuggestionAndSendLogDatapoint}),s=new r.b(o,function(e){return e.showUserVoiceSuggestionDialog}),l=Object(r.d)(o,function(e){return e.UserVoiceNps})},1322:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(2),a=Object(r.action)("DEACTIVATE_HELP_CHARM")},1341:function(e,t,n){"use strict";var r=n(105),a=n(110),i=n(804);function c(){return(!Object(i.u)()||!window.opener)&&(Object(r.e)("cal-time-panel")&&!Object(a.f)().SessionSettings.IsShadowMailbox)}var o=n(2),u=Object(o.action)("openTimePanel",function(e){return{source:e}}),d=Object(o.action)("popView");n.d(t,"a",function(){return c}),n.d(t,"b",function(){return u}),n.d(t,"c",function(){return d})},1550:function(e,t,n){"use strict";var r=n(1242),a=n(1569),i=(n(1570),n(7));var c=function(e,t){return Object(i.ub)(e.Start)<Object(i.ub)(t.End)&&Object(i.ub)(e.End)>Object(i.ub)(t.Start)},o=function(e,t){return t.filter(function(t){return t!=e&&c(e,t)}).sort(r.a)};function u(e,t){var n,r,a,c,o;e.Start=t.Start,e.ItemId=t.ItemId,e.End=t.End,e.CalendarItemType="ThisAndFollowingInstancesMaster",e.Recurrence.RecurrenceRange.StartDate=(r=(n=t).StartTimeZoneId,a=n.Start,c=Object(i.Lb)(r,a),o=Object(i.Rb)(c),Object(i.pb)(o))}var d=n(1167);function s(e){e.Start=Object(i.Lb)(e.StartTimeZoneId,e.Start),e.End=Object(i.Lb)(e.EndTimeZoneId,e.End)}n.d(t,"a",function(){return r.a}),n.d(t,"b",function(){return a.a}),n.d(t,"c",function(){return o}),n.d(t,"d",function(){return u}),n.d(t,"e",function(){return c}),n.d(t,"f",function(){return d.a}),n.d(t,"g",function(){return s})},1569:function(e,t,n){"use strict";var r=n(1570);t.a=function(e,t){return Object(r.a)(e.FreeBusyType)-Object(r.a)(t.FreeBusyType)}},1570:function(e,t,n){"use strict";t.a=function(e){switch(e){case"OOF":return 0;case"Busy":return 1;case"Tentative":return 2;case"WorkingElsewhere":return 3;case"Free":return 4;default:return 5}}},1622:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(22),a=new r.c(function(){return n.e(461).then(n.bind(null,3129))}),i=new r.a(a,function(e){return e.updateUserConfigurationService})},1666:function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"b",function(){return c}),n.d(t,"e",function(){return o}),n.d(t,"h",function(){return u}),n.d(t,"f",function(){return d}),n.d(t,"c",function(){return s}),n.d(t,"i",function(){return l}),n.d(t,"j",function(){return f}),n.d(t,"g",function(){return b}),n.d(t,"d",function(){return O});var r=n(22),a=new r.c(function(){return Promise.all([n.e(587),n.e(28),n.e(72),n.e(443)]).then(n.bind(null,3364))}),i=Object(r.d)(a,function(e){return e.TimePanel}),c=Object(r.d)(a,function(e){return e.TimePanelHeaderBar}),o=new r.a(a,function(e){return e.preloadTimePanelData}),u=new r.a(a,function(e){return e.openEventDetailsView}),d=new r.a(a,function(e){return e.openAttendeeTrackingView}),s=new r.a(a,function(e){return e.closeAttendeeTrackingView}),l=new r.a(a,function(e){return e.openTasksView}),f=new r.a(a,function(e){return e.openCalendarView}),b=new r.a(a,function(e){return e.openConflictsView}),O=new r.a(a,function(e){return e.closeConflictsView});new r.a(a,function(e){return e.openEventQuickComposeView})},1754:function(e,t,n){"use strict";var r=n(836);n.d(t,"a",function(){return r.a});var a=n(815);n.d(t,"c",function(){return a.a});var i=n(919);n.d(t,"b",function(){return i.b})},1786:function(e){e.exports={c:"Hea",f:"Iea",e:"Jea",b:"Kea",g:"Lea",a:"Mea",d:"Nea"}},1815:function(e,t,n){"use strict";n.d(t,"a",function(){return u}),n.d(t,"e",function(){return d});var r=n(22),a=n(2414);n.d(t,"b",function(){return a.a});var i=n(2247);n.d(t,"d",function(){return i.a});n(2337);var c=n(2338);n.d(t,"c",function(){return c.a});var o=new r.c(function(){return Promise.all([n.e(5),n.e(7),n.e(8),n.e(11),n.e(159)]).then(n.bind(null,4732))}),u=Object(r.d)(o,function(e){return e.NotesEditor}),d=new r.a(o,function(e){return e.openNotesEditor})},1891:function(e,t,n){"use strict";var r=n(2),a=Object(r.action)("UPDATE_SELECTED_CALENDARS_IN_STORE",function(e,t){return{calendarIds:e,primarySmtpAddress:t}}),i=Object(r.action)("ADD_SELECTED_CALENDAR_IN_STORE",function(e,t){return{calendarId:e,primarySmtpAddress:t}}),c=n(1265),o=n(997);Object(r.mutator)(a,function(e){var t=e.calendarIds,n=e.primarySmtpAddress;Object(c.a)().selectedCalendars.set(n,Object(o.b)(t))});var u=n(0),d=n(2135);function s(e){var t=Object(d.a)().get(e);return t||[]}Object(r.mutator)(i,function(e){var t=e.calendarId,n=e.primarySmtpAddress;Object(c.a)().selectedCalendars.set(n,Object(o.b)(Object(u.__spread)(s(n),[t])))});var l=Object(r.action)("UPDATE_SELECTED_CALENDARS",function(e,t){return{calendarIds:e,primarySmtpAddress:t}}),f=Object(r.action)("ADD_SELECTED_CALENDAR",function(e,t){return{calendarId:e,primarySmtpAddress:t}}),b=(Object(r.action)("INITIALIZE_SELECTED_CALENDARS",function(e,t){return{calendarIds:e,primarySmtpAddress:t}}),Object(r.action)("SELECTED_CALENDARS_UPDATED",function(e,t){return{calendarIds:e,primarySmtpAddress:t}})),O=n(175),m=n(25),v=n(1622),p="OWA.ViewStateConfiguration";function j(e,t){var n=Object(O.e)(t);e&&v.a.importAndExecute(p,{Type:"String",Value:["SelectedCalendarsDesktop"]},{Type:"StringArray",Value:Object(o.b)(e)},n).catch(function(e){m.d.warn("Could not save new selected calendars list to user configuration")})}Object(r.orchestrator)(l,function(e){var t=e.calendarIds,n=e.primarySmtpAddress;a(t,n),b(t,n),j(t,n)}),Object(r.orchestrator)(f,function(e){var t=e.calendarId,n=e.primarySmtpAddress;i(t,n);var r=s(n);b(r,n),j(r,n)});var h=n(110);Object(r.mutator)(h.t,function(e){var t=e.userConfiguration,n=e.primarySmtpAddress;Object(c.a)().selectedCalendars.set(n||Object(O.e)().primarySmtpAddress,Object(o.b)(t.ViewStateConfiguration.SelectedCalendarsDesktop))}),n.d(t,"d",function(){return l}),n.d(t,"a",function(){return f}),n.d(t,"c",function(){return b}),n.d(t,"b",function(){return s})},1899:function(e,t,n){"use strict";var r=n(2);t.a=Object(r.action)("SHOW_QUICK_OPTIONS",function(){return{}})},1960:function(e,t,n){"use strict";var r=n(0),a=n(2),i=n(30),c=Object(a.action)("toggleShowDeclinedEventsMode",function(e,t){return Object(i.a)({name:"ToggleShowDeclinedEventsMode",customData:{CurrentDateRangeType:t,ShowDeclinedEventsMode:e}},{isDeclinedEventsMode:e,dateRangeType:t})}),o=c,u=n(60),d=n(396),s=n(1622);Object(a.orchestrator)(c,function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var t,n;return Object(r.__generator)(this,function(a){return t=e.isDeclinedEventsMode,n=Object(u.a)(),Object(d.a)(Object(r.__assign)(Object(r.__assign)({},n),{ViewStateConfiguration:Object(r.__assign)(Object(r.__assign)({},n.ViewStateConfiguration),{CalendarViewShowDeclinedMeetings:t})})),s.a.importAndExecute("OWA.ViewStateConfiguration",{Type:"String",Value:["CalendarViewShowDeclinedMeetings"]},{Type:"Boolean",Value:[""+t]}),[2]})})});var l=n(110),f=n(105);function b(){return!!Object(f.e)("cal-surface-declinedMeetings")&&Object(l.f)().ViewStateConfiguration.CalendarViewShowDeclinedMeetings}n.d(t,"a",function(){return b}),n.d(t,"b",function(){return o})},1997:function(e,t,n){"use strict";var r=n(0),a=n(2),i=Object(a.action)("LOAD_WORKLOAD_SCENARIO_SETTINGS",function(e){return void 0===e&&(e=null),{accountSmtpAddress:e}}),c=Object(a.action)("WORKLOAD_SCENARIO_SETTINGS_LOADED",function(e,t){return{settings:e,accountSmtpAddress:t}}),o=Object(a.action)("LOADING_WORKLOAD_SCENARIO_SETTINGS_FAILED",function(e){return{accountSmtpAddress:e}}),u=n(277),d=n(174);function s(e){switch(e){case 1:return"Mail";case 2:return"Calendar";case 64:return"FilesHub";case 4:return"People";default:throw new Error("getWorkloadScenarioType: The workload type is not supported")}}var l="ows/beta/ScenarioSettings";var f=71;function b(e){return 0!=(e&f)}var O=n(862);function m(e){return Object(r.__awaiter)(this,void 0,void 0,function(){var t,n,a,i,c=this;return Object(r.__generator)(this,function(o){return t=["Owa"],b(n=Object(O.b)())&&(a=s(n),t.push(a)),i=function(e){var t=e.join(",");return l+"/?Scenarios="+t}(t),[2,Object(u.b)(e).then(function(e){return Object(r.__awaiter)(c,void 0,void 0,function(){var t,n;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return[4,Object(d.b)(i,void 0,void 0,e,!0,void 0,"GET_WORKLOAD_SCENARIO_SETTINGS")];case 1:return t=r.sent(),n={timePanelSelectedView:null,timePanelCalendarIds:[],timePanelSelectedCalendarView:null},t.settings&&t.settings.forEach(function(e){var t;(t=e).calendarIds&&"TimePanelCalendarIds"===t.settingName?n.timePanelCalendarIds=e.calendarIds:!function(e){return!!e.selectedView&&"TimePanelSelectedView"===e.settingName}(e)?function(e){return!!e.selectedView&&"SelectedCalendarListView"===e.settingName}(e)&&(n.timePanelSelectedCalendarView=e.selectedView):n.timePanelSelectedView=e.selectedView}),[2,n]}})})})]})})}var v=n(1105),p=Object(v.b)({maximumAttempts:3,timeBetweenRetryInMS:Object(v.a)(1e4)}),j=null;Object(a.orchestrator)(i,function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var t,n;return Object(r.__generator)(this,function(r){switch(r.label){case 0:t=e.accountSmtpAddress,r.label=1;case 1:return r.trys.push([1,3,,4]),j&&j.cancel(),[4,(j=p(function(){return m(t)})).retriableFunc()];case 2:return n=r.sent(),c(n,t),[3,4];case 3:return r.sent(),o(t),[3,4];case 4:return j=null,[2]}})})});function h(e,t){return l+"/"+e+"/"+t}function g(e){return Object(r.__awaiter)(this,void 0,void 0,function(){var t,n,a,i;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return b(t=Object(O.b)())?(n=s(t),a=h(n,"TimePanelSelectedView"),i={ViewType:e},[4,Object(d.c)(a,i,void 0,void 0,void 0,!0,void 0)]):[3,2];case 1:r.sent(),r.label=2;case 2:return[2]}})})}function I(e,t){return Object(r.__awaiter)(this,void 0,void 0,function(){var t,n;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return t=h("Owa","TimePanelCalendarIds"),n={CalendarIds:e},[4,Object(d.c)(t,n,void 0,void 0,void 0,!0,void 0)];case 1:return r.sent(),[2]}})})}function w(e){return Object(r.__awaiter)(this,void 0,void 0,function(){var t,n,a,i;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return b(t=Object(O.b)())?(n=s(t),a=h(n,"SelectedCalendarListView"),i={ViewType:e},[4,Object(d.c)(a,i,void 0,void 0,void 0,!0,void 0)]):[3,2];case 1:r.sent(),r.label=2;case 2:return[2]}})})}n.d(t,"a",function(){return i}),n.d(t,"e",function(){return c}),n.d(t,"d",function(){return g}),n.d(t,"c",function(){return I}),n.d(t,"b",function(){return w})},2135:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(1265),a=n(997);function i(){return Object(a.c)(Object(r.a)().selectedCalendars)}},2177:function(e,t,n){"use strict";function r(e){var t=0,n=[];function r(){t-=1,n.length>0&&n.shift()()}return{add:function(a){return new Promise(function(i,c){var o=function(){t+=1,a().then(function(e){r(),i(e)},function(e){r(),c(e)})};t===e?n.push(o):o()})},getRunningCount:function(){return t},getQueueLength:function(){return n.length}}}n.d(t,"a",function(){return r})},2247:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(2415);function a(e){return Object(r.a)().meetingIdToNotesViewStateMap.get(e.Id)}},2337:function(e,t,n){"use strict";var r=n(2);t.a=Object(r.action)("onNotifyOrganizerToggled",function(e,t){return{id:e,sendResponse:t}})},2338:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(2),a=Object(r.action)("forwardEvent",function(e,t,n,r,a){return{calendarEventId:e,notes:t,eventScope:r,actionSource:n,forwardees:a}})},2372:function(e,t,n){"use strict";var r=n(1997),a=n(2);function i(e,t){if(0===t.length)return null;t[t.length-1]=e}var c=n(862),o=Object(a.createStore)("timePanelSettingStore",{panelViewStack:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return{stack:e||[]}}(2!==Object(c.b)()?"Calendar":"Tasks")});Object(a.mutator)(r.e,function(e){var t=e.settings;t.timePanelSelectedView&&i(t.timePanelSelectedView,o().panelViewStack.stack)});var u=Object(a.action)("pushTimePanelView",function(e){return{newView:e}}),d=Object(a.action)("updateTopTimePanelView",function(e){return{updatedView:e}}),s=Object(a.action)("popTimePanelView");Object(a.mutator)(u,function(e){var t;t=e.newView,o().panelViewStack.stack.push(t)}),Object(a.mutator)(d,function(e){i(e.updatedView,o().panelViewStack.stack)}),Object(a.mutator)(s,function(){var e=o().panelViewStack;e.stack.pop()});var l=n(0),f=n(1105),b=n(25),O=Object(f.b)({maximumAttempts:3,timeBetweenRetryInMS:Object(f.a)(1e3)}),m=null;Object(a.orchestrator)(d,function(e){return Object(l.__awaiter)(void 0,void 0,void 0,function(){var t,n;return Object(l.__generator)(this,function(a){switch(a.label){case 0:if(t=e.updatedView,"Tasks"!==(i=t)&&"Calendar"!==i)return[3,5];a.label=1;case 1:return a.trys.push([1,3,,4]),m&&m.cancel(),[4,(m=O(function(){return Object(r.d)(t)})).retriableFunc()];case 2:return a.sent(),[3,4];case 3:return n=a.sent(),b.d.warn("viewStackOrchestrator: updateTimePanelSelectedViewService with retry failed: "+n),[3,4];case 4:m=null,a.label=5;case 5:return[2]}var i})})});var v={Conflicts:"Calendar",EventDetails:"Calendar",AttendeeTracking:"Calendar",Calendar:"Calendar",ComposeForm:"Calendar",Tasks:"Tasks"};function p(e){return e?v[e]:null}function j(){return p(h())}function h(){var e,t=o().panelViewStack;return 0===(e=t.stack).length?null:e[e.length-1]}function g(){return o().panelViewStack.stack.length}function I(){return-1!==o().panelViewStack.stack.indexOf("Conflicts")}function w(){return-1!==o().panelViewStack.stack.indexOf("AttendeeTracking")}function _(){var e=o().panelViewStack;return g()>=2?e.stack[g()-2]:null}n.d(t,"i",function(){return u}),n.d(t,"j",function(){return d}),n.d(t,"h",function(){return s}),n.d(t,"b",function(){return j}),n.d(t,"a",function(){return h}),n.d(t,"e",function(){return g}),n.d(t,"g",function(){return I}),n.d(t,"f",function(){return w}),n.d(t,"d",function(){return _}),n.d(t,"c",function(){return p})},2412:function(e){e.exports={c:"Lbb",e:"Mbb",f:"Nbb",d:"Obb",b:"Pbb",g:"Qbb",a:"Rbb",j:"Sbb",h:"Tbb",i:"Ubb"}},2413:function(e){e.exports={a:"Vbb",b:"Wbb"}},2414:function(e,t,n){"use strict";var r=n(2415),a=n(43);t.a=Object(a.action)("closeNotesEditor")(function(e){Object(r.a)().meetingIdToNotesViewStateMap.delete(e.Id)})},2415:function(e,t,n){"use strict";var r=n(6),a=n(2),i=Object(a.createStore)("calendarNotesEditorStore",{meetingIdToNotesViewStateMap:new r.ObservableMap});t.a=i},2468:function(e,t,n){"use strict";n.d(t,"d",function(){return u}),n.d(t,"b",function(){return d}),n.d(t,"a",function(){return s}),n.d(t,"f",function(){return l}),n.d(t,"e",function(){return f}),n.d(t,"c",function(){return b}),n.d(t,"j",function(){return O}),n.d(t,"g",function(){return m}),n.d(t,"i",function(){return v}),n.d(t,"h",function(){return p});var r=n(3333),a=n(2919),i=n(30),c=n(2),o=n(4111),u=Object(c.action)("openTimePanelInternal",function(e){return{source:e}}),d=Object(c.action)("initializeTelemetryData"),s=Object(c.action)("clearTelemetryData"),l=Object(c.action)("timePanelOpened",function(){return Object(i.a)({name:"timePanelActionOpen",options:o.b,customData:Object(o.a)({source:Object(a.b)(),owa_1:Object(a.b)()})})}),f=Object(c.action)("timePanelClosed",function(){var e=Object(r.b)(),t=Object(r.a)(e);return Object(i.a)({name:"timePanelActionClose",options:o.b,customData:Object(o.a)({sessionDuration:e,owa_1:t.lowerBoundMinutes,owa_2:t.upperBoundMinutes})})}),b=Object(c.action)("openDeeplink",function(e){return Object(i.a)({name:"timePanelActionDeeplink",options:o.b,customData:Object(o.a)({target:e,owa_1:e})})}),O=Object(c.action)("updateSelectedCalendarEvent",function(e){return{selectedCalendarEventId:e}}),m=Object(c.action)("pushNewView",function(e){return{newView:e}}),v=Object(c.action)("updateCurrentView",function(e){return{updatedView:e}}),p=Object(c.action)("resetPanelViewOpenTimeStamp")},2562:function(e,t,n){"use strict";n.d(t,"a",function(){return I});var r=n(0),a=n(774),i=n.n(a),c=n(2406),o=n.n(c),u=n(2408),d=n.n(u),s=n(818),l=n.n(s),f=n(7),b=n(239),O=n(761),m=n(277),v=n(2177),p="X-OWA-ExplicitLogonUser",j="X-AnchorMailbox",h=6,g=null;function I(e,t,n,a,c,u){return void 0===n&&(n=Object(O.a)("calendar")),Object(r.__awaiter)(this,void 0,void 0,function(){var s,O;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return s=null,c?(s={headers:(O={},O[p]=c,O[j]=c,O)},[3,3]):[3,1];case 1:return a?[4,Object(m.e)(a.mailboxInfo)]:[3,3];case 2:s=r.sent(),r.label=3;case 3:return g||(g=Object(v.a)(h)),[2,g.add(function(){return o()({Header:Object(b.getJsonRequestHeader)(),Body:d()({CalendarId:l()({BaseFolderId:i()({Id:n})}),RangeStart:Object(f.mb)(e),RangeEnd:Object(f.mb)(t),IncludeDeclinedMeetings:u})},s).then(function(e){return e.Body})})]}})})}},260:function(e,t,n){"use strict";var r=n(2),a=n(6),i={calendarEntryMapping:new a.ObservableMap,calendarFolderMapping:new a.ObservableMap,calendarItemIdToChangeKey:new a.ObservableMap,folderIdToCalendarId:new a.ObservableMap,validEntryMapping:new a.ObservableMap,calendarGroupsMapping:new a.ObservableMap,defaultCalendars:new a.ObservableMap},c=Object(r.createStore)("calendarsCacheStore",i),o=n(0),u=Object(r.action)("initializeCalendarsCacheInStore",function(e,t,n,r,a,i){return{defaultCalendarEntry:e,calendarEntries:t,calendarFolders:n,calendarGroups:r,folderIdMapping:a,calendarIdToChangeKeyMapping:i}}),d=Object(r.action)("updateChangeKeyByCalendarItemId",function(e){return{itemId:e}}),s=Object(r.action)("addToCalendarsCache",function(e,t,n){return{calendarEntry:e,folder:t,mailboxInfo:n}}),l=Object(r.action)("addCalendarGroupToCalendarsCache",function(e){return{calendarGroup:e}}),f=Object(r.action)("updateCalendarEntry",function(e,t){return{itemId:e,calendarEntry:t}}),b=Object(r.action)("updateCalendarFolder",function(e,t){return{calendar:e,calendarFolder:t}}),O=Object(r.action)("removeCalendarFromCalendarsCache",function(e){return{calendar:e}}),m=Object(r.action)("markCalendarEntryAsValid",function(e){return{calendarEntry:e}}),v=Object(r.action)("calendarUpdated",function(e,t){return{calendarId:e,updates:t}}),p=Object(r.action)("groupAssociationChanged",function(e){return{payload:e}}),j=Object(r.action)("removeCalendarWithIDFromCalendarsCache",function(e){return{calendarId:e}});function h(e){if(void 0!==e.CalendarFolderId)return e.CalendarFolderId;var t=e;return t.IsGeneralScheduleCalendar?{Id:t.OwnerEmailAddress,ChangeKey:""}:t.SharedFolderId?{Id:t.SharedFolderId.Id,ChangeKey:null!=t.SharedFolderId.ChangeKey?t.SharedFolderId.ChangeKey:""}:null}Object(r.mutator)(d,function(e){var t=e.itemId,n=t.Id,r=t.ChangeKey;c().calendarItemIdToChangeKey.set(n,r)}),Object(r.mutator)(f,function(e){var t=e.itemId.Id,n=e.calendarEntry,r=c().calendarEntryMapping.get(t),a=(n.ItemId,Object(o.__rest)(n,["ItemId"]));r&&Object.keys(a).forEach(function(e){r[e]=a[e]})}),Object(r.mutator)(m,function(e){var t=e.calendarEntry;c().validEntryMapping.set(t.ItemId.Id,!0)});var g=n(175);function I(e){return e||(e=Object(g.e)().primarySmtpAddress),c().defaultCalendars.get(e)}function w(){var e=c().calendarEntryMapping;return Object(o.__spread)(e.values())}function _(){return w().map(function(e){return y(e.id.id)}).filter(function(e){return e})}function S(){var e=c().calendarGroupsMapping;return Object(o.__spread)(e.values())}function E(e){return c().folderIdToCalendarId.get(e)}function C(e){return c().calendarEntryMapping.get(e)}function y(e){var t=C(e);return t?{id:{id:e,mailboxInfo:Object(o.__assign)({},t.id.mailboxInfo)},calculatedFolderId:P(e),displayName:t.CalendarName,colorScheme:null}:null}function x(e){return c().calendarFolderMapping.get(e.id.id)}function T(e){return C(e.id.id)}function D(e){var t=E(e);return t?C(t.id):void 0}function k(e){var t=c().calendarFolderMapping,n=E(e);return n?t.get(n.id):void 0}function M(e){return c().calendarItemIdToChangeKey.get(e)}function A(e){return N(e.id.id)}function N(e){var t=c().calendarFolderMapping.get(e);return t&&(t.FolderId||t.DistinguishedFolderId)?t.FolderId?t.FolderId.Id:t.DistinguishedFolderId:P(e)}function P(e){var t=c().calendarEntryMapping.get(e);if(t){var n=h(t);return n?n.Id:null}return null}function V(e){var t=c(),n=t.folderIdToCalendarId,r=t.calendarEntryMapping,a=n.get(e);if(a){var i=r.get(a.id);return!i.IsGroupMailboxCalendar&&null!=i.CalendarFolderId}return!1}function L(e){if(V(e)){var t=D(e);return t&&t.IsReadOnly}return!1}function F(e){var t=c().validEntryMapping;return e&&t.get(e.ItemId.Id)}function R(e){return!V(N(e))&&!F(C(e))}function B(e){var t,n=c(),r=n.folderIdToCalendarId,a=n.calendarEntryMapping,i=r.get(e);i?t=a.get(i.id):t=Object(o.__spread)(a.values()).filter(function(t){return t.OwnerEmailAddress&&t.OwnerEmailAddress.toLowerCase()==e.toLowerCase()})[0];return t}function q(e,t){return t+"_"+e}function H(e,t){Object.keys(t).forEach(function(n){return e.set(n,t[n])})}function W(e,t){var n=c();n.calendarItemIdToChangeKey.delete(e),n.calendarEntryMapping.delete(e),n.calendarFolderMapping.delete(e),t&&n.folderIdToCalendarId.delete(t)}function Y(e){var t=E(e);return t?t.mailboxInfo:null}function U(e){var t=x(e),n=T(e);return t&&n&&!n.IsReadOnly&&t.EffectiveRights&&t.EffectiveRights.CreateContents}Object(r.mutator)(u,function(e){var t=e.defaultCalendarEntry;t&&c().defaultCalendars.set(t.id.mailboxInfo.primarySmtpAddress,t)}),Object(r.mutator)(u,function(e){var t=e.calendarEntries;H(c().calendarEntryMapping,t)}),Object(r.mutator)(u,function(e){var t=e.calendarFolders;H(c().calendarFolderMapping,t)}),Object(r.mutator)(u,function(e){var t=e.folderIdMapping;H(c().folderIdToCalendarId,t)}),Object(r.mutator)(u,function(e){var t=e.calendarIdToChangeKeyMapping;H(c().calendarItemIdToChangeKey,t)}),Object(r.mutator)(u,function(e){var t=e.calendarGroups;H(c().calendarGroupsMapping,t)}),Object(r.mutator)(s,function(e){var t=e.calendarEntry,n=e.folder,r=e.mailboxInfo,a=c();a.calendarItemIdToChangeKey.set(t.ItemId.Id,t.ItemId.ChangeKey);var i=Object(o.__assign)(Object(o.__assign)({},t),{id:{id:t.ItemId.Id,mailboxInfo:r}});a.calendarEntryMapping.set(t.ItemId.Id,i),a.calendarFolderMapping.set(t.ItemId.Id,n),n.FolderId?a.folderIdToCalendarId.set(n.FolderId.Id,{id:t.ItemId.Id,mailboxInfo:r}):n.DistinguishedFolderId&&a.folderIdToCalendarId.set(n.DistinguishedFolderId,{id:t.ItemId.Id,mailboxInfo:r})}),Object(r.mutator)(l,function(e){var t=e.calendarGroup,n=c(),r=q(t.id.mailboxInfo.primarySmtpAddress,t.GroupId);n.calendarGroupsMapping.set(r,t)}),Object(r.mutator)(O,function(e){var t=e.calendar;W(t.id.id,t.calculatedFolderId?t.calculatedFolderId:null)}),Object(r.mutator)(j,function(e){var t=e.calendarId;W(t,N(t))}),Object(r.mutator)(b,function(e){var t=e.calendar,n=e.calendarFolder,r=x(t);Object.keys(n).forEach(function(e){r[e]=n[e]})});var z=n(397),G=n(60);function J(e,t){var n=T(e);if(Object(z.c)(n)){var r=n;return!r.IsOwnerEmailAddressInvalid&&r.OwnerEmailAddress==t}return e.id&&e.id.mailboxInfo?t.indexOf(e.id.mailboxInfo.primarySmtpAddress)>=0:Object(G.a)().SessionSettings.UserEmailAddress==t}function Q(e){return e?e.map(y).filter(function(e){return!!e}):null}n.d(t,"z",function(){return u}),n.d(t,"K",function(){return d}),n.d(t,"b",function(){return s}),n.d(t,"a",function(){return l}),n.d(t,"I",function(){return f}),n.d(t,"J",function(){return b}),n.d(t,"G",function(){return O}),n.d(t,"F",function(){return m}),n.d(t,"d",function(){return v}),n.d(t,"y",function(){return p}),n.d(t,"H",function(){return j}),n.d(t,"u",function(){return I}),n.d(t,"i",function(){return w}),n.d(t,"e",function(){return _}),n.d(t,"r",function(){return S}),n.d(t,"s",function(){return E}),n.d(t,"k",function(){return C}),n.d(t,"h",function(){return y}),n.d(t,"n",function(){return x}),n.d(t,"j",function(){return T}),n.d(t,"m",function(){return D}),n.d(t,"o",function(){return k}),n.d(t,"t",function(){return M}),n.d(t,"p",function(){return A}),n.d(t,"v",function(){return N}),n.d(t,"g",function(){return P}),n.d(t,"B",function(){return V}),n.d(t,"C",function(){return L}),n.d(t,"D",function(){return F}),n.d(t,"c",function(){return R}),n.d(t,"l",function(){return B}),n.d(t,"f",function(){return h}),n.d(t,"w",function(){return Y}),n.d(t,"q",function(){return q}),n.d(t,"E",function(){return U}),n.d(t,"A",function(){return J}),n.d(t,"x",function(){return Q})},2919:function(e,t,n){"use strict";n.d(t,"c",function(){return a}),n.d(t,"b",function(){return i}),n.d(t,"a",function(){return c});var r=n(3332);function a(){return Object(r.a)().isPanelOpen}function i(){return Object(r.a)().source}function c(){return Object(r.a)().selectedCalendarItemId}},2950:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(60),a=n(7);function i(e){var t=Object(a.Kb)();if(Object(a.Db)(t,e))return Object(a.f)(Object(a.Sb)(t),1);var n=Object(r.a)().UserOptions.WorkingHours;return Object(a.h)(Object(a.Rb)(e),n.WorkHoursStartTimeInMinutes)}},3052:function(e,t,n){"use strict";var r;function a(e){var t=e.getCalendarFolders;return r=t,e}function i(){var e=r;return r=void 0,e}n.d(t,"b",function(){return a}),n.d(t,"a",function(){return i})},3214:function(e,t,n){"use strict";n.d(t,"a",function(){return c}),n.d(t,"c",function(){return o}),n.d(t,"b",function(){return u});var r=n(0),a=n(175),i=n(1023),c={width:1095,height:640};function o(e,t,n){if(e){var i=Object(a.e)();u(Object(r.__assign)({ItemId:Object(r.__assign)({mailboxInfo:i},e)},t),n,0)}}function u(e,t,n){Object(i.c)("calendar","compose",{event:e,composeEntrySource:t},c)}},3256:function(e,t,n){"use strict";var r=n(2),a=Object(r.action)("updateUpNextEvent",function(e,t){return{id:e,scenarioId:t}}),i={scenarios:new(n(6).ObservableMap)},c=Object(r.createStore)("UpNextStore",i);Object(r.mutator)(a,function(e){c().scenarios.set(e.scenarioId,e.id)});var o=n(0),u=n(1275),d=(Object(r.action)("cancelRefreshUpNextPoll",function(e){return{scenarioId:e}}),Object(r.action)("onUpNextEventUpdated",function(e,t,n){return{id:e,parentFolderId:t,scenarioId:n}})),s=Object(r.action)("initializeUpNextEventLoader",function(e,t){return{getFolderIdsData:e,scenarioId:t}}),l=n(7);function f(){var e=Object(l.ec)(),t=Object(l.e)(e,1);return{start:e,end:Object(l.A)(t)}}var b=n(780),O=n(1142),m=n(1550),v=n(41);function p(e,t){void 0===t&&(t=!1);var n=Object(l.Kb)(),r=Object(o.__spread)(e);return t||r.sort(m.a),function(e,t){if(!e||0===e.length)return null;var n=e.filter(j(t));if(0===n.length)return null;if(1===n.length)return n[0];return n.reduce(function(e,n){if(0===e.length)return[n];var r=h(e[0].Start,t),a=h(n.Start,t);return a<r?[n]:a===r?(e.push(n),e):e},[]).sort(m.b)[0]}(r,n)}function j(e){return function(t){var n=Object(l.Bb)(t.End,e),r=Object(l.w)(t.End,t.Start)>v.c,a=!Object(O.c)(t),i=Object(b.t)(t);return!n&&!r&&!t.IsAllDayEvent&&!t.IsCancelled&&!t.IsDraft&&"Decline"!==t.ResponseType&&a&&i}}function h(e,t){return Math.abs(Object(l.w)(e,t))}var g=n(998);function I(e){var t=f();return Object(u.d)(e,t).filter(Object(g.d)(t))}var w=n(364);function _(e){return c().scenarios.get(e)}function S(e){var t=_(e);return t?function(e,t){return I(e).filter(function(e){return e.ItemId.Id===t.Id})[0]||null}(e,t):null}function E(e){var t=S(e);if(!t)return{upNextEvent:null,conflictingEvents:[]};var n=I(e).filter(function(e){return function(e,t){var n=Object(w.f)();return t.ItemId.Id!==e.ItemId.Id&&Object(m.e)(t,e)&&!Object(l.zb)(t.Start,e.Start)&&j(n)(t)}(t,e)});return{upNextEvent:t,conflictingEvents:n}}function C(e){return c().scenarios.has(e)}function y(){return Object(o.__spread)(c().scenarios.keys())}function x(e){return Object(o.__awaiter)(this,void 0,void 0,function(){var t,n;return Object(o.__generator)(this,function(r){return t=function(e){return p(I(e),!0)}(e),n=t?t.ItemId:null,_(e)===n?[2]:(a(n,e),d(n,t?t.ParentFolderId:null,e),[2])})})}var T=n(832);Object(r.orchestrator)(T.b,function(){D()}),Object(r.orchestrator)(T.c,function(){D()}),Object(r.orchestrator)(T.a,function(){D()});function D(){y().forEach(x)}Object(r.orchestrator)(s,function(e){var t=e.getFolderIdsData,n=e.scenarioId,r=f();C(n)||a(null,n),Object(u.g)(t,r,n)});var k=n(4228);Object(r.orchestrator)(u.b,function(e){return Object(o.__awaiter)(void 0,void 0,void 0,function(){var t;return Object(o.__generator)(this,function(n){switch(n.label){case 0:return C(t=e.scenarioId)?[4,x(t)]:[3,2];case 1:n.sent(),Object(k.b)(function(){return function(e){return Object(o.__awaiter)(this,void 0,void 0,function(){return Object(o.__generator)(this,function(t){switch(t.label){case 0:return[4,x(e)];case 1:return t.sent(),[2,null]}})})}(t)},t,1e4),n.label=2;case 2:return[2]}})})});Object(r.orchestrator)(u.i,function(e){var t=e.scenarioId;C(t)&&x(t)}),Object(r.orchestrator)(w.h,function(){y().forEach(function(e){return Object(u.k)(f(),e)})}),Object(r.orchestrator)(u.j,function(e){var t=e.scenarioId;C(t)&&x(t)});n.d(t,"f",function(){return d}),n.d(t,"e",function(){return s}),n.d(t,"g",function(){return u.l}),n.d(t,"b",function(){return S}),n.d(t,"c",function(){return _}),n.d(t,"d",function(){return E}),n.d(t,"a",function(){return u.a})},3332:function(e,t,n){"use strict";var r=n(2),a=Object(r.createStore)("timePanelStore",{sessionId:"",panelOpenTimestamp:null,panelViewOpenTimestamp:null,source:null,isPanelOpen:!1,selectedCalendarItemId:null});t.a=a},3333:function(e,t,n){"use strict";n.d(t,"c",function(){return c}),n.d(t,"b",function(){return o}),n.d(t,"d",function(){return u}),n.d(t,"a",function(){return d});var r=n(3332),a=n(7),i=n(361);function c(){return Object(r.a)().sessionId}function o(){var e=Object(r.a)().panelOpenTimestamp;return e?Object(a.w)(Object(a.Kb)(),e):null}function u(){var e=Object(r.a)().panelViewOpenTimestamp;return e?Object(a.w)(Object(a.Kb)(),e):null}function d(e){return e<=i.a.MillisecondsIn1Min?{lowerBoundMinutes:0,upperBoundMinutes:1}:e<=5*i.a.MillisecondsIn1Min?{lowerBoundMinutes:1,upperBoundMinutes:5}:e<=30*i.a.MillisecondsIn1Min?{lowerBoundMinutes:5,upperBoundMinutes:30}:e<=i.a.MillisecondsIn1Hour?{lowerBoundMinutes:30,upperBoundMinutes:60}:e<=2*i.a.MillisecondsIn1Hour?{lowerBoundMinutes:60,upperBoundMinutes:120}:e<=4*i.a.MillisecondsIn1Hour?{lowerBoundMinutes:120,upperBoundMinutes:240}:e<=i.a.MillisecondsInOneDay?{lowerBoundMinutes:240,upperBoundMinutes:1440}:{lowerBoundMinutes:1440,upperBoundMinutes:null}}},3338:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var r=n(0),a=n(1023),i=n(3214);function c(e,t,n,c){var o="read/"+encodeURIComponent(e);Object(a.c)("calendar",o,Object(r.__assign)(Object(r.__assign)({},n),{entrySource:t}),i.a,!1,t)}},3836:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(105),a=n(932);function i(){Object(r.e)("fwk-o365shellheader")?window.O365Shell.FlexPane.OpenFlexPaneForProvider("OwaTimePanel"):Object(a.c)(11)}},3939:function(e,t,n){"use strict";var r=n(2),a=Object(r.action)("updateSelectedCalendarView",function(e){return{updatedView:e}}),i=Object(r.createStore)("calendarListSettingsStore",{selectedView:"Agenda"});function c(){return i().selectedView}var o=Object(r.action)("updateSelectedCalendarViewInStore",function(e){return{updatedView:e}}),u=(Object(r.mutator)(o,function(e){var t=e.updatedView;i().selectedView=t}),n(0)),d=n(1997),s=n(1105),l=n(25),f=Object(s.b)({maximumAttempts:3,timeBetweenRetryInMS:Object(s.a)(1e3)}),b=null;Object(r.orchestrator)(a,function(e){return Object(u.__awaiter)(void 0,void 0,void 0,function(){var t,n;return Object(u.__generator)(this,function(r){switch(r.label){case 0:t=e.updatedView,o(t),r.label=1;case 1:return r.trys.push([1,3,,4]),b&&b.cancel(),[4,(b=f(function(){return Object(d.b)(t)})).retriableFunc()];case 2:return r.sent(),[3,4];case 3:return n=r.sent(),l.d.warn("updateSelectedCalendarViewOrchestrator: updateSelectedCalendarView with retry failed: "+n),[3,4];case 4:return b=null,[2]}})})});Object(r.orchestrator)(d.e,function(e){var t=e.settings;t.timePanelSelectedCalendarView&&o(t.timePanelSelectedCalendarView)});n.d(t,"b",function(){return a}),n.d(t,"a",function(){return c})},397:function(e,t,n){"use strict";var r="LinkedCalendarEntry:#Exchange";function a(e){return e.__type==r}function i(e){return e.CanViewPrivateItems}n.d(t,"c",function(){return a}),n.d(t,"a",function(){return r}),n.d(t,"b",function(){return i})},4111:function(e,t,n){"use strict";n.d(t,"b",function(){return c}),n.d(t,"a",function(){return o});var r=n(0),a=n(3333),i=n(228),c={isCore:!0,tenantTokens:Object(i.e)()};function o(e){return Object(r.__assign)(Object(r.__assign)({},e),{sessionId:Object(a.c)()})}},4228:function(e,t,n){"use strict";var r=n(2),a=Object(r.action)("poll",function(e,t,n){return{requestFunction:e,requestIdentifier:t,interval:n}}),i=Object(r.action)("responseRetrieved",function(e,t){return{response:e,responseIdentifier:t}}),c=Object(r.action)("cancelPoll",function(e){return{requestIdentifier:e}}),o={currentRequest:new(n(6).ObservableMap)},u=Object(r.createStore)("requestIdStore",o);Object(r.mutator)(c,function(e){var t=u().currentRequest.get(e.requestIdentifier);if(t){var n=t.timer;clearTimeout(n),t.timer=null}});var d=n(0),s=Object(r.mutatorAction)("setCurrentRequestId",function(e,t){var n=u().currentRequest.get(e);n?n.requestId=t:u().currentRequest.set(e,{requestId:t,timer:null})});function l(e,t){return u().currentRequest.get(e).requestId===t}function f(e,t){return Object(d.__awaiter)(this,void 0,void 0,function(){var n,r,a;return Object(d.__generator)(this,function(i){switch(i.label){case 0:return n=Math.random(),s(t,n),[4,e()];case 1:return r=i.sent(),a={isCurrent:l(t,n)},[2,Object(d.__assign)({response:r},a)]}})})}var b=Object(r.mutatorAction)("setPollTimer",function(e,t){var n=u().currentRequest.get(e);n&&(n.timer=t)});Object(r.orchestrator)(a,function(e){var t=e.requestFunction,n=e.requestIdentifier,r=e.interval;c(n);var o=setTimeout(function(){return function(e,t,n){return Object(d.__awaiter)(this,void 0,void 0,function(){var r;return Object(d.__generator)(this,function(c){switch(c.label){case 0:return[4,f(function(){return e()},t)];case 1:return(r=c.sent()).isCurrent&&i(r.response,t),a(e,t,n),[2]}})})}(t,n,r)},r);b(n,o)}),n.d(t,"b",function(){return a}),n.d(t,"c",function(){return i}),n.d(t,"a",function(){return c}),n.d(t,"d",function(){return f})},4235:function(e,t,n){"use strict";var r=n(2),a=Object(r.createStore)("moduleDndStore",{draggedItemType:null}),i=Object(r.action)("OWA_MODULE_SET_DRAGGED_ITEM_TYPE",function(e){return{typeOfItemDragged:e}});Object(r.mutator)(i,function(e){a().draggedItemType=e.typeOfItemDragged});function c(){return a().draggedItemType}n.d(t,"b",function(){return i}),n.d(t,"a",function(){return c})},4444:function(e,t,n){"use strict";var r=n(1341),a=n(2919),i=n(2),c=n(2468),o=n(3836),u=n(2372),d=n(1815);Object(i.orchestrator)(r.b,function(e){Object(r.a)()&&(Object(c.d)(e.source),Object(a.c)()||Object(o.a)())}),Object(i.orchestrator)(r.c,function(){"EventDetails"==Object(u.a)()&&Object(d.b)(Object(a.a)())})},4731:function(e,t,n){"use strict";var r=n(2),a=Object(r.action)("UPDATE_SELECTED_TIME_PANEL_CALENDARIDS",function(e,t){return{calendarIds:e,primarySmtpAddress:t}}),i=Object(r.action)("ON_SELECTED_TIME_PANEL_CALENDARIDS_UPDATED",function(e,t){return{calendarIds:e,primarySmtpAddress:t}}),c=n(0),o=n(6),u=Object(r.createStore)("timePanelSelectedCalendarIdsStore",{calendarIdsMap:new o.ObservableMap});function d(){var e,t,n=u().calendarIdsMap,r=0;try{for(var a=Object(c.__values)(n.values()),i=a.next();!i.done;i=a.next()){var o=i.value;o&&(r+=o.length)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=a.return)&&t.call(a)}finally{if(e)throw e.error}}return r>0}var s=n(1891),l=(Object(r.orchestrator)(s.c,function(e){var t=e.calendarIds,n=e.primarySmtpAddress;d()||i(t,n)}),n(1105)),f=n(1997),b=n(997),O=n(25),m=Object(l.b)({maximumAttempts:3,timeBetweenRetryInMS:Object(l.a)(1e3)}),v=null,p=(Object(r.orchestrator)(a,function(e){return Object(c.__awaiter)(void 0,void 0,void 0,function(){var t,n,r,a;return Object(c.__generator)(this,function(c){switch(c.label){case 0:t=e.calendarIds,n=e.primarySmtpAddress,r=Object(b.b)(t),c.label=1;case 1:return c.trys.push([1,3,,4]),v&&v.cancel(),[4,(v=m(function(){return Object(f.c)(r,n)})).retriableFunc()];case 2:return c.sent(),i(r,n),[3,4];case 3:return a=c.sent(),O.d.warn("updateSelectedCalendarIdsOrchestrator: updateTimePanelCalendarIdsService with retry failed: "+a),[3,4];case 4:return v=null,[2]}})})}),Object(r.mutator)(f.e,function(e){var t=e.settings,n=e.accountSmtpAddress;t.timePanelCalendarIds&&t.timePanelCalendarIds.length>0&&u().calendarIdsMap.set(n,Object(b.b)(t.timePanelCalendarIds))}),Object(r.mutator)(a,function(e){var t=e.calendarIds,n=e.primarySmtpAddress;u().calendarIdsMap.set(n,Object(b.b)(t))}),n(4768));function j(){return Object(c.__awaiter)(this,void 0,void 0,function(){var e;return Object(c.__generator)(this,function(t){switch(t.label){case 0:return d()?(e=Object(b.c)(u().calendarIdsMap),[2,Promise.resolve(e)]):[3,1];case 1:return[4,Object(p.a)()];case 2:return[2,t.sent()]}})})}function h(){return Object(c.__awaiter)(this,void 0,void 0,function(){var e;return Object(c.__generator)(this,function(t){switch(t.label){case 0:return e=b.d,[4,j()];case 1:return[2,e.apply(void 0,[t.sent()])]}})})}n.d(t,"c",function(){return i}),n.d(t,"b",function(){return j}),n.d(t,"a",function(){return h})},4768:function(e,t,n){"use strict";var r=n(0),a=n(175),i=n(260),c=n(2135),o=n(2373);function u(){return Object(r.__awaiter)(this,void 0,void 0,function(){var e,t,n,u;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return e=0,(t=Object(c.a)()).forEach(function(t,n){t&&(e+=t.length)}),0!=e?[3,2]:(n=Object(a.e)().primarySmtpAddress,[4,Object(o.c)(o.a.Outlook)]);case 1:r.sent(),(u=Object(i.u)(n))&&t.set(n,[u.id.id]),r.label=2;case 2:return[2,t]}})})}n.d(t,"a",function(){return u})},5038:function(e,t,n){"use strict";var r=n(2),a=n(1754),i=Object(r.createStore)("timePanelDndStore",{dropBoxDropViewState:Object(a.c)(),upNextDropViewState:Object(a.c)(),timePanelDropViewState:Object(a.c)(),calendarTabDropViewState:Object(a.c)(),tasksTabDropViewState:Object(a.c)(),lastDragOverCalendarTab:null,lastDragOverTasksTab:null,lastDragOverUpNext:null,shouldShowHoverDayDrop:!1,dayViewDropTimeMinuteOffset:null}),c=n(4235);function o(){return i().calendarTabDropViewState}function u(){return i().tasksTabDropViewState}function d(){return i().timePanelDropViewState}function s(){return i().dropBoxDropViewState}function l(){return o().draggableItemType===a.a.MailListRow||Object(c.a)()===a.a.MailListRow||d().draggableItemType===a.a.MailListRow}function f(){return u().draggableItemType===a.a.MailListRow||Object(c.a)()===a.a.MailListRow||d().draggableItemType===a.a.MailListRow}function b(){return i().lastDragOverCalendarTab}function O(){return i().lastDragOverTasksTab}function m(){return i().shouldShowHoverDayDrop}function v(){return i().dayViewDropTimeMinuteOffset}function p(){return i().lastDragOverUpNext}function j(){return i().upNextDropViewState}function h(){return i().upNextDropViewState&&(i().upNextDropViewState.draggableItemType===a.a.MailListRow||Object(c.a)()===a.a.MailListRow)}var g=n(30),I=n(228),w={isCore:!0,tenantTokens:Object(I.e)()};function _(e){return e}var S=Object(r.action)("setLastEnterCalendarTab",function(e){return{lastTime:e}}),E=Object(r.action)("resetHeaderTabDropViewState",function(e,t){return Object(g.a)({name:"timePanelActionSwitchTabsFromEmailHover",options:w,customData:_({previousView:e,nextView:t})},{nextView:t})}),C=Object(r.action)("setLastEnterTasksTab",function(e){return{lastTime:e}}),y=Object(r.action)("setShowDayDropHint",function(e){return{shouldShow:e}}),x=Object(r.action)("setLastEnterUpNext",function(e){return{lastTime:e}}),T=Object(r.action)("resetCalendarUpNextState"),D=Object(r.action)("setDayViewDropTimeMinuteOffset",function(e){return{dayViewDropTimeMinuteOffset:e}});Object(r.mutator)(S,function(e){i().lastDragOverCalendarTab=e.lastTime}),Object(r.mutator)(E,function(e){switch(e.nextView){case"Calendar":i().calendarTabDropViewState=Object(a.c)();break;case"Tasks":i().tasksTabDropViewState=Object(a.c)()}}),Object(r.mutator)(C,function(e){i().lastDragOverTasksTab=e.lastTime}),Object(r.mutator)(x,function(e){i().lastDragOverUpNext=e.lastTime}),Object(r.mutator)(T,function(){i().upNextDropViewState=Object(a.c)()}),Object(r.mutator)(y,function(e){i().shouldShowHoverDayDrop=e.shouldShow}),Object(r.mutator)(D,function(e){var t=e.dayViewDropTimeMinuteOffset;i().dayViewDropTimeMinuteOffset=t});var k=n(0),M=Object(r.action)("dropMailItem",function(e,t,n,r){return Object(g.a)({name:"timePanelActionCreateMeetingFromEmailDrop",options:w,customData:_({dropTarget:n})},{dragData:e,entryType:t,preFillStartTime:r})}),A=n(5951),N=n(7),P=n(110),V=n(1023),L=2,F={width:1095,height:640},R=60;Object(r.orchestrator)(M,function(e){var t=e.dragData,n=e.entryType,r=e.preFillStartTime;if(t){var a=t.latestItemIds[0],i=Object(k.__read)(function(e){var t=e||Object(N.f)(Object(N.Sb)(Object(N.Kb)()),L),n=e?Object(N.h)(t,R):Object(N.h)(t,Object(P.c)());return[t,n]}(r),2),c=i[0],o=i[1],u=Object(A.a)(a,c,o,null,null,!1,!1);Object(V.c)("calendar","compose",function(){return Object(k.__awaiter)(void 0,void 0,void 0,function(){var e;return Object(k.__generator)(this,function(t){switch(t.label){case 0:return[4,u];case 1:return e=t.sent(),[2,Promise.resolve(e?{draftItemId:e,extractionSourceId:null,internetMessageId:null,composeEntrySource:n}:null)]}})})},F),Promise.resolve()}});var B=n(1),q=n(19),H=n(3939),W=n(2950);function Y(e){return e.itemType===a.a.MailListRow}var U=Object(q.a)(function(e){var t=e.classNames,n=e.children,r=e.selectedDate,i=s(),c=B.useCallback(function(e,t,n,i){!function(e,t,n,r,i){switch(e.itemType){case a.a.MailListRow:var c=e;switch(Object(H.a)()){case"Agenda":M(c,"TimePanel_DragToAgendaReplyWithMeeting","AgendaViewDropBox",i&&Object(W.a)(i));break;case"Day":M(c,"TimePanel_DragToDayReplyWithMeeting","DayViewSchedulingGrid",i&&Object(N.h)(i,v())),D(null)}}}(e,0,0,0,r)},[r]);return B.createElement(a.b,{dropViewState:i,canDrop:Y,onDrop:c,classNames:t,greedy:!0},n)});function z(e,t,n,r){}function G(e){return e.itemType===a.a.MailListRow||e.itemType===a.a.Todo}var J=Object(q.a)(function(e){var t=e.children;return B.createElement(a.b,{dropViewState:d(),onDrop:z,canDrop:G,greedy:!0},t)}),Q=500;function Z(e){return!0}function K(){y(!0),window.setTimeout(X,Q)}function X(){y(!1)}var $=Object(q.a)(function(e){var t=e.children,n=e.selectedDate,r=B.useCallback(function(e,t,r,a){!function(e,t,n,r,a){M(e,"TimePanel_DragToDayReplyWithMeeting","DayViewDropHintFallback",a&&Object(W.a)(a))}(e,0,0,0,n)},[n]);return B.createElement(a.b,{dropViewState:d(),onDrop:r,canDrop:Z,onDragEnter:K,greedy:!0,onDragLeave:X},t)});n.d(t,"g",function(){return s}),n.d(t,"e",function(){return o}),n.d(t,"k",function(){return u}),n.d(t,"l",function(){return d}),n.d(t,"u",function(){return l}),n.d(t,"v",function(){return f}),n.d(t,"h",function(){return b}),n.d(t,"i",function(){return O}),n.d(t,"j",function(){return p}),n.d(t,"m",function(){return j}),n.d(t,"n",function(){return m}),n.d(t,"w",function(){return h}),n.d(t,"f",function(){return v}),n.d(t,"r",function(){return S}),n.d(t,"p",function(){return E}),n.d(t,"s",function(){return C}),n.d(t,"t",function(){return x}),n.d(t,"o",function(){return T}),n.d(t,"q",function(){return D}),n.d(t,"d",function(){return M}),n.d(t,"a",function(){return U}),n.d(t,"c",function(){return J}),n.d(t,"b",function(){return $})},5951:function(e,t,n){"use strict";var r;!function(e){e[e.Text=0]="Text",e[e.Html=1]="Html"}(r||(r={}));var a=n(60),i=n(174),c=n(7),o="ows/beta/replybymeeting";function u(e,t,n,u,d,s,l){var f={ReminderMinutesBeforeStart:Object(a.a)().UserOptions.DefaultReminderTimeInMinutes};t&&(f.Start={DateTime:Object(c.mb)(t),TimeZone:t.tz}),n&&(f.End={DateTime:Object(c.mb)(n),TimeZone:n.tz}),u&&(f.Location={DisplayName:u}),d&&(f.Body={Content:d,ContentType:r.Html});var b={ReferenceItemId:e,ShouldSend:s,ShouldExcludeAttendees:l,Event:f};return Object(i.d)(o,b).then(function(e){return e.CreatedEventId}).catch(function(e){return null})}n.d(t,"a",function(){return u})},7068:function(e){e.exports={a:"f0b",d:"g0b",c:"h0b",g:"i0b",f:"j0b",b:"k0b",e:"l0b"}},7069:function(e,t,n){var r=n(10540),a=n(58);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)a.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},822:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/;function a(e){return r.test(e)}},9109:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n(2),i=n(4731),c=n(3256),o=n(6),u=Object(a.action)("INITIALIZE_UP_NEXT_V2"),d=(Object(a.orchestrator)(u,function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var e;return Object(r.__generator)(this,function(t){switch(t.label){case 0:return e=new o.ObservableMap,[4,Object(i.b)()];case 1:return t.sent().forEach(function(t,n){e.set(n,{loaderType:c.a.CalendarIds,calendarIds:t})}),Object(c.e)(e,"TimePanelAgenda_UpNextCalendarCacheId"),[2]}})})}),n(1275)),s=n(175),l=n(2952),f=n(2373),b=(Object(a.orchestrator)(l.b,function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(n){return t=e.accountSmtpAddress,Object(s.h)(t)?[2]:(Object(i.b)().then(function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(n){switch(n.label){case 0:return e.get(t)&&e.get(t).length>0?[4,Object(f.c)(f.a.Outlook,t)]:[3,2];case 1:n.sent(),Object(d.l)(t,{loaderType:c.a.CalendarIds,calendarIds:e.get(t)},"TimePanelAgenda_UpNextCalendarCacheId"),n.label=2;case 2:return[2]}})})}),[2])})})}),n(4444),n(7068)),O=n(19),m=n(351),v=n(1),p=n(7069),j=Object(O.a)(function(e){return v.createElement("div",{className:p.upNextEventContainer},e.eventCountString&&v.createElement("div",{className:p.conflictingEventsCount},e.eventCountString),v.createElement(m.a,{className:p.eventIconColumn,iconName:"Event"}),v.createElement("div",{className:p.eventDetailsColumn},v.createElement("div",{className:p.eventName},e.eventName),v.createElement("div",{className:p.eventTimeLocationRow},v.createElement("div",{className:p.eventTime},e.timeUntilEvent),e.eventLocation&&v.createElement("div",{className:p.eventLocation},e.eventLocation))))}),h=n(10541),g=n(4),I=n(41),w=n(7),_=n(361),S=n(364),E=59*I.e;function C(e,t){var n=Object(S.f)();if(Object(_.r)(n,e.Start,e.End))return t?Object(g.a)(b.c)+",":Object(g.a)(b.c);var r=Object(w.fc)(e.Start),a=Math.abs(Object(w.ub)(n)-Object(w.ub)(r));if(a<=E){var i=Math.ceil(a/I.e);return Object(g.b)(Object(g.a)(h.a),i)}var c=Object(w.Db)(n,r),o=Object(w.W)(r);return c?o:Object(g.b)(Object(g.a)(b.f),o)}var y=n(963);var x=n(698),T=n(228),D=n(1666),k=n(1341),M=n(804),A=n(3338),N=n(1754),P=n(5038),V=n(7069),L=n(240).bind(V),F=1e3,R="DragEmailToUpNext";function B(){Object(w.p)(Object(w.g)(Object(P.j)(),F),Object(w.Kb)())<=0&&(Object(P.o)(),D.j.importAndExecute(R))}function q(e){return e.itemType===N.a.MailListRow}function H(e){Object(P.t)(Object(w.Kb)())}function W(e,t,n,r){}var Y=Object(O.a)(function(e){var t=e.children;return v.createElement(N.b,{canDrop:q,onDrop:W,dropViewState:Object(P.m)(),onDragEnter:H,onDragOver:B,classNames:L(V.dropContainer,{dropHoverTreatment:Object(P.m)().isDragOver})},t)}),U=n(932),z=n(105),G=n(7069),J="UpNext";function Q(e,t,n,r,a,i){e.push(v.createElement(j,{key:t,eventCountString:a,eventLocation:r,eventName:n,timeUntilEvent:i}))}var Z=Object(O.a)(function(e){var t,n=e.upNextEvent,a=n.ItemId,i=e.conflictingEvents.length+1,c=i>1,o=Object(r.__spread)([n],e.conflictingEvents),u=!c&&a,d=v.useCallback(function(){var e;Object(k.a)()?(e=u,Object(T.o)("TnS_UpNextClicked"),e?D.h.importAndExecute(J,e):D.j.importAndExecute(J)):function(e){e?Object(A.a)(e.Id,"Mail_UpNext",null,6):window.open(Object(M.e)())}(u)},[u]),s=v.useCallback(function(){var e=o.length;t=setTimeout(function(){t&&Object(T.o)("TnS_UpNextHover",[e]),t=null},300)},[u]),l=v.useCallback(function(){t=null},[u]);v.useEffect(function(){Object(T.o)("TnS_UpNext",[o.length])},[u]);for(var f=[],O=i>3,m=O?2:o.length,p=0;p<m;p++){var j=o[p],h=j.Location&&j.Location.DisplayName,I=c&&Object(g.b)(Object(g.a)(b.a),p+1,i),w=C(j,!!h);Q(f,j.ItemId.Id,j.Subject,h,I,w)}if(O){var _=i-m;Q(f,"viewAll",Object(g.a)(b.g),null,Object(g.b)(Object(g.a)(b.d),_),C(n,!1))}var S=G.allEventsContainer;2==i?S=G.allEventsContainerTwoEvents:i>2&&(S=G.allEventsContainerThreeOrMoreEvents);var E=c?void 0:Object(y.e)(n),N=c?function(e,t,n){var r=[];r.push(Object(g.b)(Object(g.a)(b.b),t));for(var a=0;a<e.length;a++){var i=e[a];r.push(Object(g.b)(Object(g.a)(b.e),a+1,t)),r.push(Object(y.a)(i))}return n&&r.push(Object(g.a)(b.g)),r.join(" ")}(o.slice(0,m),o.length,O):Object(y.a)(n),V=Object(z.e)("cal-time-panel-dragEscalateMeeting")&&Object(k.a)()&&11!==Object(U.b)()&&Object(P.w)(),L=v.createElement("div",{className:S,onMouseEnter:s,onMouseLeave:l},f);return v.createElement(x.a,{ariaLabel:N,className:G.upNextEventButtonContainer,"data-is-focusable":!0,"data-automation-id":"UpNext",onClick:d,role:"button",title:E,styles:e.containerStyle},V?v.createElement(Y,null,L):L)}),K="TimePanelAgenda_UpNextCalendarCacheId";var X=Object(O.a)(function(e){var t="Loaded"==Object(d.e)(K)?Object(c.d)(K):null;if(!t||!t.upNextEvent)return null;var n=t.conflictingEvents;return v.createElement(Z,{upNextEvent:t.upNextEvent,conflictingEvents:n,containerStyle:e.containerStyle})});n.d(t,"initializeUpNextV2",function(){return u}),n.d(t,"UpNextV2",function(){return X})},932:function(e,t,n){"use strict";var r=n(2),a=Object(r.action)("DEACTIVATE_CHARM",function(e){return{charm:e}}),i=Object(r.createStore)("headerViewState",{activeCharm:null});Object(r.mutator)(a,function(e){var t=e.charm,n=i();n.activeCharm===t&&(n.activeCharm=null)});var c=n(1053);Object(r.mutator)(c.a,function(e){var t=e.charm,n=i();n.activeCharm===t?n.activeCharm=null:n.activeCharm=t});var o=n(1899),u=(Object(r.orchestrator)(o.a,function(){Object(c.a)(4)}),Object(r.action)("HIDE_QUICK_OPTIONS",function(){return{}})),d=(Object(r.orchestrator)(u,function(){a(4)}),n(1299));Object(r.orchestrator)(d.d,function(){a(2)});function s(){return i().activeCharm}n.d(t,"a",function(){return a}),n.d(t,"b",function(){return s}),n.d(t,"c",function(){return c.a})},938:function(e,t,n){"use strict";n.d(t,"g",function(){return u}),n.d(t,"b",function(){return d}),n.d(t,"a",function(){return s}),n.d(t,"i",function(){return l}),n.d(t,"h",function(){return f}),n.d(t,"c",function(){return b}),n.d(t,"j",function(){return O}),n.d(t,"f",function(){return m}),n.d(t,"l",function(){return v}),n.d(t,"m",function(){return p}),n.d(t,"n",function(){return j}),n.d(t,"o",function(){return h}),n.d(t,"p",function(){return g}),n.d(t,"k",function(){return I}),n.d(t,"e",function(){return w}),n.d(t,"d",function(){return _});var r=n(0),a=n(1786),i=n(4),c=n(438),o=n.n(c),u="N/A",d="",s="CheckErrorDetails",l="React/Nps",f="UVNpsRating",b="UVFeedback",O="Search_{0}",m="NoUserMessage",v="https://outlook.uservoice.com/forums/{0}",p=601444,j=907141,h=4,g=15;function I(){return[{name:"NoResults",label:Object(i.a)(a.c)},{name:"SlowResults",label:Object(i.a)(a.f)},{name:"ResultsNotRelevant",label:Object(i.a)(a.e)},{name:"ItemNotFound",label:Object(i.a)(a.b)},{name:"SuggestionsNotUseful",label:Object(i.a)(a.g)},{name:"ClientUXHardToUse",label:Object(i.a)(a.a)},{name:"Other",label:Object(i.a)(a.d)}]}function w(e){return e?"1":"2"}function _(){return Object(r.__awaiter)(this,void 0,void 0,function(){var e;return Object(r.__generator)(this,function(t){switch(t.label){case 0:return[4,o()()];case 1:return[2,(e=t.sent()).ConsumerSubscriptions?e.ConsumerSubscriptions.join(","):d]}})})}},963:function(e,t,n){"use strict";var r=n(361),a=n(4),i=n(2412),c=n(7),o=n(998),u=n(2413),d=n(1122);function s(e,t){var n=[];return e.IsDraft&&n.push(Object(a.a)(u.a)),e.Subject?n.push(e.Subject):t||n.push(Object(a.a)(u.b)),n.join(" ")}function l(e){return e.Location?Object(d.d)(e.Location.DisplayName,e.Location.PostalAddress):""}function f(e,t){var n=[];n.push(function(e,t){var n=s(e),u=Object(o.e)(e),d=m(e.Start,e.End,t,e.IsAllDayEvent,u,!0),l=Object(a.a)(i.b);e.IsAllDayEvent&&u&&Object(c.w)(e.End,e.Start)==r.a.MillisecondsInOneDay?l=Object(a.a)(i.g):e.IsAllDayEvent&&u&&(l=Object(a.a)(i.a));return Object(a.b)(l,d,n)}(e,t));var u=l(e);return u&&n.push(Object(a.b)(Object(a.a)(i.c),u)),e.Organizer&&e.IsMeeting&&n.push(Object(a.b)(Object(a.a)(i.d),e.Organizer.Mailbox.Name)),"Occurrence"===e.CalendarItemType&&n.push(Object(a.a)(i.f)),"Private"===e.Sensitivity&&n.push(Object(a.a)(i.e)),n.join(" ")}function b(e,t){var n=[],r=s(e);r&&n.push(r);var a=l(e);a&&n.push(a);var i=Object(o.e)(e),c=m(e.Start,e.End,t,e.IsAllDayEvent,i,!1);return n.push(c),n.join("\n")}function O(e,t){var n=l(e),r=b(e);return n?r+" "+n:r}function m(e,t,n,u,d,s){if(n&&(e=Object(c.Lb)(n,e),t=Object(c.Lb)(n,t)),Object(c.Db)(e,t))return Object(a.b)(Object(a.a)(i.j),s?Object(c.cb)(e):"",Object(c.W)(e),Object(c.W)(t)).replace("  "," ");if(u&&d){if(Object(c.w)(t,e)==r.a.MillisecondsInOneDay)return Object(c.cb)(e);var l=Object(c.cb)(Object(o.a)({start:e,end:t}).end);return Object(a.b)(Object(a.a)(i.h),Object(c.cb)(e),l)}return Object(a.b)(Object(a.a)(i.i),Object(c.cb)(e),Object(c.W)(e),Object(c.cb)(t),Object(c.W)(t))}n.d(t,"a",function(){return f}),n.d(t,"d",function(){return b}),n.d(t,"e",function(){return O}),n.d(t,"b",function(){return l}),n.d(t,"c",function(){return s})},997:function(e,t,n){"use strict";function r(e,t){return!e.some(function(e){return e&&t&&e.calculatedFolderId===t.calculatedFolderId})}function a(e,t){return e.indexOf(t)<0}function i(e,t){if(void 0===t&&(t=a),!e)return[];var n=[];return e&&e.forEach(function(e){t(n,e)&&n.push(e)}),n}var c=n(6);function o(e,t){if(void 0===t&&(t=a),!e)return e;var n=new c.ObservableMap;return e.forEach(function(e,r){n.set(r,i(e,t))}),n}function u(e,t){if(void 0===t&&(t=a),!e)return[];var n=[];return e.forEach(function(e){e&&e.forEach(function(e){t(n,e)&&n.push(e)})}),n}n.d(t,"a",function(){return r}),n.d(t,"b",function(){return i}),n.d(t,"c",function(){return o}),n.d(t,"d",function(){return u})},998:function(e,t,n){"use strict";var r=n(361),a=n(7);function i(e){return c({start:e.Start,end:e.End})}function c(e){var t=Object(a.Rb)(e.end),n={start:e.start,end:e.end},r=Object(a.Cb)(e.end,t),i=Object(a.Cb)(e.start,t);return r&&!i&&(n.end=Object(a.Yb)(n.end,1)),n}function o(e){return function(t){var n=i(t);return 0===Object(r.j)(e,n,!0)}}var u=n(41);function d(e){var t=i(e),n=Object(a.w)(Object(a.Rb)(t.end),Object(a.Rb)(t.start));return Math.ceil(n/u.c)}var s=n(242);function l(e){return e.IsAllDayEvent||Object(a.w)(e.End,e.Start)>=s.a.MillisecondsInOneDay}function f(e){return Object(a.Ab)(e.Start,e.End)?b(e):d(e)>=1}function b(e){return Math.abs(Object(a.s)(e.Start,e.End))>1}n.d(t,"d",function(){return o}),n.d(t,"c",function(){return d}),n.d(t,"a",function(){return c}),n.d(t,"b",function(){return i}),n.d(t,"e",function(){return l}),n.d(t,"g",function(){return f}),n.d(t,"f",function(){return b})}},0,[0,6,7,9,146,161,244,5,8,11,159,587,28,72,443,564,341,23,119,27,499,501]]);
//# sourceMappingURL=owa.UpNextV2.js.map
self.scriptsLoaded['owa.UpNextV2.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.UpNextV2.js'] = (new Date()).getTime();