self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.HeaderCharms.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[273],{10111:function(e){e.exports={b:"IEb",a:"JEb"}},1239:function(e,t,n){"use strict";n.d(t,"b",function(){return a});var r=n(6),i=n(2),c={signInState:0,presences:new r.ObservableMap({}),processingManualSignIn:!1,isRetrySignInAllowed:!0},a=Object(i.createStore)("presenceStore",c),o=a();t.a=o},1260:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(1239);function i(){return 3==r.a.signInState}},1288:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(1687),i=n(1239),c=n(1704),a=n(105);function o(e){if(Object(a.e)("fwk-skypeBusinessV2")&&e){var t=Object(r.b)(e),n=function(e){switch(e){case"Offline":return c.b.offline;case"Away":case"BeRightBack":return c.b.away;case"Busy":case"IdleBusy":return c.b.busy;case"DoNotDisturb":return c.b.dnd;case"Online":case"IdleOnline":return c.b.online;case"None":return c.b.none}}(i.a.presences.get(t));return n||void 0}}},1324:function(e,t,n){"use strict";var r=n(2),i=Object(r.actionCreator)("ADD_CHAT_TAB",function(e){return{chatConversationId:e}});t.a=i},1649:function(e,t,n){"use strict";n.d(t,"c",function(){return s}),n.d(t,"g",function(){return f}),n.d(t,"f",function(){return d}),n.d(t,"e",function(){return l}),n.d(t,"a",function(){return h});var r=n(22),i=n(105),c=n(1288);n.d(t,"b",function(){return c.a});var a=n(1260);n.d(t,"d",function(){return a.a});var o=new r.c(function(){return Promise.all([n.e(2),n.e(5),n.e(425)]).then(n.bind(null,2849))}),u=new r.b(o,function(e){return e.initializeSkypeForBusiness});function s(){Object(i.e)("fwk-skypeBusinessV2")&&u.import().then(function(e){return e()})}var f=new r.b(o,function(e){return e.tryRegisterForPresenceUpdates}),d=new r.b(o,function(e){return e.startChat}),l=new r.a(o,function(e){return e.setIsChatCalloutShown}),h=Object(r.d)(o,function(e){return e.UcmaChatView})},1687:function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"b",function(){return i});var r="sip:";function i(e){if(!e)return null;var t=e.toLowerCase();return 0!=t.indexOf(r)&&(t=r+t),t}},2025:function(e,t,n){"use strict";var r=n(2),i=Object(r.createStore)("SkypeStore",{unreadConversationCount:0,isRecentsInitialized:!1,isSwcInitialized:!1,isGlimpseOpen:!1})();t.a=i},2419:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var r=n(105),i=n(862);function c(){return Object(r.e)("rp-skypeInTabs")&&1==Object(i.b)()}},2516:function(e){e.exports={a:"TBb"}},2826:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var r=n(2),i={chats:[],isChatCalloutShown:!1,isMoreChatMenuShown:!1,participantCache:new(n(6).ObservableMap),chatProvider:0},c=Object(r.createStore)("ucmaChatStore",i);c()},3176:function(e){e.exports={a:"zEb"}},3177:function(e){e.exports={a:"yEb"}},3278:function(e,t,n){"use strict";var r=n(2025),i=n(22),c=n(79),a=n(1324),o=n(105),u=n(2419);n.d(t,"a",function(){return f}),n.d(t,"g",function(){return d}),n.d(t,"f",function(){return l}),n.d(t,"e",function(){return b}),n.d(t,"d",function(){return m}),n.d(t,"h",function(){return r.a}),n.d(t,"b",function(){return a.a}),n.d(t,"c",function(){return u.a});var s=new i.c(function(){return n.e(424).then(n.bind(null,13791))}),f=Object(i.d)(s,function(e){return e.SkypeGlimpse}),d=new i.a(s,function(e){return e.updateIsGlimpseOpen}),l=new i.b(s,function(e){return e.shouldShowUnreadConversationCount}),h=new i.a(s,function(e){return e.beginSkypeInitialization}),p=new i.a(s,function(e){return e.createOnSwcReadyEvent}),b=new i.a(s,function(e){return e.onNotificationReceived}),m=new i.a(s,function(e){return e.onHideNotificationReceived});Object(c.c)(function(){Object(o.e)("fwk-partner-code-off")||Object(o.e)("fwk-skypeSuite")&&Object(o.e)("fwk-o365shellheader")||!Object(o.e)("fwk-skypeConsumer")||h.importAndExecute(),p.importAndExecute()})},3664:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var r=n(2),i=n(6),c=Object(r.createStore)("activityFeedStore",{firstFetchComplete:!1,isActivityFeedOpen:!1,items:new i.ObservableMap})},4110:function(e,t,n){"use strict";n.d(t,"e",function(){return i}),n.d(t,"b",function(){return c}),n.d(t,"c",function(){return a}),n.d(t,"d",function(){return o}),n.d(t,"a",function(){return u});var r=n(2826);function i(){return Object(r.a)().chats.filter(function(e){return 1==e.state||2==e.state})}function c(){return Object(r.a)().chats.filter(function(e){return 0==e.state})}function a(){return Object(r.a)().chats.filter(function(e){return 0==e.state||o(e)>0}).length}function o(e){return e.lastMessageSequence-e.lastReadMessageSequence}function u(){return Object(r.a)().chats.filter(function(e){return 4==e.state})}},4741:function(e,t,n){"use strict";n.r(t);var r=n(1),i=n(971),c=n(962),a=n(19),o=Object(a.a)(function(e){return r.createElement(i.a,{title:"Feature Flags",key:"featureflags",icons:{iconName:"Flag"},ariaLabel:"featureflags charm",behavior:{paneComponent:c.e,charm:1}})}),u=n(0),s=n(3176),f=n(10111),d=n(3177),l=n(4),h=n(173),p=n(105),b=n(1649),m=n(4110),C=n(2826),O=n(1239),v=n(229),w=n(3278),y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.setCharmDiv=function(e){t.charmDiv=v.findDOMNode(e)},t}return Object(u.__extends)(t,e),t.prototype.onDismiss=function(){w.g.importAndExecute(!1)},t.prototype.onUcmaDismiss=function(){b.e.importAndExecute(!1)},t.prototype.render=function(){if(!Object(p.e)("fwk-skypeBusinessV2"))return w.h.isSwcInitialized&&this.renderCharm(w.h.isGlimpseOpen,"SkypeLogo",Object(l.a)(s.a),Object(l.a)(f.a),w.h.isGlimpseOpen&&this.renderCharmContent(),this.onClickNonUcmaCharm,this.getBadgeCount);var e=Object(C.a)();switch(e.chatProvider){case 3:case 4:return!Object(p.e)("fwk-skypeSuite")&&3==O.a.signInState&&this.renderCharm(e.isChatCalloutShown,"SkypeForBusinessLogo",Object(l.a)(d.a),Object(l.a)(f.b),e.isChatCalloutShown&&r.createElement(b.a,{onDismiss:this.onUcmaDismiss,target:this.charmDiv}),this.onClickUcmaCharm,m.c);case 5:return!Object(p.e)("fwk-skypeSuite")&&this.renderCharm(!1,"OfficeChat",Object(l.a)(d.a),Object(l.a)(f.b),void 0,this.onClickTeams,this.getBadgeCount);default:return null}},t.prototype.renderCharm=function(e,t,n,c,a,o,u){return r.createElement(i.a,{ref:this.setCharmDiv,key:"skype",icons:{iconName:t,hoverIconName:t},title:n,ariaLabel:n,ariaLabelWithBadgeCount:c,behavior:{isActive:e,content:a,onClick:o},getBadgeCount:u})},t.prototype.renderCharmContent=function(){return r.createElement(w.a,{onDismiss:this.onDismiss,target:this.charmDiv})},t.prototype.getBadgeCount=function(){return w.f.tryImportForRender()?w.h.unreadConversationCount:null},t.prototype.onClickUcmaCharm=function(){b.e.importAndExecute(!Object(C.a)().isChatCalloutShown)},t.prototype.onClickNonUcmaCharm=function(){var e=w.h.isGlimpseOpen;w.g.importAndExecute(!e)},t.prototype.onClickTeams=function(){window.open("https://teams.microsoft.com")},t=Object(u.__decorate)([h.observer],t)}(r.Component),j=n(2516),k=n(3664),g=function(){return Object(u.__spread)(Object(k.a)().items.values()).filter(function(e){return!e.isSeen}).length},S=n(932),I=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(u.__extends)(t,e),t.prototype.render=function(){return r.createElement("div",null,r.createElement(i.a,{key:"activityfeed",icons:{iconName:"Ringer"},ariaLabel:Object(l.a)(j.a),title:Object(l.a)(j.a),behavior:{paneComponent:Object(p.e)("fwk-o365shellheader")?null:c.a,charm:10,onClick:this.onActivityFeedCharmClick},getBadgeCount:g}))},t.prototype.onActivityFeedCharmClick=function(){Object(p.e)("fwk-o365shellheader")||Object(S.c)(10)},t=Object(u.__decorate)([h.observer],t)}(r.Component);n.d(t,"FeatureFlagsCharm",function(){return o}),n.d(t,"SkypeCharm",function(){return y}),n.d(t,"ActivityFeedCharm",function(){return I})}},0,[5,11,39,88,350,3,4,549,50,274,2,425,117,424]]);
//# sourceMappingURL=owa.HeaderCharms.js.map
self.scriptsLoaded['owa.HeaderCharms.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.HeaderCharms.js'] = (new Date()).getTime();